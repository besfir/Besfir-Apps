var Wa=Object.defineProperty;var Ya=(st,ot,k)=>ot in st?Wa(st,ot,{enumerable:!0,configurable:!0,writable:!0,value:k}):st[ot]=k;var be=(st,ot,k)=>(Ya(st,typeof ot!="symbol"?ot+"":ot,k),k),wn=(st,ot,k)=>{if(!ot.has(st))throw TypeError("Cannot "+k)};var t=(st,ot,k)=>(wn(st,ot,"read from private field"),k?k.call(st):ot.get(st)),o=(st,ot,k)=>{if(ot.has(st))throw TypeError("Cannot add the same private member more than once");ot instanceof WeakSet?ot.add(st):ot.set(st,k)},T=(st,ot,k,s)=>(wn(st,ot,"write to private field"),s?s.call(st,k):ot.set(st,k),k);var gs=(st,ot,k,s)=>({set _(H){T(st,ot,H,k)},get _(){return t(st,ot,s)}}),y=(st,ot,k)=>(wn(st,ot,"access private method"),k);import{_ as ja}from"./DL6JF3ru.js";import{g as Hs,N as Lr,E as Ze,o as ts,c as bs,a as qe,b as Je,d as xr,w as Qs,l as Qe,a2 as Ii,Q as qa,a1 as Ka,$ as Tn,a3 as Is,h as Ts,a4 as vn,a5 as Mi,v as Sn,j as bn,A as xn,G as Er,a6 as Pr,a7 as Mr,z as Ja,a8 as Wi,H as Qa,I as Za,t as to,a9 as eo,U as so}from"./BTFwFKrx.js";import{_ as io}from"./DUhansqL.js";import{_ as no}from"./CFXj3nvR.js";import{_ as ro}from"./CckpmZZi.js";import{i as ao,b as oo}from"./DxkbJE8z.js";const lo={class:"rounded-xl overflow-hidden inline-flex text-white dark:text-gray-800 shadow-md"},ho={class:"bg-[#2185d0] hover:bg-[#1678c2] text-xl px-9 py-5 font-semibold cursor-pointer"},co={class:"flex items-center gap-x-1.5 leading-6"},uo=qe("p",{style:{"margin-top":"8px"},class:"text-sm dark:text-white"}," or drop PDF here ",-1),fo={class:"flex items-center justify-between"},po=qe("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Modal ",-1),go=Hs({__name:"InputFile",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(st){const ot=Lr(st,"modelValue");function k(X){var V,I;const rt=Array.from(((V=X.target)==null?void 0:V.files)||[]);(I=ot.value)==null||I.push(...rt)}const s=Ze(!1),H=Ze("");function w(){ot.value.push(H.value),H.value=""}return(X,rt)=>{const V=qa,I=Ka,M=Tn,W=io,x=Tn,g=no,P=ro;return ts(),bs("div",null,[qe("div",lo,[qe("label",ho,[qe("span",co,[Je(V,{name:"i-ph-file-pdf",class:"text-2xl"}),xr("Upload ")]),qe("input",{multiple:"",type:"file",accept:"application/pdf",hidden:"",onChange:k},null,32)]),qe("button",{class:"px-[22px] bg-[#1f7fc6] hover:bg-[#1873ba]",onClick:rt[0]||(rt[0]=R=>s.value=!0)},[Je(I,{name:"i-ph-link-bold",class:"text-2xl"})])]),uo,Je(P,{modelValue:Qe(s),"onUpdate:modelValue":rt[3]||(rt[3]=R=>Ii(s)?s.value=R:null),"prevent-close":""},{default:Qs(()=>[Je(g,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:Qs(()=>[qe("div",fo,[po,Je(M,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:rt[1]||(rt[1]=R=>s.value=!1)})])]),footer:Qs(()=>[Je(x,{onClick:w},{default:Qs(()=>[xr(" Submit ")]),_:1})]),default:Qs(()=>[Je(W,{modelValue:Qe(H),"onUpdate:modelValue":rt[2]||(rt[2]=R=>Ii(H)?H.value=R:null),placeholder:"URL"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])])}}});var mo={976:(st,ot,k)=>{var ce,pe,re,Cn,Zt,Ns,ee,Ir,i,Nr,r,c,l,p,f,d,A,u,a,h,F,L,it,dt,ut,wt,bt,At,Dr,O,Yi,q,kn,et,Rn,$,j,ht,xt,Lt,jt,Kt,Fn,fe,ye,de,Re,_r,Ve,Ln;k.d(ot,{AnnotationLayer:()=>Me,FreeTextAnnotationElement:()=>Tt,InkAnnotationElement:()=>kt,StampAnnotationElement:()=>he});var s=k(292),H=k(419),w=k(792);function X(te){return Math.floor(Math.max(0,Math.min(1,te))*255).toString(16).padStart(2,"0")}function rt(te){return Math.max(0,Math.min(255,255*te))}class V{static CMYK_G([v,m,Y,nt]){return["G",1-Math.min(1,.3*v+.59*Y+.11*m+nt)]}static G_CMYK([v]){return["CMYK",0,0,0,1-v]}static G_RGB([v]){return["RGB",v,v,v]}static G_rgb([v]){return v=rt(v),[v,v,v]}static G_HTML([v]){const m=X(v);return`#${m}${m}${m}`}static RGB_G([v,m,Y]){return["G",.3*v+.59*m+.11*Y]}static RGB_rgb(v){return v.map(rt)}static RGB_HTML(v){return`#${v.map(X).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([v,m,Y,nt]){return["RGB",1-Math.min(1,v+nt),1-Math.min(1,Y+nt),1-Math.min(1,m+nt)]}static CMYK_rgb([v,m,Y,nt]){return[rt(1-Math.min(1,v+nt)),rt(1-Math.min(1,Y+nt)),rt(1-Math.min(1,m+nt))]}static CMYK_HTML(v){const m=this.CMYK_RGB(v).slice(1);return this.RGB_HTML(m)}static RGB_CMYK([v,m,Y]){const nt=1-v,lt=1-m,vt=1-Y,yt=Math.min(nt,lt,vt);return["CMYK",nt,lt,vt,yt]}}var I=k(284);const M=1e3,W=9,x=new WeakSet;function g(te){return{width:te[2]-te[0],height:te[3]-te[1]}}class P{static create(v){switch(v.data.annotationType){case s.AnnotationType.LINK:return new z(v);case s.AnnotationType.TEXT:return new ct(v);case s.AnnotationType.WIDGET:switch(v.data.fieldType){case"Tx":return new N(v);case"Btn":return v.data.radioButton?new _(v):v.data.checkBox?new D(v):new U(v);case"Ch":return new G(v);case"Sig":return new B(v)}return new tt(v);case s.AnnotationType.POPUP:return new pt(v);case s.AnnotationType.FREETEXT:return new Tt(v);case s.AnnotationType.LINE:return new Ft(v);case s.AnnotationType.SQUARE:return new Pt(v);case s.AnnotationType.CIRCLE:return new Vt(v);case s.AnnotationType.POLYLINE:return new Wt(v);case s.AnnotationType.CARET:return new at(v);case s.AnnotationType.INK:return new kt(v);case s.AnnotationType.POLYGON:return new qt(v);case s.AnnotationType.HIGHLIGHT:return new Xt(v);case s.AnnotationType.UNDERLINE:return new zt(v);case s.AnnotationType.SQUIGGLY:return new ie(v);case s.AnnotationType.STRIKEOUT:return new oe(v);case s.AnnotationType.STAMP:return new he(v);case s.AnnotationType.FILEATTACHMENT:return new xe(v);default:return new R(v)}}}const Fe=class Fe{constructor(v,{isRenderable:m=!1,ignoreBorder:Y=!1,createQuadrilaterals:nt=!1}={}){o(this,re);o(this,ce,null);o(this,pe,!1);this.isRenderable=m,this.data=v.data,this.layer=v.layer,this.linkService=v.linkService,this.downloadManager=v.downloadManager,this.imageResourcesPath=v.imageResourcesPath,this.renderForms=v.renderForms,this.svgFactory=v.svgFactory,this.annotationStorage=v.annotationStorage,this.enableScripting=v.enableScripting,this.hasJSActions=v.hasJSActions,this._fieldObjects=v.fieldObjects,this.parent=v.parent,m&&(this.container=this._createContainer(Y)),nt&&this._createQuadrilaterals()}static _hasPopupData({titleObj:v,contentsObj:m,richText:Y}){return!!(v!=null&&v.str||m!=null&&m.str||Y!=null&&Y.str)}get hasPopupData(){return Fe._hasPopupData(this.data)}updateEdited(v){if(!this.container)return;t(this,ce)||T(this,ce,{rect:this.data.rect.slice(0)});const{rect:m}=v;m&&y(this,re,Cn).call(this,m)}resetEdited(){t(this,ce)&&(y(this,re,Cn).call(this,t(this,ce).rect),T(this,ce,null))}_createContainer(v){const{data:m,parent:{page:Y,viewport:nt}}=this,lt=document.createElement("section");lt.setAttribute("data-annotation-id",m.id),this instanceof tt||(lt.tabIndex=M);const{style:vt}=lt;if(vt.zIndex=this.parent.zIndex++,m.popupRef&&lt.setAttribute("aria-haspopup","dialog"),m.alternativeText&&(lt.title=m.alternativeText),m.noRotate&&lt.classList.add("norotate"),!m.rect||this instanceof pt){const{rotation:Qt}=m;return!m.hasOwnCanvas&&Qt!==0&&this.setRotation(Qt,lt),lt}const{width:yt,height:$t}=g(m.rect);if(!v&&m.borderStyle.width>0){vt.borderWidth=`${m.borderStyle.width}px`;const Qt=m.borderStyle.horizontalCornerRadius,le=m.borderStyle.verticalCornerRadius;if(Qt>0||le>0){const _e=`calc(${Qt}px * var(--scale-factor)) / calc(${le}px * var(--scale-factor))`;vt.borderRadius=_e}else if(this instanceof _){const _e=`calc(${yt}px * var(--scale-factor)) / calc(${$t}px * var(--scale-factor))`;vt.borderRadius=_e}switch(m.borderStyle.style){case s.AnnotationBorderStyleType.SOLID:vt.borderStyle="solid";break;case s.AnnotationBorderStyleType.DASHED:vt.borderStyle="dashed";break;case s.AnnotationBorderStyleType.BEVELED:(0,s.warn)("Unimplemented border style: beveled");break;case s.AnnotationBorderStyleType.INSET:(0,s.warn)("Unimplemented border style: inset");break;case s.AnnotationBorderStyleType.UNDERLINE:vt.borderBottomStyle="solid";break}const ge=m.borderColor||null;ge?(T(this,pe,!0),vt.borderColor=s.Util.makeHexColor(ge[0]|0,ge[1]|0,ge[2]|0)):vt.borderWidth=0}const Ot=s.Util.normalizeRect([m.rect[0],Y.view[3]-m.rect[1]+Y.view[1],m.rect[2],Y.view[3]-m.rect[3]+Y.view[1]]),{pageWidth:Et,pageHeight:It,pageX:Bt,pageY:_t}=nt.rawDims;vt.left=`${100*(Ot[0]-Bt)/Et}%`,vt.top=`${100*(Ot[1]-_t)/It}%`;const{rotation:ne}=m;return m.hasOwnCanvas||ne===0?(vt.width=`${100*yt/Et}%`,vt.height=`${100*$t/It}%`):this.setRotation(ne,lt),lt}setRotation(v,m=this.container){if(!this.data.rect)return;const{pageWidth:Y,pageHeight:nt}=this.parent.viewport.rawDims,{width:lt,height:vt}=g(this.data.rect);let yt,$t;v%180===0?(yt=100*lt/Y,$t=100*vt/nt):(yt=100*vt/Y,$t=100*lt/nt),m.style.width=`${yt}%`,m.style.height=`${$t}%`,m.setAttribute("data-main-rotation",(360-v)%360)}get _commonActions(){const v=(m,Y,nt)=>{const lt=nt.detail[m],vt=lt[0],yt=lt.slice(1);nt.target.style[Y]=V[`${vt}_HTML`](yt),this.annotationStorage.setValue(this.data.id,{[Y]:V[`${vt}_rgb`](yt)})};return(0,s.shadow)(this,"_commonActions",{display:m=>{const{display:Y}=m.detail,nt=Y%2===1;this.container.style.visibility=nt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:nt,noPrint:Y===1||Y===2})},print:m=>{this.annotationStorage.setValue(this.data.id,{noPrint:!m.detail.print})},hidden:m=>{const{hidden:Y}=m.detail;this.container.style.visibility=Y?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Y,noView:Y})},focus:m=>{setTimeout(()=>m.target.focus({preventScroll:!1}),0)},userName:m=>{m.target.title=m.detail.userName},readonly:m=>{m.target.disabled=m.detail.readonly},required:m=>{this._setRequired(m.target,m.detail.required)},bgColor:m=>{v("bgColor","backgroundColor",m)},fillColor:m=>{v("fillColor","backgroundColor",m)},fgColor:m=>{v("fgColor","color",m)},textColor:m=>{v("textColor","color",m)},borderColor:m=>{v("borderColor","borderColor",m)},strokeColor:m=>{v("strokeColor","borderColor",m)},rotation:m=>{const Y=m.detail.rotation;this.setRotation(Y),this.annotationStorage.setValue(this.data.id,{rotation:Y})}})}_dispatchEventFromSandbox(v,m){const Y=this._commonActions;for(const nt of Object.keys(m.detail)){const lt=v[nt]||Y[nt];lt==null||lt(m)}}_setDefaultPropertiesFromJS(v){if(!this.enableScripting)return;const m=this.annotationStorage.getRawValue(this.data.id);if(!m)return;const Y=this._commonActions;for(const[nt,lt]of Object.entries(m)){const vt=Y[nt];if(vt){const yt={detail:{[nt]:lt},target:v};vt(yt),delete m[nt]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:v}=this.data;if(!v)return;const[m,Y,nt,lt]=this.data.rect;if(v.length===1){const[,{x:Qt,y:le},{x:ge,y:_e}]=v[0];if(nt===Qt&&lt===le&&m===ge&&Y===_e)return}const{style:vt}=this.container;let yt;if(t(this,pe)){const{borderColor:Qt,borderWidth:le}=vt;vt.borderWidth=0,yt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Qt}" stroke-width="${le}">`],this.container.classList.add("hasBorder")}const $t=nt-m,Ot=lt-Y,{svgFactory:Et}=this,It=Et.createElement("svg");It.classList.add("quadrilateralsContainer"),It.setAttribute("width",0),It.setAttribute("height",0);const Bt=Et.createElement("defs");It.append(Bt);const _t=Et.createElement("clipPath"),ne=`clippath_${this.data.id}`;_t.setAttribute("id",ne),_t.setAttribute("clipPathUnits","objectBoundingBox"),Bt.append(_t);for(const[,{x:Qt,y:le},{x:ge,y:_e}]of v){const Te=Et.createElement("rect"),es=(ge-m)/$t,He=(lt-le)/Ot,Ue=(Qt-ge)/$t,C=(le-_e)/Ot;Te.setAttribute("x",es),Te.setAttribute("y",He),Te.setAttribute("width",Ue),Te.setAttribute("height",C),_t.append(Te),yt==null||yt.push(`<rect vector-effect="non-scaling-stroke" x="${es}" y="${He}" width="${Ue}" height="${C}"/>`)}t(this,pe)&&(yt.push("</g></svg>')"),vt.backgroundImage=yt.join("")),this.container.append(It),this.container.style.clipPath=`url(#${ne})`}_createPopup(){const{container:v,data:m}=this;v.setAttribute("aria-haspopup","dialog");const Y=new pt({data:{color:m.color,titleObj:m.titleObj,modificationDate:m.modificationDate,contentsObj:m.contentsObj,richText:m.richText,parentRect:m.rect,borderStyle:0,id:`popup_${m.id}`,rotation:m.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Y.render())}render(){(0,s.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(v,m=null){const Y=[];if(this._fieldObjects){const nt=this._fieldObjects[v];if(nt)for(const{page:lt,id:vt,exportValues:yt}of nt){if(lt===-1||vt===m)continue;const $t=typeof yt=="string"?yt:null,Ot=document.querySelector(`[data-element-id="${vt}"]`);if(Ot&&!x.has(Ot)){(0,s.warn)(`_getElementsByName - element not allowed: ${vt}`);continue}Y.push({id:vt,exportValue:$t,domElement:Ot})}return Y}for(const nt of document.getElementsByName(v)){const{exportValue:lt}=nt,vt=nt.getAttribute("data-element-id");vt!==m&&x.has(nt)&&Y.push({id:vt,exportValue:lt,domElement:nt})}return Y}show(){var v;this.container&&(this.container.hidden=!1),(v=this.popup)==null||v.maybeShow()}hide(){var v;this.container&&(this.container.hidden=!0),(v=this.popup)==null||v.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const v=this.getElementsToTriggerPopup();if(Array.isArray(v))for(const m of v)m.classList.add("highlightArea");else v.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:v,data:{id:m}}=this;this.container.addEventListener("dblclick",()=>{var Y;(Y=this.linkService.eventBus)==null||Y.dispatch("switchannotationeditormode",{source:this,mode:v,editId:m})})}};ce=new WeakMap,pe=new WeakMap,re=new WeakSet,Cn=function(v){const{container:{style:m},data:{rect:Y,rotation:nt},parent:{viewport:{rawDims:{pageWidth:lt,pageHeight:vt,pageX:yt,pageY:$t}}}}=this;Y==null||Y.splice(0,4,...v);const{width:Ot,height:Et}=g(v);m.left=`${100*(v[0]-yt)/lt}%`,m.top=`${100*(vt-v[3]+$t)/vt}%`,nt===0?(m.width=`${100*Ot/lt}%`,m.height=`${100*Et/vt}%`):this.setRotation(nt)};let R=Fe;class z extends R{constructor(m,Y=null){super(m,{isRenderable:!0,ignoreBorder:!!(Y!=null&&Y.ignoreBorder),createQuadrilaterals:!0});o(this,Zt);o(this,ee);o(this,i);this.isTooltipOnly=m.data.isTooltipOnly}render(){const{data:m,linkService:Y}=this,nt=document.createElement("a");nt.setAttribute("data-element-id",m.id);let lt=!1;return m.url?(Y.addLinkAttributes(nt,m.url,m.newWindow),lt=!0):m.action?(this._bindNamedAction(nt,m.action),lt=!0):m.attachment?(y(this,ee,Ir).call(this,nt,m.attachment,m.attachmentDest),lt=!0):m.setOCGState?(y(this,i,Nr).call(this,nt,m.setOCGState),lt=!0):m.dest?(this._bindLink(nt,m.dest),lt=!0):(m.actions&&(m.actions.Action||m.actions["Mouse Up"]||m.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(nt,m),lt=!0),m.resetForm?(this._bindResetFormAction(nt,m.resetForm),lt=!0):this.isTooltipOnly&&!lt&&(this._bindLink(nt,""),lt=!0)),this.container.classList.add("linkAnnotation"),lt&&this.container.append(nt),this.container}_bindLink(m,Y){m.href=this.linkService.getDestinationHash(Y),m.onclick=()=>(Y&&this.linkService.goToDestination(Y),!1),(Y||Y==="")&&y(this,Zt,Ns).call(this)}_bindNamedAction(m,Y){m.href=this.linkService.getAnchorUrl(""),m.onclick=()=>(this.linkService.executeNamedAction(Y),!1),y(this,Zt,Ns).call(this)}_bindJSAction(m,Y){m.href=this.linkService.getAnchorUrl("");const nt=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const lt of Object.keys(Y.actions)){const vt=nt.get(lt);vt&&(m[vt]=()=>{var yt;return(yt=this.linkService.eventBus)==null||yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Y.id,name:lt}}),!1})}m.onclick||(m.onclick=()=>!1),y(this,Zt,Ns).call(this)}_bindResetFormAction(m,Y){const nt=m.onclick;if(nt||(m.href=this.linkService.getAnchorUrl("")),y(this,Zt,Ns).call(this),!this._fieldObjects){(0,s.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),nt||(m.onclick=()=>!1);return}m.onclick=()=>{var It;nt==null||nt();const{fields:lt,refs:vt,include:yt}=Y,$t=[];if(lt.length!==0||vt.length!==0){const Bt=new Set(vt);for(const _t of lt){const ne=this._fieldObjects[_t]||[];for(const{id:Qt}of ne)Bt.add(Qt)}for(const _t of Object.values(this._fieldObjects))for(const ne of _t)Bt.has(ne.id)===yt&&$t.push(ne)}else for(const Bt of Object.values(this._fieldObjects))$t.push(...Bt);const Ot=this.annotationStorage,Et=[];for(const Bt of $t){const{id:_t}=Bt;switch(Et.push(_t),Bt.type){case"text":{const Qt=Bt.defaultValue||"";Ot.setValue(_t,{value:Qt});break}case"checkbox":case"radiobutton":{const Qt=Bt.defaultValue===Bt.exportValues;Ot.setValue(_t,{value:Qt});break}case"combobox":case"listbox":{const Qt=Bt.defaultValue||"";Ot.setValue(_t,{value:Qt});break}default:continue}const ne=document.querySelector(`[data-element-id="${_t}"]`);if(ne){if(!x.has(ne)){(0,s.warn)(`_bindResetFormAction - element not allowed: ${_t}`);continue}}else continue;ne.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((It=this.linkService.eventBus)==null||It.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Et,name:"ResetForm"}})),!1}}}Zt=new WeakSet,Ns=function(){this.container.setAttribute("data-internal-link","")},ee=new WeakSet,Ir=function(m,Y,nt=null){m.href=this.linkService.getAnchorUrl(""),m.onclick=()=>{var lt;return(lt=this.downloadManager)==null||lt.openOrDownloadData(Y.content,Y.filename,nt),!1},y(this,Zt,Ns).call(this)},i=new WeakSet,Nr=function(m,Y){m.href=this.linkService.getAnchorUrl(""),m.onclick=()=>(this.linkService.executeSetOCGState(Y),!1),y(this,Zt,Ns).call(this)};class ct extends R{constructor(v){super(v,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const v=document.createElement("img");return v.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",v.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),v.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(v),this.container}}class tt extends R{render(){return this.container}showElementAndHideCanvas(v){var m;this.data.hasOwnCanvas&&(((m=v.previousSibling)==null?void 0:m.nodeName)==="CANVAS"&&(v.previousSibling.hidden=!0),v.hidden=!1)}_getKeyModifier(v){return s.FeatureTest.platform.isMac?v.metaKey:v.ctrlKey}_setEventListener(v,m,Y,nt,lt){Y.includes("mouse")?v.addEventListener(Y,vt=>{var yt;(yt=this.linkService.eventBus)==null||yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:nt,value:lt(vt),shift:vt.shiftKey,modifier:this._getKeyModifier(vt)}})}):v.addEventListener(Y,vt=>{var yt;if(Y==="blur"){if(!m.focused||!vt.relatedTarget)return;m.focused=!1}else if(Y==="focus"){if(m.focused)return;m.focused=!0}lt&&((yt=this.linkService.eventBus)==null||yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:nt,value:lt(vt)}}))})}_setEventListeners(v,m,Y,nt){var lt,vt,yt;for(const[$t,Ot]of Y)(Ot==="Action"||(lt=this.data.actions)!=null&&lt[Ot])&&((Ot==="Focus"||Ot==="Blur")&&(m||(m={focused:!1})),this._setEventListener(v,m,$t,Ot,nt),Ot==="Focus"&&!((vt=this.data.actions)!=null&&vt.Blur)?this._setEventListener(v,m,"blur","Blur",null):Ot==="Blur"&&!((yt=this.data.actions)!=null&&yt.Focus)&&this._setEventListener(v,m,"focus","Focus",null))}_setBackgroundColor(v){const m=this.data.backgroundColor||null;v.style.backgroundColor=m===null?"transparent":s.Util.makeHexColor(m[0],m[1],m[2])}_setTextStyle(v){const m=["left","center","right"],{fontColor:Y}=this.data.defaultAppearanceData,nt=this.data.defaultAppearanceData.fontSize||W,lt=v.style;let vt;const yt=2,$t=Ot=>Math.round(10*Ot)/10;if(this.data.multiLine){const Ot=Math.abs(this.data.rect[3]-this.data.rect[1]-yt),Et=Math.round(Ot/(s.LINE_FACTOR*nt))||1,It=Ot/Et;vt=Math.min(nt,$t(It/s.LINE_FACTOR))}else{const Ot=Math.abs(this.data.rect[3]-this.data.rect[1]-yt);vt=Math.min(nt,$t(Ot/s.LINE_FACTOR))}lt.fontSize=`calc(${vt}px * var(--scale-factor))`,lt.color=s.Util.makeHexColor(Y[0],Y[1],Y[2]),this.data.textAlignment!==null&&(lt.textAlign=m[this.data.textAlignment])}_setRequired(v,m){m?v.setAttribute("required",!0):v.removeAttribute("required"),v.setAttribute("aria-required",m)}}class N extends tt{constructor(v){const m=v.renderForms||v.data.hasOwnCanvas||!v.data.hasAppearance&&!!v.data.fieldValue;super(v,{isRenderable:m})}setPropertyOnSiblings(v,m,Y,nt){const lt=this.annotationStorage;for(const vt of this._getElementsByName(v.name,v.id))vt.domElement&&(vt.domElement[m]=Y),lt.setValue(vt.id,{[nt]:Y})}render(){var nt,lt;const v=this.annotationStorage,m=this.data.id;this.container.classList.add("textWidgetAnnotation");let Y=null;if(this.renderForms){const vt=v.getValue(m,{value:this.data.fieldValue});let yt=vt.value||"";const $t=v.getValue(m,{charLimit:this.data.maxLen}).charLimit;$t&&yt.length>$t&&(yt=yt.slice(0,$t));let Ot=vt.formattedValue||((nt=this.data.textContent)==null?void 0:nt.join(`
`))||null;Ot&&this.data.comb&&(Ot=Ot.replaceAll(/\s+/g,""));const Et={userValue:yt,formattedValue:Ot,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Y=document.createElement("textarea"),Y.textContent=Ot??yt,this.data.doNotScroll&&(Y.style.overflowY="hidden")):(Y=document.createElement("input"),Y.type="text",Y.setAttribute("value",Ot??yt),this.data.doNotScroll&&(Y.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Y.hidden=!0),x.add(Y),Y.setAttribute("data-element-id",m),Y.disabled=this.data.readOnly,Y.name=this.data.fieldName,Y.tabIndex=M,this._setRequired(Y,this.data.required),$t&&(Y.maxLength=$t),Y.addEventListener("input",Bt=>{v.setValue(m,{value:Bt.target.value}),this.setPropertyOnSiblings(Y,"value",Bt.target.value,"value"),Et.formattedValue=null}),Y.addEventListener("resetform",Bt=>{const _t=this.data.defaultFieldValue??"";Y.value=Et.userValue=_t,Et.formattedValue=null});let It=Bt=>{const{formattedValue:_t}=Et;_t!=null&&(Bt.target.value=_t),Bt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Y.addEventListener("focus",_t=>{var Qt;if(Et.focused)return;const{target:ne}=_t;Et.userValue&&(ne.value=Et.userValue),Et.lastCommittedValue=ne.value,Et.commitKey=1,(Qt=this.data.actions)!=null&&Qt.Focus||(Et.focused=!0)}),Y.addEventListener("updatefromsandbox",_t=>{this.showElementAndHideCanvas(_t.target);const ne={value(Qt){Et.userValue=Qt.detail.value??"",v.setValue(m,{value:Et.userValue.toString()}),Qt.target.value=Et.userValue},formattedValue(Qt){const{formattedValue:le}=Qt.detail;Et.formattedValue=le,le!=null&&Qt.target!==document.activeElement&&(Qt.target.value=le),v.setValue(m,{formattedValue:le})},selRange(Qt){Qt.target.setSelectionRange(...Qt.detail.selRange)},charLimit:Qt=>{var Te;const{charLimit:le}=Qt.detail,{target:ge}=Qt;if(le===0){ge.removeAttribute("maxLength");return}ge.setAttribute("maxLength",le);let _e=Et.userValue;!_e||_e.length<=le||(_e=_e.slice(0,le),ge.value=Et.userValue=_e,v.setValue(m,{value:_e}),(Te=this.linkService.eventBus)==null||Te.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:_e,willCommit:!0,commitKey:1,selStart:ge.selectionStart,selEnd:ge.selectionEnd}}))}};this._dispatchEventFromSandbox(ne,_t)}),Y.addEventListener("keydown",_t=>{var le;Et.commitKey=1;let ne=-1;if(_t.key==="Escape"?ne=0:_t.key==="Enter"&&!this.data.multiLine?ne=2:_t.key==="Tab"&&(Et.commitKey=3),ne===-1)return;const{value:Qt}=_t.target;Et.lastCommittedValue!==Qt&&(Et.lastCommittedValue=Qt,Et.userValue=Qt,(le=this.linkService.eventBus)==null||le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:Qt,willCommit:!0,commitKey:ne,selStart:_t.target.selectionStart,selEnd:_t.target.selectionEnd}}))});const Bt=It;It=null,Y.addEventListener("blur",_t=>{var Qt,le;if(!Et.focused||!_t.relatedTarget)return;(Qt=this.data.actions)!=null&&Qt.Blur||(Et.focused=!1);const{value:ne}=_t.target;Et.userValue=ne,Et.lastCommittedValue!==ne&&((le=this.linkService.eventBus)==null||le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:ne,willCommit:!0,commitKey:Et.commitKey,selStart:_t.target.selectionStart,selEnd:_t.target.selectionEnd}})),Bt(_t)}),(lt=this.data.actions)!=null&&lt.Keystroke&&Y.addEventListener("beforeinput",_t=>{var He;Et.lastCommittedValue=null;const{data:ne,target:Qt}=_t,{value:le,selectionStart:ge,selectionEnd:_e}=Qt;let Te=ge,es=_e;switch(_t.inputType){case"deleteWordBackward":{const Ue=le.substring(0,ge).match(/\w*[^\w]*$/);Ue&&(Te-=Ue[0].length);break}case"deleteWordForward":{const Ue=le.substring(ge).match(/^[^\w]*\w*/);Ue&&(es+=Ue[0].length);break}case"deleteContentBackward":ge===_e&&(Te-=1);break;case"deleteContentForward":ge===_e&&(es+=1);break}_t.preventDefault(),(He=this.linkService.eventBus)==null||He.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:le,change:ne||"",willCommit:!1,selStart:Te,selEnd:es}})}),this._setEventListeners(Y,Et,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_t=>_t.target.value)}if(It&&Y.addEventListener("blur",It),this.data.comb){const _t=(this.data.rect[2]-this.data.rect[0])/$t;Y.classList.add("comb"),Y.style.letterSpacing=`calc(${_t}px * var(--scale-factor) - 1ch)`}}else Y=document.createElement("div"),Y.textContent=this.data.fieldValue,Y.style.verticalAlign="middle",Y.style.display="table-cell",this.data.hasOwnCanvas&&(Y.hidden=!0);return this._setTextStyle(Y),this._setBackgroundColor(Y),this._setDefaultPropertiesFromJS(Y),this.container.append(Y),this.container}}class B extends tt{constructor(v){super(v,{isRenderable:!!v.data.hasOwnCanvas})}}class D extends tt{constructor(v){super(v,{isRenderable:v.renderForms})}render(){const v=this.annotationStorage,m=this.data,Y=m.id;let nt=v.getValue(Y,{value:m.exportValue===m.fieldValue}).value;typeof nt=="string"&&(nt=nt!=="Off",v.setValue(Y,{value:nt})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const lt=document.createElement("input");return x.add(lt),lt.setAttribute("data-element-id",Y),lt.disabled=m.readOnly,this._setRequired(lt,this.data.required),lt.type="checkbox",lt.name=m.fieldName,nt&&lt.setAttribute("checked",!0),lt.setAttribute("exportValue",m.exportValue),lt.tabIndex=M,lt.addEventListener("change",vt=>{const{name:yt,checked:$t}=vt.target;for(const Ot of this._getElementsByName(yt,Y)){const Et=$t&&Ot.exportValue===m.exportValue;Ot.domElement&&(Ot.domElement.checked=Et),v.setValue(Ot.id,{value:Et})}v.setValue(Y,{value:$t})}),lt.addEventListener("resetform",vt=>{const yt=m.defaultFieldValue||"Off";vt.target.checked=yt===m.exportValue}),this.enableScripting&&this.hasJSActions&&(lt.addEventListener("updatefromsandbox",vt=>{const yt={value($t){$t.target.checked=$t.detail.value!=="Off",v.setValue(Y,{value:$t.target.checked})}};this._dispatchEventFromSandbox(yt,vt)}),this._setEventListeners(lt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],vt=>vt.target.checked)),this._setBackgroundColor(lt),this._setDefaultPropertiesFromJS(lt),this.container.append(lt),this.container}}class _ extends tt{constructor(v){super(v,{isRenderable:v.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const v=this.annotationStorage,m=this.data,Y=m.id;let nt=v.getValue(Y,{value:m.fieldValue===m.buttonValue}).value;if(typeof nt=="string"&&(nt=nt!==m.buttonValue,v.setValue(Y,{value:nt})),nt)for(const vt of this._getElementsByName(m.fieldName,Y))v.setValue(vt.id,{value:!1});const lt=document.createElement("input");if(x.add(lt),lt.setAttribute("data-element-id",Y),lt.disabled=m.readOnly,this._setRequired(lt,this.data.required),lt.type="radio",lt.name=m.fieldName,nt&&lt.setAttribute("checked",!0),lt.tabIndex=M,lt.addEventListener("change",vt=>{const{name:yt,checked:$t}=vt.target;for(const Ot of this._getElementsByName(yt,Y))v.setValue(Ot.id,{value:!1});v.setValue(Y,{value:$t})}),lt.addEventListener("resetform",vt=>{const yt=m.defaultFieldValue;vt.target.checked=yt!=null&&yt===m.buttonValue}),this.enableScripting&&this.hasJSActions){const vt=m.buttonValue;lt.addEventListener("updatefromsandbox",yt=>{const $t={value:Ot=>{const Et=vt===Ot.detail.value;for(const It of this._getElementsByName(Ot.target.name)){const Bt=Et&&It.id===Y;It.domElement&&(It.domElement.checked=Bt),v.setValue(It.id,{value:Bt})}}};this._dispatchEventFromSandbox($t,yt)}),this._setEventListeners(lt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],yt=>yt.target.checked)}return this._setBackgroundColor(lt),this._setDefaultPropertiesFromJS(lt),this.container.append(lt),this.container}}class U extends z{constructor(v){super(v,{ignoreBorder:v.data.hasAppearance})}render(){const v=super.render();v.classList.add("buttonWidgetAnnotation","pushButton");const m=v.lastChild;return this.enableScripting&&this.hasJSActions&&m&&(this._setDefaultPropertiesFromJS(m),m.addEventListener("updatefromsandbox",Y=>{this._dispatchEventFromSandbox({},Y)})),v}}class G extends tt{constructor(v){super(v,{isRenderable:v.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const v=this.annotationStorage,m=this.data.id,Y=v.getValue(m,{value:this.data.fieldValue}),nt=document.createElement("select");x.add(nt),nt.setAttribute("data-element-id",m),nt.disabled=this.data.readOnly,this._setRequired(nt,this.data.required),nt.name=this.data.fieldName,nt.tabIndex=M;let lt=this.data.combo&&this.data.options.length>0;this.data.combo||(nt.size=this.data.options.length,this.data.multiSelect&&(nt.multiple=!0)),nt.addEventListener("resetform",Et=>{const It=this.data.defaultFieldValue;for(const Bt of nt.options)Bt.selected=Bt.value===It});for(const Et of this.data.options){const It=document.createElement("option");It.textContent=Et.displayValue,It.value=Et.exportValue,Y.value.includes(Et.exportValue)&&(It.setAttribute("selected",!0),lt=!1),nt.append(It)}let vt=null;if(lt){const Et=document.createElement("option");Et.value=" ",Et.setAttribute("hidden",!0),Et.setAttribute("selected",!0),nt.prepend(Et),vt=()=>{Et.remove(),nt.removeEventListener("input",vt),vt=null},nt.addEventListener("input",vt)}const yt=Et=>{const It=Et?"value":"textContent",{options:Bt,multiple:_t}=nt;return _t?Array.prototype.filter.call(Bt,ne=>ne.selected).map(ne=>ne[It]):Bt.selectedIndex===-1?null:Bt[Bt.selectedIndex][It]};let $t=yt(!1);const Ot=Et=>{const It=Et.target.options;return Array.prototype.map.call(It,Bt=>({displayValue:Bt.textContent,exportValue:Bt.value}))};return this.enableScripting&&this.hasJSActions?(nt.addEventListener("updatefromsandbox",Et=>{const It={value(Bt){vt==null||vt();const _t=Bt.detail.value,ne=new Set(Array.isArray(_t)?_t:[_t]);for(const Qt of nt.options)Qt.selected=ne.has(Qt.value);v.setValue(m,{value:yt(!0)}),$t=yt(!1)},multipleSelection(Bt){nt.multiple=!0},remove(Bt){const _t=nt.options,ne=Bt.detail.remove;_t[ne].selected=!1,nt.remove(ne),_t.length>0&&Array.prototype.findIndex.call(_t,le=>le.selected)===-1&&(_t[0].selected=!0),v.setValue(m,{value:yt(!0),items:Ot(Bt)}),$t=yt(!1)},clear(Bt){for(;nt.length!==0;)nt.remove(0);v.setValue(m,{value:null,items:[]}),$t=yt(!1)},insert(Bt){const{index:_t,displayValue:ne,exportValue:Qt}=Bt.detail.insert,le=nt.children[_t],ge=document.createElement("option");ge.textContent=ne,ge.value=Qt,le?le.before(ge):nt.append(ge),v.setValue(m,{value:yt(!0),items:Ot(Bt)}),$t=yt(!1)},items(Bt){const{items:_t}=Bt.detail;for(;nt.length!==0;)nt.remove(0);for(const ne of _t){const{displayValue:Qt,exportValue:le}=ne,ge=document.createElement("option");ge.textContent=Qt,ge.value=le,nt.append(ge)}nt.options.length>0&&(nt.options[0].selected=!0),v.setValue(m,{value:yt(!0),items:Ot(Bt)}),$t=yt(!1)},indices(Bt){const _t=new Set(Bt.detail.indices);for(const ne of Bt.target.options)ne.selected=_t.has(ne.index);v.setValue(m,{value:yt(!0)}),$t=yt(!1)},editable(Bt){Bt.target.disabled=!Bt.detail.editable}};this._dispatchEventFromSandbox(It,Et)}),nt.addEventListener("input",Et=>{var _t;const It=yt(!0),Bt=yt(!1);v.setValue(m,{value:It}),Et.preventDefault(),(_t=this.linkService.eventBus)==null||_t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:$t,change:Bt,changeEx:It,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(nt,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Et=>Et.target.value)):nt.addEventListener("input",function(Et){v.setValue(m,{value:yt(!0)})}),this.data.combo&&this._setTextStyle(nt),this._setBackgroundColor(nt),this._setDefaultPropertiesFromJS(nt),this.container.append(nt),this.container}}class pt extends R{constructor(v){const{data:m,elements:Y}=v;super(v,{isRenderable:R._hasPopupData(m)}),this.elements=Y}render(){this.container.classList.add("popupAnnotation");const v=new Mt({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),m=[];for(const Y of this.elements)Y.popup=v,m.push(Y.data.id),Y.addHighlightArea();return this.container.setAttribute("aria-controls",m.map(Y=>`${s.AnnotationPrefix}${Y}`).join(",")),this.container}}class Mt{constructor({container:v,color:m,elements:Y,titleObj:nt,modificationDate:lt,contentsObj:vt,richText:yt,parent:$t,rect:Ot,parentRect:Et,open:It}){o(this,At);o(this,O);o(this,q);o(this,et);o(this,r,y(this,At,Dr).bind(this));o(this,c,y(this,et,Rn).bind(this));o(this,l,y(this,q,kn).bind(this));o(this,p,y(this,O,Yi).bind(this));o(this,f,null);o(this,d,null);o(this,A,null);o(this,u,null);o(this,a,null);o(this,h,null);o(this,F,null);o(this,L,!1);o(this,it,null);o(this,dt,null);o(this,ut,null);o(this,wt,null);o(this,bt,!1);var Bt;T(this,d,v),T(this,wt,nt),T(this,A,vt),T(this,ut,yt),T(this,h,$t),T(this,f,m),T(this,dt,Ot),T(this,F,Et),T(this,a,Y),T(this,u,H.PDFDateString.toDateObject(lt)),this.trigger=Y.flatMap(_t=>_t.getElementsToTriggerPopup());for(const _t of this.trigger)_t.addEventListener("click",t(this,p)),_t.addEventListener("mouseenter",t(this,l)),_t.addEventListener("mouseleave",t(this,c)),_t.classList.add("popupTriggerArea");for(const _t of Y)(Bt=_t.container)==null||Bt.addEventListener("keydown",t(this,r));t(this,d).hidden=!0,It&&y(this,O,Yi).call(this)}render(){if(t(this,it))return;const{page:{view:v},viewport:{rawDims:{pageWidth:m,pageHeight:Y,pageX:nt,pageY:lt}}}=t(this,h),vt=T(this,it,document.createElement("div"));if(vt.className="popup",t(this,f)){const Te=vt.style.outlineColor=s.Util.makeHexColor(...t(this,f));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?vt.style.backgroundColor=`color-mix(in srgb, ${Te} 30%, white)`:vt.style.backgroundColor=s.Util.makeHexColor(...t(this,f).map(He=>Math.floor(.7*(255-He)+He)))}const yt=document.createElement("span");yt.className="header";const $t=document.createElement("h1");if(yt.append($t),{dir:$t.dir,str:$t.textContent}=t(this,wt),vt.append(yt),t(this,u)){const Te=document.createElement("span");Te.classList.add("popupDate"),Te.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),Te.setAttribute("data-l10n-args",JSON.stringify({date:t(this,u).toLocaleDateString(),time:t(this,u).toLocaleTimeString()})),yt.append(Te)}const Ot=t(this,A),Et=t(this,ut);if(Et!=null&&Et.str&&(!(Ot!=null&&Ot.str)||Ot.str===Et.str))I.XfaLayer.render({xfaHtml:Et.html,intent:"richText",div:vt}),vt.lastChild.classList.add("richText","popupContent");else{const Te=this._formatContents(Ot);vt.append(Te)}let It=!!t(this,F),Bt=It?t(this,F):t(this,dt);for(const Te of t(this,a))if(!Bt||s.Util.intersect(Te.data.rect,Bt)!==null){Bt=Te.data.rect,It=!0;break}const _t=s.Util.normalizeRect([Bt[0],v[3]-Bt[1]+v[1],Bt[2],v[3]-Bt[3]+v[1]]),Qt=It?Bt[2]-Bt[0]+5:0,le=_t[0]+Qt,ge=_t[1],{style:_e}=t(this,d);_e.left=`${100*(le-nt)/m}%`,_e.top=`${100*(ge-lt)/Y}%`,t(this,d).append(vt)}_formatContents({str:v,dir:m}){const Y=document.createElement("p");Y.classList.add("popupContent"),Y.dir=m;const nt=v.split(/(?:\r\n?|\n)/);for(let lt=0,vt=nt.length;lt<vt;++lt){const yt=nt[lt];Y.append(document.createTextNode(yt)),lt<vt-1&&Y.append(document.createElement("br"))}return Y}forceHide(){T(this,bt,this.isVisible),t(this,bt)&&(t(this,d).hidden=!0)}maybeShow(){t(this,bt)&&(T(this,bt,!1),t(this,d).hidden=!1)}get isVisible(){return t(this,d).hidden===!1}}r=new WeakMap,c=new WeakMap,l=new WeakMap,p=new WeakMap,f=new WeakMap,d=new WeakMap,A=new WeakMap,u=new WeakMap,a=new WeakMap,h=new WeakMap,F=new WeakMap,L=new WeakMap,it=new WeakMap,dt=new WeakMap,ut=new WeakMap,wt=new WeakMap,bt=new WeakMap,At=new WeakSet,Dr=function(v){v.altKey||v.shiftKey||v.ctrlKey||v.metaKey||(v.key==="Enter"||v.key==="Escape"&&t(this,L))&&y(this,O,Yi).call(this)},O=new WeakSet,Yi=function(){T(this,L,!t(this,L)),t(this,L)?(y(this,q,kn).call(this),t(this,d).addEventListener("click",t(this,p)),t(this,d).addEventListener("keydown",t(this,r))):(y(this,et,Rn).call(this),t(this,d).removeEventListener("click",t(this,p)),t(this,d).removeEventListener("keydown",t(this,r)))},q=new WeakSet,kn=function(){t(this,it)||this.render(),this.isVisible?t(this,L)&&t(this,d).classList.add("focused"):(t(this,d).hidden=!1,t(this,d).style.zIndex=parseInt(t(this,d).style.zIndex)+1e3)},et=new WeakSet,Rn=function(){t(this,d).classList.remove("focused"),!(t(this,L)||!this.isVisible)&&(t(this,d).hidden=!0,t(this,d).style.zIndex=parseInt(t(this,d).style.zIndex)-1e3)};class Tt extends R{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0}),this.textContent=v.data.textContent,this.textPosition=v.data.textPosition,this.annotationEditorType=s.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const v=document.createElement("div");v.classList.add("annotationTextContent"),v.setAttribute("role","comment");for(const m of this.textContent){const Y=document.createElement("span");Y.textContent=m,v.append(Y)}this.container.append(v)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class Ft extends R{constructor(m){super(m,{isRenderable:!0,ignoreBorder:!0});o(this,$,null)}render(){this.container.classList.add("lineAnnotation");const m=this.data,{width:Y,height:nt}=g(m.rect),lt=this.svgFactory.create(Y,nt,!0),vt=T(this,$,this.svgFactory.createElement("svg:line"));return vt.setAttribute("x1",m.rect[2]-m.lineCoordinates[0]),vt.setAttribute("y1",m.rect[3]-m.lineCoordinates[1]),vt.setAttribute("x2",m.rect[2]-m.lineCoordinates[2]),vt.setAttribute("y2",m.rect[3]-m.lineCoordinates[3]),vt.setAttribute("stroke-width",m.borderStyle.width||1),vt.setAttribute("stroke","transparent"),vt.setAttribute("fill","transparent"),lt.append(vt),this.container.append(lt),!m.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,$)}addHighlightArea(){this.container.classList.add("highlightArea")}}$=new WeakMap;class Pt extends R{constructor(m){super(m,{isRenderable:!0,ignoreBorder:!0});o(this,j,null)}render(){this.container.classList.add("squareAnnotation");const m=this.data,{width:Y,height:nt}=g(m.rect),lt=this.svgFactory.create(Y,nt,!0),vt=m.borderStyle.width,yt=T(this,j,this.svgFactory.createElement("svg:rect"));return yt.setAttribute("x",vt/2),yt.setAttribute("y",vt/2),yt.setAttribute("width",Y-vt),yt.setAttribute("height",nt-vt),yt.setAttribute("stroke-width",vt||1),yt.setAttribute("stroke","transparent"),yt.setAttribute("fill","transparent"),lt.append(yt),this.container.append(lt),!m.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,j)}addHighlightArea(){this.container.classList.add("highlightArea")}}j=new WeakMap;class Vt extends R{constructor(m){super(m,{isRenderable:!0,ignoreBorder:!0});o(this,ht,null)}render(){this.container.classList.add("circleAnnotation");const m=this.data,{width:Y,height:nt}=g(m.rect),lt=this.svgFactory.create(Y,nt,!0),vt=m.borderStyle.width,yt=T(this,ht,this.svgFactory.createElement("svg:ellipse"));return yt.setAttribute("cx",Y/2),yt.setAttribute("cy",nt/2),yt.setAttribute("rx",Y/2-vt/2),yt.setAttribute("ry",nt/2-vt/2),yt.setAttribute("stroke-width",vt||1),yt.setAttribute("stroke","transparent"),yt.setAttribute("fill","transparent"),lt.append(yt),this.container.append(lt),!m.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,ht)}addHighlightArea(){this.container.classList.add("highlightArea")}}ht=new WeakMap;class Wt extends R{constructor(m){super(m,{isRenderable:!0,ignoreBorder:!0});o(this,xt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const m=this.data,{width:Y,height:nt}=g(m.rect),lt=this.svgFactory.create(Y,nt,!0);let vt=[];for(const $t of m.vertices){const Ot=$t.x-m.rect[0],Et=m.rect[3]-$t.y;vt.push(Ot+","+Et)}vt=vt.join(" ");const yt=T(this,xt,this.svgFactory.createElement(this.svgElementName));return yt.setAttribute("points",vt),yt.setAttribute("stroke-width",m.borderStyle.width||1),yt.setAttribute("stroke","transparent"),yt.setAttribute("fill","transparent"),lt.append(yt),this.container.append(lt),!m.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,xt)}addHighlightArea(){this.container.classList.add("highlightArea")}}xt=new WeakMap;class qt extends Wt{constructor(v){super(v),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class at extends R{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class kt extends R{constructor(m){super(m,{isRenderable:!0,ignoreBorder:!0});o(this,Lt,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=s.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const m=this.data,{width:Y,height:nt}=g(m.rect),lt=this.svgFactory.create(Y,nt,!0);for(const vt of m.inkLists){let yt=[];for(const Ot of vt){const Et=Ot.x-m.rect[0],It=m.rect[3]-Ot.y;yt.push(`${Et},${It}`)}yt=yt.join(" ");const $t=this.svgFactory.createElement(this.svgElementName);t(this,Lt).push($t),$t.setAttribute("points",yt),$t.setAttribute("stroke-width",m.borderStyle.width||1),$t.setAttribute("stroke","transparent"),$t.setAttribute("fill","transparent"),!m.popupRef&&this.hasPopupData&&this._createPopup(),lt.append($t)}return this.container.append(lt),this.container}getElementsToTriggerPopup(){return t(this,Lt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Lt=new WeakMap;class Xt extends R{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class zt extends R{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class ie extends R{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class oe extends R{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class he extends R{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class xe extends R{constructor(m){var lt;super(m,{isRenderable:!0});o(this,Kt);o(this,jt,null);const{filename:Y,content:nt}=this.data.file;this.filename=(0,H.getFilenameFromUrl)(Y,!0),this.content=nt,(lt=this.linkService.eventBus)==null||lt.dispatch("fileattachmentannotation",{source:this,filename:Y,content:nt})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:m,data:Y}=this;let nt;Y.hasAppearance||Y.fillAlpha===0?nt=document.createElement("div"):(nt=document.createElement("img"),nt.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Y.name)?"paperclip":"pushpin"}.svg`,Y.fillAlpha&&Y.fillAlpha<1&&(nt.style=`filter: opacity(${Math.round(Y.fillAlpha*100)}%);`)),nt.addEventListener("dblclick",y(this,Kt,Fn).bind(this)),T(this,jt,nt);const{isMac:lt}=s.FeatureTest.platform;return m.addEventListener("keydown",vt=>{vt.key==="Enter"&&(lt?vt.metaKey:vt.ctrlKey)&&y(this,Kt,Fn).call(this)}),!Y.popupRef&&this.hasPopupData?this._createPopup():nt.classList.add("popupTriggerArea"),m.append(nt),m}getElementsToTriggerPopup(){return t(this,jt)}addHighlightArea(){this.container.classList.add("highlightArea")}}jt=new WeakMap,Kt=new WeakSet,Fn=function(){var m;(m=this.downloadManager)==null||m.openOrDownloadData(this.content,this.filename)};class Me{constructor({div:v,accessibilityManager:m,annotationCanvasMap:Y,annotationEditorUIManager:nt,page:lt,viewport:vt}){o(this,Re);o(this,Ve);o(this,fe,null);o(this,ye,null);o(this,de,new Map);this.div=v,T(this,fe,m),T(this,ye,Y),this.page=lt,this.viewport=vt,this.zIndex=0,this._annotationEditorUIManager=nt}async render(v){var vt;const{annotations:m}=v,Y=this.div;(0,H.setLayerDimensions)(Y,this.viewport);const nt=new Map,lt={data:null,layer:Y,linkService:v.linkService,downloadManager:v.downloadManager,imageResourcesPath:v.imageResourcesPath||"",renderForms:v.renderForms!==!1,svgFactory:new H.DOMSVGFactory,annotationStorage:v.annotationStorage||new w.AnnotationStorage,enableScripting:v.enableScripting===!0,hasJSActions:v.hasJSActions,fieldObjects:v.fieldObjects,parent:this,elements:null};for(const yt of m){if(yt.noHTML)continue;const $t=yt.annotationType===s.AnnotationType.POPUP;if($t){const It=nt.get(yt.id);if(!It)continue;lt.elements=It}else{const{width:It,height:Bt}=g(yt.rect);if(It<=0||Bt<=0)continue}lt.data=yt;const Ot=P.create(lt);if(!Ot.isRenderable)continue;if(!$t&&yt.popupRef){const It=nt.get(yt.popupRef);It?It.push(Ot):nt.set(yt.popupRef,[Ot])}const Et=Ot.render();yt.hidden&&(Et.style.visibility="hidden"),y(this,Re,_r).call(this,Et,yt.id),Ot.annotationEditorType>0&&(t(this,de).set(Ot.data.id,Ot),(vt=this._annotationEditorUIManager)==null||vt.renderAnnotationElement(Ot))}y(this,Ve,Ln).call(this)}update({viewport:v}){const m=this.div;this.viewport=v,(0,H.setLayerDimensions)(m,{rotation:v.rotation}),y(this,Ve,Ln).call(this),m.hidden=!1}getEditableAnnotations(){return Array.from(t(this,de).values())}getEditableAnnotation(v){return t(this,de).get(v)}}fe=new WeakMap,ye=new WeakMap,de=new WeakMap,Re=new WeakSet,_r=function(v,m){var nt;const Y=v.firstChild||v;Y.id=`${s.AnnotationPrefix}${m}`,this.div.append(v),(nt=t(this,fe))==null||nt.moveElementInDOM(this.div,v,Y,!1)},Ve=new WeakSet,Ln=function(){if(!t(this,ye))return;const v=this.div;for(const[m,Y]of t(this,ye)){const nt=v.querySelector(`[data-annotation-id="${m}"]`);if(!nt)continue;Y.className="annotationContent";const{firstChild:lt}=nt;lt?lt.nodeName==="CANVAS"?lt.replaceWith(Y):lt.classList.contains("annotationContent")?lt.after(Y):lt.before(Y):nt.append(Y)}t(this,ye).clear()}},792:(st,ot,k)=>{var I,M,W,Or,g;k.d(ot,{AnnotationStorage:()=>rt,PrintAnnotationStorage:()=>V,SerializableEmpty:()=>X});var s=k(292),H=k(310),w=k(651);const X=Object.freeze({map:null,hash:"",transfer:void 0});class rt{constructor(){o(this,W);o(this,I,!1);o(this,M,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(R,z){const ct=t(this,M).get(R);return ct===void 0?z:Object.assign(z,ct)}getRawValue(R){return t(this,M).get(R)}remove(R){if(t(this,M).delete(R),t(this,M).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const z of t(this,M).values())if(z instanceof H.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(R,z){const ct=t(this,M).get(R);let tt=!1;if(ct!==void 0)for(const[N,B]of Object.entries(z))ct[N]!==B&&(tt=!0,ct[N]=B);else tt=!0,t(this,M).set(R,z);tt&&y(this,W,Or).call(this),z instanceof H.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(z.constructor._type)}has(R){return t(this,M).has(R)}getAll(){return t(this,M).size>0?(0,s.objectFromMap)(t(this,M)):null}setAll(R){for(const[z,ct]of Object.entries(R))this.setValue(z,ct)}get size(){return t(this,M).size}resetModified(){t(this,I)&&(T(this,I,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new V(this)}get serializable(){if(t(this,M).size===0)return X;const R=new Map,z=new w.MurmurHash3_64,ct=[],tt=Object.create(null);let N=!1;for(const[B,D]of t(this,M)){const _=D instanceof H.AnnotationEditor?D.serialize(!1,tt):D;_&&(R.set(B,_),z.update(`${B}:${JSON.stringify(_)}`),N||(N=!!_.bitmap))}if(N)for(const B of R.values())B.bitmap&&ct.push(B.bitmap);return R.size>0?{map:R,hash:z.hexdigest(),transfer:ct}:X}get editorStats(){let R=null;const z=new Map;for(const ct of t(this,M).values()){if(!(ct instanceof H.AnnotationEditor))continue;const tt=ct.telemetryFinalData;if(!tt)continue;const{type:N}=tt;z.has(N)||z.set(N,Object.getPrototypeOf(ct).constructor),R||(R=Object.create(null));const B=R[N]||(R[N]=new Map);for(const[D,_]of Object.entries(tt)){if(D==="type")continue;let U=B.get(D);U||(U=new Map,B.set(D,U));const G=U.get(_)??0;U.set(_,G+1)}}for(const[ct,tt]of z)R[ct]=tt.computeTelemetryFinalData(R[ct]);return R}}I=new WeakMap,M=new WeakMap,W=new WeakSet,Or=function(){t(this,I)||(T(this,I,!0),typeof this.onSetModified=="function"&&this.onSetModified())};class V extends rt{constructor(z){super();o(this,g,void 0);const{map:ct,hash:tt,transfer:N}=z.serializable,B=structuredClone(ct,N?{transfer:N}:null);T(this,g,{map:B,hash:tt,transfer:N})}get print(){(0,s.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,g)}}g=new WeakMap},831:(st,ot,k)=>{k.a(st,async(s,H)=>{var _,U,G,pt,Zs,Tt,ji,Pt,Vt,Wt,qt,at,qi,Xt,zt,ie,oe,he,xe,yi,ce,pe,Pn,ae,Fe;try{let c=function(et){if(typeof et=="string"||et instanceof URL?et={url:et}:(et instanceof ArrayBuffer||ArrayBuffer.isView(et))&&(et={data:et}),typeof et!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!et.url&&!et.data&&!et.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const S=new A,{docId:$}=S,j=et.url?p(et.url):null,ht=et.data?f(et.data):null,xt=et.httpHeaders||null,Lt=et.withCredentials===!0,jt=et.password??null,Kt=et.range instanceof u?et.range:null,De=Number.isInteger(et.rangeChunkSize)&&et.rangeChunkSize>0?et.rangeChunkSize:Zt;let fe=et.worker instanceof it?et.worker:null;const ye=et.verbosity,de=typeof et.docBaseUrl=="string"&&!(0,rt.isDataScheme)(et.docBaseUrl)?et.docBaseUrl:null,Re=typeof et.cMapUrl=="string"?et.cMapUrl:null,Ee=et.cMapPacked!==!1,Ve=et.CMapReaderFactory||i,Le=typeof et.standardFontDataUrl=="string"?et.standardFontDataUrl:null,te=et.StandardFontDataFactory||r,v=et.stopAtErrors!==!0,m=Number.isInteger(et.maxImageSize)&&et.maxImageSize>-1?et.maxImageSize:-1,Y=et.isEvalSupported!==!1,nt=typeof et.isOffscreenCanvasSupported=="boolean"?et.isOffscreenCanvasSupported:!w.isNodeJS,lt=Number.isInteger(et.canvasMaxAreaInBytes)?et.canvasMaxAreaInBytes:-1,vt=typeof et.disableFontFace=="boolean"?et.disableFontFace:w.isNodeJS,yt=et.fontExtraProperties===!0,$t=et.enableXfa===!0,Ot=et.ownerDocument||globalThis.document,Et=et.disableRange===!0,It=et.disableStream===!0,Bt=et.disableAutoFetch===!0,_t=et.pdfBug===!0,ne=Kt?Kt.length:et.length??NaN,Qt=typeof et.useSystemFonts=="boolean"?et.useSystemFonts:!w.isNodeJS&&!vt,le=typeof et.useWorkerFetch=="boolean"?et.useWorkerFetch:Ve===rt.DOMCMapReaderFactory&&te===rt.DOMStandardFontDataFactory&&Re&&Le&&(0,rt.isValidFetchUrl)(Re,document.baseURI)&&(0,rt.isValidFetchUrl)(Le,document.baseURI),ge=et.canvasFactory||new K({ownerDocument:Ot}),_e=et.filterFactory||new n({docId:$,ownerDocument:Ot}),Te=null;(0,w.setVerbosityLevel)(ye);const es={canvasFactory:ge,filterFactory:_e};if(le||(es.cMapReaderFactory=new Ve({baseUrl:Re,isCompressed:Ee}),es.standardFontDataFactory=new te({baseUrl:Le})),!fe){const C={verbosity:ye,port:x.GlobalWorkerOptions.workerPort};fe=C.port?it.fromPort(C):new it(C),S._worker=fe}const He={docId:$,apiVersion:"4.2.67",data:ht,password:jt,disableAutoFetch:Bt,rangeChunkSize:De,length:ne,docBaseUrl:de,enableXfa:$t,evaluatorOptions:{maxImageSize:m,disableFontFace:vt,ignoreErrors:v,isEvalSupported:Y,isOffscreenCanvasSupported:nt,canvasMaxAreaInBytes:lt,fontExtraProperties:yt,useSystemFonts:Qt,cMapUrl:le?Re:null,standardFontDataUrl:le?Le:null}},Ue={ignoreErrors:v,disableFontFace:vt,fontExtraProperties:yt,enableXfa:$t,ownerDocument:Ot,disableAutoFetch:Bt,pdfBug:_t,styleElement:Te};return fe.promise.then(function(){if(S.destroyed)throw new Error("Loading aborted");const C=l(fe,He),ft=new Promise(function(Nt){let Ht;Kt?Ht=new z.PDFDataTransportStream(Kt,{disableRange:Et,disableStream:It}):ht||(Ht=(Jt=>w.isNodeJS?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&(0,rt.isValidFetchUrl)(Jt.url)?new ct.PDFFetchStream(Jt):new N.PDFNodeStream(Jt):(0,rt.isValidFetchUrl)(Jt.url)?new ct.PDFFetchStream(Jt):new tt.PDFNetworkStream(Jt))({url:j,length:ne,httpHeaders:xt,withCredentials:Lt,rangeChunkSize:De,disableRange:Et,disableStream:It})),Nt(Ht)});return Promise.all([C,ft]).then(function([Nt,Ht]){if(S.destroyed)throw new Error("Loading aborted");const Ut=new g.MessageHandler($,Nt,fe.port),Jt=new dt(Ut,S,Ht,Ue,es);S._transport=Jt,Ut.send("Ready",null)})}).catch(S._capability.reject),S},p=function(et){if(et instanceof URL)return et.href;try{return new URL(et,window.location).href}catch{if(w.isNodeJS&&typeof et=="string")return et}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")},f=function(et){if(w.isNodeJS&&typeof Buffer<"u"&&et instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(et instanceof Uint8Array&&et.byteLength===et.buffer.byteLength)return et;if(typeof et=="string")return(0,w.stringToBytes)(et);if(et instanceof ArrayBuffer||ArrayBuffer.isView(et)||typeof et=="object"&&!isNaN(et==null?void 0:et.length))return new Uint8Array(et);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")},d=function(et){return typeof et=="object"&&Number.isInteger(et==null?void 0:et.num)&&et.num>=0&&Number.isInteger(et==null?void 0:et.gen)&&et.gen>=0};k.d(ot,{PDFDataRangeTransport:()=>u,PDFWorker:()=>it,build:()=>O,getDocument:()=>c,version:()=>E});var w=k(292),X=k(792),rt=k(419),V=k(10),I=k(573),M=k(923),W=k(814),x=k(164),g=k(178),P=k(62),R=k(626),z=k(585),ct=k(94),tt=k(457),N=k(786),B=k(50),D=s([I,N]);[I,N]=D.then?(await D)():D;const Zt=65536,Ie=100,ee=5e3,K=w.isNodeJS?I.NodeCanvasFactory:rt.DOMCanvasFactory,i=w.isNodeJS?I.NodeCMapReaderFactory:rt.DOMCMapReaderFactory,n=w.isNodeJS?I.NodeFilterFactory:rt.DOMFilterFactory,r=w.isNodeJS?I.NodeStandardFontDataFactory:rt.DOMStandardFontDataFactory;async function l(et,S){if(et.destroyed)throw new Error("Worker was destroyed");const $=await et.messageHandler.sendWithPromise("GetDocRequest",S,S.data?[S.data.buffer]:null);if(et.destroyed)throw new Error("Worker was destroyed");return $}const Z=class Z{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${gs(Z,_)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var S,$,j;this.destroyed=!0;try{(S=this._worker)!=null&&S.port&&(this._worker._pendingDestroy=!0),await(($=this._transport)==null?void 0:$.destroy())}catch(ht){throw(j=this._worker)!=null&&j.port&&delete this._worker._pendingDestroy,ht}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};_=new WeakMap,o(Z,_,0);let A=Z;class u{constructor(S,$,j=!1,ht=null){this.length=S,this.initialData=$,this.progressiveDone=j,this.contentDispositionFilename=ht,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(S){this._rangeListeners.push(S)}addProgressListener(S){this._progressListeners.push(S)}addProgressiveReadListener(S){this._progressiveReadListeners.push(S)}addProgressiveDoneListener(S){this._progressiveDoneListeners.push(S)}onDataRange(S,$){for(const j of this._rangeListeners)j(S,$)}onDataProgress(S,$){this._readyCapability.promise.then(()=>{for(const j of this._progressListeners)j(S,$)})}onDataProgressiveRead(S){this._readyCapability.promise.then(()=>{for(const $ of this._progressiveReadListeners)$(S)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const S of this._progressiveDoneListeners)S()})}transportReady(){this._readyCapability.resolve()}requestDataRange(S,$){(0,w.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class a{constructor(S,$){this._pdfInfo=S,this._transport=$}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,w.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(S){return this._transport.getPage(S)}getPageIndex(S){return this._transport.getPageIndex(S)}getDestinations(){return this._transport.getDestinations()}getDestination(S){return this._transport.getDestination(S)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:S="display"}={}){const{renderingIntent:$}=this._transport.getRenderingIntent(S);return this._transport.getOptionalContentConfig($)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(S=!1){return this._transport.startCleanup(S||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(S){return this._transport.cachedPageNumber(S)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class h{constructor(S,$,j,ht=!1){o(this,pt);o(this,Tt);o(this,U,null);o(this,G,!1);this._pageIndex=S,this._pageInfo=$,this._transport=j,this._stats=ht?new rt.StatTimer:null,this._pdfBug=ht,this.commonObjs=j.commonObjs,this.objs=new wt,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:S,rotation:$=this.rotate,offsetX:j=0,offsetY:ht=0,dontFlip:xt=!1}={}){return new rt.PageViewport({viewBox:this.view,scale:S,rotation:$,offsetX:j,offsetY:ht,dontFlip:xt})}getAnnotations({intent:S="display"}={}){const{renderingIntent:$}=this._transport.getRenderingIntent(S);return this._transport.getAnnotations(this._pageIndex,$)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,w.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var S;return((S=this._transport._htmlForXfa)==null?void 0:S.children[this._pageIndex])||null}render({canvasContext:S,viewport:$,intent:j="display",annotationMode:ht=w.AnnotationMode.ENABLE,transform:xt=null,background:Lt=null,optionalContentConfigPromise:jt=null,annotationCanvasMap:Kt=null,pageColors:De=null,printAnnotationStorage:fe=null}){var m,Y;(m=this._stats)==null||m.time("Overall");const ye=this._transport.getRenderingIntent(j,ht,fe),{renderingIntent:de,cacheKey:Re}=ye;T(this,G,!1),y(this,Tt,ji).call(this),jt||(jt=this._transport.getOptionalContentConfig(de));let Ee=this._intentStates.get(Re);Ee||(Ee=Object.create(null),this._intentStates.set(Re,Ee)),Ee.streamReaderCancelTimeout&&(clearTimeout(Ee.streamReaderCancelTimeout),Ee.streamReaderCancelTimeout=null);const Ve=!!(de&w.RenderingIntentFlag.PRINT);Ee.displayReadyCapability||(Ee.displayReadyCapability=Promise.withResolvers(),Ee.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Y=this._stats)==null||Y.time("Page Request"),this._pumpOperatorList(ye));const Le=nt=>{var lt,vt;Ee.renderTasks.delete(te),(this._maybeCleanupAfterRender||Ve)&&T(this,G,!0),y(this,pt,Zs).call(this,!Ve),nt?(te.capability.reject(nt),this._abortOperatorList({intentState:Ee,reason:nt instanceof Error?nt:new Error(nt)})):te.capability.resolve(),(lt=this._stats)==null||lt.timeEnd("Rendering"),(vt=this._stats)==null||vt.timeEnd("Overall")},te=new At({callback:Le,params:{canvasContext:S,viewport:$,transform:xt,background:Lt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Kt,operatorList:Ee.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Ve,pdfBug:this._pdfBug,pageColors:De});(Ee.renderTasks||(Ee.renderTasks=new Set)).add(te);const v=te.task;return Promise.all([Ee.displayReadyCapability.promise,jt]).then(([nt,lt])=>{var vt;if(this.destroyed){Le();return}if((vt=this._stats)==null||vt.time("Rendering"),!(lt.renderingIntent&de))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");te.initializeGraphics({transparency:nt,optionalContentConfig:lt}),te.operatorListChanged()}).catch(Le),v}getOperatorList({intent:S="display",annotationMode:$=w.AnnotationMode.ENABLE,printAnnotationStorage:j=null}={}){var Kt;function ht(){Lt.operatorList.lastChunk&&(Lt.opListReadCapability.resolve(Lt.operatorList),Lt.renderTasks.delete(jt))}const xt=this._transport.getRenderingIntent(S,$,j,!0);let Lt=this._intentStates.get(xt.cacheKey);Lt||(Lt=Object.create(null),this._intentStates.set(xt.cacheKey,Lt));let jt;return Lt.opListReadCapability||(jt=Object.create(null),jt.operatorListChanged=ht,Lt.opListReadCapability=Promise.withResolvers(),(Lt.renderTasks||(Lt.renderTasks=new Set)).add(jt),Lt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Kt=this._stats)==null||Kt.time("Page Request"),this._pumpOperatorList(xt)),Lt.opListReadCapability.promise}streamTextContent({includeMarkedContent:S=!1,disableNormalization:$=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:S===!0,disableNormalization:$===!0},{highWaterMark:100,size(ht){return ht.items.length}})}getTextContent(S={}){if(this._transport._htmlForXfa)return this.getXfa().then(j=>B.XfaText.textContent(j));const $=this.streamTextContent(S);return new Promise(function(j,ht){function xt(){Lt.read().then(function({value:Kt,done:De}){if(De){j(jt);return}Object.assign(jt.styles,Kt.styles),jt.items.push(...Kt.items),xt()},ht)}const Lt=$.getReader(),jt={items:[],styles:Object.create(null)};xt()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const S=[];for(const $ of this._intentStates.values())if(this._abortOperatorList({intentState:$,reason:new Error("Page was destroyed."),force:!0}),!$.opListReadCapability)for(const j of $.renderTasks)S.push(j.completed),j.cancel();return this.objs.clear(),T(this,G,!1),y(this,Tt,ji).call(this),Promise.all(S)}cleanup(S=!1){T(this,G,!0);const $=y(this,pt,Zs).call(this,!1);return S&&$&&this._stats&&(this._stats=new rt.StatTimer),$}_startRenderPage(S,$){var ht,xt;const j=this._intentStates.get($);j&&((ht=this._stats)==null||ht.timeEnd("Page Request"),(xt=j.displayReadyCapability)==null||xt.resolve(S))}_renderPageChunk(S,$){for(let j=0,ht=S.length;j<ht;j++)$.operatorList.fnArray.push(S.fnArray[j]),$.operatorList.argsArray.push(S.argsArray[j]);$.operatorList.lastChunk=S.lastChunk,$.operatorList.separateAnnots=S.separateAnnots;for(const j of $.renderTasks)j.operatorListChanged();S.lastChunk&&y(this,pt,Zs).call(this,!0)}_pumpOperatorList({renderingIntent:S,cacheKey:$,annotationStorageSerializable:j}){const{map:ht,transfer:xt}=j,jt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:S,cacheKey:$,annotationStorage:ht},xt).getReader(),Kt=this._intentStates.get($);Kt.streamReader=jt;const De=()=>{jt.read().then(({value:fe,done:ye})=>{if(ye){Kt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(fe,Kt),De())},fe=>{if(Kt.streamReader=null,!this._transport.destroyed){if(Kt.operatorList){Kt.operatorList.lastChunk=!0;for(const ye of Kt.renderTasks)ye.operatorListChanged();y(this,pt,Zs).call(this,!0)}if(Kt.displayReadyCapability)Kt.displayReadyCapability.reject(fe);else if(Kt.opListReadCapability)Kt.opListReadCapability.reject(fe);else throw fe}})};De()}_abortOperatorList({intentState:S,reason:$,force:j=!1}){if(S.streamReader){if(S.streamReaderCancelTimeout&&(clearTimeout(S.streamReaderCancelTimeout),S.streamReaderCancelTimeout=null),!j){if(S.renderTasks.size>0)return;if($ instanceof rt.RenderingCancelledException){let ht=Ie;$.extraDelay>0&&$.extraDelay<1e3&&(ht+=$.extraDelay),S.streamReaderCancelTimeout=setTimeout(()=>{S.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:S,reason:$,force:!0})},ht);return}}if(S.streamReader.cancel(new w.AbortException($.message)).catch(()=>{}),S.streamReader=null,!this._transport.destroyed){for(const[ht,xt]of this._intentStates)if(xt===S){this._intentStates.delete(ht);break}this.cleanup()}}}get stats(){return this._stats}}U=new WeakMap,G=new WeakMap,pt=new WeakSet,Zs=function(S=!1){if(y(this,Tt,ji).call(this),!t(this,G)||this.destroyed)return!1;if(S)return T(this,U,setTimeout(()=>{T(this,U,null),y(this,pt,Zs).call(this,!1)},ee)),!1;for(const{renderTasks:$,operatorList:j}of this._intentStates.values())if($.size>0||!j.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),T(this,G,!1),!0},Tt=new WeakSet,ji=function(){t(this,U)&&(clearTimeout(t(this,U)),T(this,U,null))};class F{constructor(){o(this,Pt,new Set);o(this,Vt,Promise.resolve())}postMessage(S,$){const j={data:structuredClone(S,$?{transfer:$}:null)};t(this,Vt).then(()=>{for(const ht of t(this,Pt))ht.call(this,j)})}addEventListener(S,$){t(this,Pt).add($)}removeEventListener(S,$){t(this,Pt).delete($)}terminate(){t(this,Pt).clear()}}Pt=new WeakMap,Vt=new WeakMap;const L={isWorkerDisabled:!1,fakeWorkerId:0};w.isNodeJS&&(L.isWorkerDisabled=!0,(Wt=x.GlobalWorkerOptions).workerSrc||(Wt.workerSrc="./pdf.worker.mjs")),L.isSameOrigin=function(et,S){let $;try{if($=new URL(et),!$.origin||$.origin==="null")return!1}catch{return!1}const j=new URL(S,$);return $.origin===j.origin},L.createCDNWrapper=function(et){const S=`await import("${et}");`;return URL.createObjectURL(new Blob([S],{type:"text/javascript"}))};const q=class q{constructor({name:S=null,port:$=null,verbosity:j=(0,w.getVerbosityLevel)()}={}){var ht;if(this.name=S,this.destroyed=!1,this.verbosity=j,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,$){if((ht=t(q,qt))!=null&&ht.has($))throw new Error("Cannot use more than one PDFWorker per port.");(t(q,qt)||T(q,qt,new WeakMap)).set($,this),this._initializeFromPort($);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(S){this._port=S,this._messageHandler=new g.MessageHandler("main","worker",S),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!L.isWorkerDisabled&&!t(q,at,qi)){let{workerSrc:S}=q;try{L.isSameOrigin(window.location.href,S)||(S=L.createCDNWrapper(new URL(S,window.location).href));const $=new Worker(S,{type:"module"}),j=new g.MessageHandler("main","worker",$),ht=()=>{$.removeEventListener("error",xt),j.destroy(),$.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},xt=()=>{this._webWorker||ht()};$.addEventListener("error",xt),j.on("test",jt=>{if($.removeEventListener("error",xt),this.destroyed){ht();return}jt?(this._messageHandler=j,this._port=$,this._webWorker=$,this._readyCapability.resolve(),j.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),j.destroy(),$.terminate())}),j.on("ready",jt=>{if($.removeEventListener("error",xt),this.destroyed){ht();return}try{Lt()}catch{this._setupFakeWorker()}});const Lt=()=>{const jt=new Uint8Array;j.send("test",jt,[jt.buffer])};Lt();return}catch{(0,w.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){L.isWorkerDisabled||((0,w.warn)("Setting up fake worker."),L.isWorkerDisabled=!0),q._setupFakeWorkerGlobal.then(S=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const $=new F;this._port=$;const j=`fake${L.fakeWorkerId++}`,ht=new g.MessageHandler(j+"_worker",j,$);S.setup(ht,$);const xt=new g.MessageHandler(j,j+"_worker",$);this._messageHandler=xt,this._readyCapability.resolve(),xt.send("configure",{verbosity:this.verbosity})}).catch(S=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${S.message}".`))})}destroy(){var S;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(S=t(q,qt))==null||S.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(S){var j;if(!(S!=null&&S.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const $=(j=t(this,qt))==null?void 0:j.get(S.port);if($){if($._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return $}return new q(S)}static get workerSrc(){if(x.GlobalWorkerOptions.workerSrc)return x.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){const S=async()=>t(this,at,qi)?t(this,at,qi):(await import(this.workerSrc)).WorkerMessageHandler;return(0,w.shadow)(this,"_setupFakeWorkerGlobal",S())}};qt=new WeakMap,at=new WeakSet,qi=function(){var S;try{return((S=globalThis.pdfjsWorker)==null?void 0:S.WorkerMessageHandler)||null}catch{return null}},o(q,at),o(q,qt,void 0);let it=q;class dt{constructor(S,$,j,ht,xt){o(this,xe);o(this,Xt,new Map);o(this,zt,new Map);o(this,ie,new Map);o(this,oe,new Map);o(this,he,null);this.messageHandler=S,this.loadingTask=$,this.commonObjs=new wt,this.fontLoader=new V.FontLoader({ownerDocument:ht.ownerDocument,styleElement:ht.styleElement}),this._params=ht,this.canvasFactory=xt.canvasFactory,this.filterFactory=xt.filterFactory,this.cMapReaderFactory=xt.cMapReaderFactory,this.standardFontDataFactory=xt.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=j,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return(0,w.shadow)(this,"annotationStorage",new X.AnnotationStorage)}getRenderingIntent(S,$=w.AnnotationMode.ENABLE,j=null,ht=!1){let xt=w.RenderingIntentFlag.DISPLAY,Lt=X.SerializableEmpty;switch(S){case"any":xt=w.RenderingIntentFlag.ANY;break;case"display":break;case"print":xt=w.RenderingIntentFlag.PRINT;break;default:(0,w.warn)(`getRenderingIntent - invalid intent: ${S}`)}switch($){case w.AnnotationMode.DISABLE:xt+=w.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case w.AnnotationMode.ENABLE:break;case w.AnnotationMode.ENABLE_FORMS:xt+=w.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case w.AnnotationMode.ENABLE_STORAGE:xt+=w.RenderingIntentFlag.ANNOTATIONS_STORAGE,Lt=(xt&w.RenderingIntentFlag.PRINT&&j instanceof X.PrintAnnotationStorage?j:this.annotationStorage).serializable;break;default:(0,w.warn)(`getRenderingIntent - invalid annotationMode: ${$}`)}return ht&&(xt+=w.RenderingIntentFlag.OPLIST),{renderingIntent:xt,cacheKey:`${xt}_${Lt.hash}`,annotationStorageSerializable:Lt}}destroy(){var j;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(j=t(this,he))==null||j.reject(new Error("Worker was destroyed during onPassword callback"));const S=[];for(const ht of t(this,zt).values())S.push(ht._destroy());t(this,zt).clear(),t(this,ie).clear(),t(this,oe).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const $=this.messageHandler.sendWithPromise("Terminate",null);return S.push($),Promise.all(S).then(()=>{var ht;this.commonObjs.clear(),this.fontLoader.clear(),t(this,Xt).clear(),this.filterFactory.destroy(),(0,W.cleanupTextLayer)(),(ht=this._networkStream)==null||ht.cancelAllRequests(new w.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:S,loadingTask:$}=this;S.on("GetReader",(j,ht)=>{(0,w.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=xt=>{this._lastProgress={loaded:xt.loaded,total:xt.total}},ht.onPull=()=>{this._fullReader.read().then(function({value:xt,done:Lt}){if(Lt){ht.close();return}(0,w.assert)(xt instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),ht.enqueue(new Uint8Array(xt),1,[xt])}).catch(xt=>{ht.error(xt)})},ht.onCancel=xt=>{this._fullReader.cancel(xt),ht.ready.catch(Lt=>{if(!this.destroyed)throw Lt})}}),S.on("ReaderHeadersReady",j=>{const ht=Promise.withResolvers(),xt=this._fullReader;return xt.headersReady.then(()=>{var Lt;(!xt.isStreamingSupported||!xt.isRangeSupported)&&(this._lastProgress&&((Lt=$.onProgress)==null||Lt.call($,this._lastProgress)),xt.onProgress=jt=>{var Kt;(Kt=$.onProgress)==null||Kt.call($,{loaded:jt.loaded,total:jt.total})}),ht.resolve({isStreamingSupported:xt.isStreamingSupported,isRangeSupported:xt.isRangeSupported,contentLength:xt.contentLength})},ht.reject),ht.promise}),S.on("GetRangeReader",(j,ht)=>{(0,w.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const xt=this._networkStream.getRangeReader(j.begin,j.end);if(!xt){ht.close();return}ht.onPull=()=>{xt.read().then(function({value:Lt,done:jt}){if(jt){ht.close();return}(0,w.assert)(Lt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),ht.enqueue(new Uint8Array(Lt),1,[Lt])}).catch(Lt=>{ht.error(Lt)})},ht.onCancel=Lt=>{xt.cancel(Lt),ht.ready.catch(jt=>{if(!this.destroyed)throw jt})}}),S.on("GetDoc",({pdfInfo:j})=>{this._numPages=j.numPages,this._htmlForXfa=j.htmlForXfa,delete j.htmlForXfa,$._capability.resolve(new a(j,this))}),S.on("DocException",function(j){let ht;switch(j.name){case"PasswordException":ht=new w.PasswordException(j.message,j.code);break;case"InvalidPDFException":ht=new w.InvalidPDFException(j.message);break;case"MissingPDFException":ht=new w.MissingPDFException(j.message);break;case"UnexpectedResponseException":ht=new w.UnexpectedResponseException(j.message,j.status);break;case"UnknownErrorException":ht=new w.UnknownErrorException(j.message,j.details);break;default:(0,w.unreachable)("DocException - expected a valid Error.")}$._capability.reject(ht)}),S.on("PasswordRequest",j=>{if(T(this,he,Promise.withResolvers()),$.onPassword){const ht=xt=>{xt instanceof Error?t(this,he).reject(xt):t(this,he).resolve({password:xt})};try{$.onPassword(ht,j.code)}catch(xt){t(this,he).reject(xt)}}else t(this,he).reject(new w.PasswordException(j.message,j.code));return t(this,he).promise}),S.on("DataLoaded",j=>{var ht;(ht=$.onProgress)==null||ht.call($,{loaded:j.length,total:j.length}),this.downloadInfoCapability.resolve(j)}),S.on("StartRenderPage",j=>{if(this.destroyed)return;t(this,zt).get(j.pageIndex)._startRenderPage(j.transparency,j.cacheKey)}),S.on("commonobj",([j,ht,xt])=>{var Lt;if(this.destroyed||this.commonObjs.has(j))return null;switch(ht){case"Font":const jt=this._params;if("error"in xt){const ye=xt.error;(0,w.warn)(`Error during font loading: ${ye}`),this.commonObjs.resolve(j,ye);break}const Kt=jt.pdfBug&&((Lt=globalThis.FontInspector)!=null&&Lt.enabled)?(ye,de)=>globalThis.FontInspector.fontAdded(ye,de):null,De=new V.FontFaceObject(xt,{disableFontFace:jt.disableFontFace,ignoreErrors:jt.ignoreErrors,inspectFont:Kt});this.fontLoader.bind(De).catch(()=>S.sendWithPromise("FontFallback",{id:j})).finally(()=>{!jt.fontExtraProperties&&De.data&&(De.data=null),this.commonObjs.resolve(j,De)});break;case"CopyLocalImage":const{imageRef:fe}=xt;(0,w.assert)(fe,"The imageRef must be defined.");for(const ye of t(this,zt).values())for(const[,de]of ye.objs)if(de.ref===fe)return de.dataLen?(this.commonObjs.resolve(j,structuredClone(de)),de.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(j,xt);break;default:throw new Error(`Got unknown common object type ${ht}`)}return null}),S.on("obj",([j,ht,xt,Lt])=>{var Kt;if(this.destroyed)return;const jt=t(this,zt).get(ht);if(!jt.objs.has(j)){if(jt._intentStates.size===0){(Kt=Lt==null?void 0:Lt.bitmap)==null||Kt.close();return}switch(xt){case"Image":jt.objs.resolve(j,Lt),(Lt==null?void 0:Lt.dataLen)>w.MAX_IMAGE_SIZE_TO_CACHE&&(jt._maybeCleanupAfterRender=!0);break;case"Pattern":jt.objs.resolve(j,Lt);break;default:throw new Error(`Got unknown object type ${xt}`)}}}),S.on("DocProgress",j=>{var ht;this.destroyed||(ht=$.onProgress)==null||ht.call($,{loaded:j.loaded,total:j.total})}),S.on("FetchBuiltInCMap",j=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(j):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),S.on("FetchStandardFontData",j=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(j):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var j;this.annotationStorage.size<=0&&(0,w.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:S,transfer:$}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:S,filename:((j=this._fullReader)==null?void 0:j.filename)??null},$).finally(()=>{this.annotationStorage.resetModified()})}getPage(S){if(!Number.isInteger(S)||S<=0||S>this._numPages)return Promise.reject(new Error("Invalid page request."));const $=S-1,j=t(this,ie).get($);if(j)return j;const ht=this.messageHandler.sendWithPromise("GetPage",{pageIndex:$}).then(xt=>{if(this.destroyed)throw new Error("Transport destroyed");xt.refStr&&t(this,oe).set(xt.refStr,S);const Lt=new h($,xt,this,this._params.pdfBug);return t(this,zt).set($,Lt),Lt});return t(this,ie).set($,ht),ht}getPageIndex(S){return d(S)?this.messageHandler.sendWithPromise("GetPageIndex",{num:S.num,gen:S.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(S,$){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:S,intent:$})}getFieldObjects(){return y(this,xe,yi).call(this,"GetFieldObjects")}hasJSActions(){return y(this,xe,yi).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(S){return typeof S!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:S})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return y(this,xe,yi).call(this,"GetDocJSActions")}getPageJSActions(S){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:S})}getStructTree(S){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:S})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(S){return y(this,xe,yi).call(this,"GetOptionalContentConfig").then($=>new R.OptionalContentConfig($,S))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const S="GetMetadata",$=t(this,Xt).get(S);if($)return $;const j=this.messageHandler.sendWithPromise(S,null).then(ht=>{var xt,Lt;return{info:ht[0],metadata:ht[1]?new P.Metadata(ht[1]):null,contentDispositionFilename:((xt=this._fullReader)==null?void 0:xt.filename)??null,contentLength:((Lt=this._fullReader)==null?void 0:Lt.contentLength)??null}});return t(this,Xt).set(S,j),j}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(S=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const $ of t(this,zt).values())if(!$.cleanup())throw new Error(`startCleanup: Page ${$.pageNumber} is currently rendering.`);this.commonObjs.clear(),S||this.fontLoader.clear(),t(this,Xt).clear(),this.filterFactory.destroy(!0),(0,W.cleanupTextLayer)()}}cachedPageNumber(S){if(!d(S))return null;const $=S.gen===0?`${S.num}R`:`${S.num}R${S.gen}`;return t(this,oe).get($)??null}get loadingParams(){const{disableAutoFetch:S,enableXfa:$}=this._params;return(0,w.shadow)(this,"loadingParams",{disableAutoFetch:S,enableXfa:$})}}Xt=new WeakMap,zt=new WeakMap,ie=new WeakMap,oe=new WeakMap,he=new WeakMap,xe=new WeakSet,yi=function(S,$=null){const j=t(this,Xt).get(S);if(j)return j;const ht=this.messageHandler.sendWithPromise(S,$);return t(this,Xt).set(S,ht),ht};const ut=Symbol("INITIAL_DATA");class wt{constructor(){o(this,pe);o(this,ce,Object.create(null))}get(S,$=null){if($){const ht=y(this,pe,Pn).call(this,S);return ht.promise.then(()=>$(ht.data)),null}const j=t(this,ce)[S];if(!j||j.data===ut)throw new Error(`Requesting object that isn't resolved yet ${S}.`);return j.data}has(S){const $=t(this,ce)[S];return!!$&&$.data!==ut}resolve(S,$=null){const j=y(this,pe,Pn).call(this,S);j.data=$,j.resolve()}clear(){var S;for(const $ in t(this,ce)){const{data:j}=t(this,ce)[$];(S=j==null?void 0:j.bitmap)==null||S.close()}T(this,ce,Object.create(null))}*[Symbol.iterator](){for(const S in t(this,ce)){const{data:$}=t(this,ce)[S];$!==ut&&(yield[S,$])}}}ce=new WeakMap,pe=new WeakSet,Pn=function(S){var $;return($=t(this,ce))[S]||($[S]={...Promise.withResolvers(),data:ut})};class bt{constructor(S){o(this,ae,null);T(this,ae,S),this.onContinue=null}get promise(){return t(this,ae).capability.promise}cancel(S=0){t(this,ae).cancel(null,S)}get separateAnnots(){const{separateAnnots:S}=t(this,ae).operatorList;if(!S)return!1;const{annotationCanvasMap:$}=t(this,ae);return S.form||S.canvas&&($==null?void 0:$.size)>0}}ae=new WeakMap;const St=class St{constructor({callback:S,params:$,objs:j,commonObjs:ht,annotationCanvasMap:xt,operatorList:Lt,pageIndex:jt,canvasFactory:Kt,filterFactory:De,useRequestAnimationFrame:fe=!1,pdfBug:ye=!1,pageColors:de=null}){this.callback=S,this.params=$,this.objs=j,this.commonObjs=ht,this.annotationCanvasMap=xt,this.operatorListIdx=null,this.operatorList=Lt,this._pageIndex=jt,this.canvasFactory=Kt,this.filterFactory=De,this._pdfBug=ye,this.pageColors=de,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=fe===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new bt(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=$.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:S=!1,optionalContentConfig:$}){var jt,Kt;if(this.cancelled)return;if(this._canvas){if(t(St,Fe).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(St,Fe).add(this._canvas)}this._pdfBug&&((jt=globalThis.StepperManager)!=null&&jt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:j,viewport:ht,transform:xt,background:Lt}=this.params;this.gfx=new M.CanvasGraphics(j,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:$},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:xt,viewport:ht,transparency:S,background:Lt}),this.operatorListIdx=0,this.graphicsReady=!0,(Kt=this.graphicsReadyCallback)==null||Kt.call(this)}cancel(S=null,$=0){var j;this.running=!1,this.cancelled=!0,(j=this.gfx)==null||j.endDrawing(),t(St,Fe).delete(this._canvas),this.callback(S||new rt.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,$))}operatorListChanged(){var S;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(S=this.stepper)==null||S.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(St,Fe).delete(this._canvas),this.callback())))}};Fe=new WeakMap,o(St,Fe,new WeakSet);let At=St;const E="4.2.67",O="49b388101";H()}catch(Zt){H(Zt)}})},583:(st,ot,k)=>{k.d(ot,{BaseCMapReaderFactory:()=>X,BaseCanvasFactory:()=>w,BaseFilterFactory:()=>H,BaseSVGFactory:()=>V,BaseStandardFontDataFactory:()=>rt});var s=k(292);class H{constructor(){this.constructor===H&&(0,s.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(M){return"none"}addHCMFilter(M,W){return"none"}addHighlightHCMFilter(M,W,x,g,P){return"none"}destroy(M=!1){}}class w{constructor(){this.constructor===w&&(0,s.unreachable)("Cannot initialize BaseCanvasFactory.")}create(M,W){if(M<=0||W<=0)throw new Error("Invalid canvas size");const x=this._createCanvas(M,W);return{canvas:x,context:x.getContext("2d")}}reset(M,W,x){if(!M.canvas)throw new Error("Canvas is not specified");if(W<=0||x<=0)throw new Error("Invalid canvas size");M.canvas.width=W,M.canvas.height=x}destroy(M){if(!M.canvas)throw new Error("Canvas is not specified");M.canvas.width=0,M.canvas.height=0,M.canvas=null,M.context=null}_createCanvas(M,W){(0,s.unreachable)("Abstract method `_createCanvas` called.")}}class X{constructor({baseUrl:M=null,isCompressed:W=!0}){this.constructor===X&&(0,s.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=M,this.isCompressed=W}async fetch({name:M}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!M)throw new Error("CMap name must be specified.");const W=this.baseUrl+M+(this.isCompressed?".bcmap":""),x=this.isCompressed?s.CMapCompressionType.BINARY:s.CMapCompressionType.NONE;return this._fetchData(W,x).catch(g=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${W}`)})}_fetchData(M,W){(0,s.unreachable)("Abstract method `_fetchData` called.")}}class rt{constructor({baseUrl:M=null}){this.constructor===rt&&(0,s.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=M}async fetch({filename:M}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!M)throw new Error("Font filename must be specified.");const W=`${this.baseUrl}${M}`;return this._fetchData(W).catch(x=>{throw new Error(`Unable to load font data at: ${W}`)})}_fetchData(M){(0,s.unreachable)("Abstract method `_fetchData` called.")}}class V{constructor(){this.constructor===V&&(0,s.unreachable)("Cannot initialize BaseSVGFactory.")}create(M,W,x=!1){if(M<=0||W<=0)throw new Error("Invalid SVG dimensions");const g=this._createSVG("svg:svg");return g.setAttribute("version","1.1"),x||(g.setAttribute("width",`${M}px`),g.setAttribute("height",`${W}px`)),g.setAttribute("preserveAspectRatio","none"),g.setAttribute("viewBox",`0 0 ${M} ${W}`),g}createElement(M){if(typeof M!="string")throw new Error("Invalid SVG element type");return this._createSVG(M)}_createSVG(M){(0,s.unreachable)("Abstract method `_createSVG` called.")}}},923:(st,ot,k)=>{var ae,Mn,Zt,In;k.d(ot,{CanvasGraphics:()=>pe});var s=k(292),H=k(419);const w={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function X(K,i){if(!i)return;const n=i[2]-i[0],r=i[3]-i[1],c=new Path2D;c.rect(i[0],i[1],n,r),K.clip(c)}class rt{constructor(){this.constructor===rt&&(0,s.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,s.unreachable)("Abstract method `getPattern` called.")}}class V extends rt{constructor(i){super(),this._type=i[1],this._bbox=i[2],this._colorStops=i[3],this._p0=i[4],this._p1=i[5],this._r0=i[6],this._r1=i[7],this.matrix=null}_createGradient(i){let n;this._type==="axial"?n=i.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(n=i.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)n.addColorStop(r[0],r[1]);return n}getPattern(i,n,r,c){let l;if(c===w.STROKE||c===w.FILL){const p=n.current.getClippedPathBoundingBox(c,(0,H.getCurrentTransform)(i))||[0,0,0,0],f=Math.ceil(p[2]-p[0])||1,d=Math.ceil(p[3]-p[1])||1,A=n.cachedCanvases.getCanvas("pattern",f,d,!0),u=A.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-p[0],-p[1]),r=s.Util.transform(r,[1,0,0,1,p[0],p[1]]),u.transform(...n.baseTransform),this.matrix&&u.transform(...this.matrix),X(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),l=i.createPattern(A.canvas,"no-repeat");const a=new DOMMatrix(r);l.setTransform(a)}else X(i,this._bbox),l=this._createGradient(i);return l}}function I(K,i,n,r,c,l,p,f){const d=i.coords,A=i.colors,u=K.data,a=K.width*4;let h;d[n+1]>d[r+1]&&(h=n,n=r,r=h,h=l,l=p,p=h),d[r+1]>d[c+1]&&(h=r,r=c,c=h,h=p,p=f,f=h),d[n+1]>d[r+1]&&(h=n,n=r,r=h,h=l,l=p,p=h);const F=(d[n]+i.offsetX)*i.scaleX,L=(d[n+1]+i.offsetY)*i.scaleY,it=(d[r]+i.offsetX)*i.scaleX,dt=(d[r+1]+i.offsetY)*i.scaleY,ut=(d[c]+i.offsetX)*i.scaleX,wt=(d[c+1]+i.offsetY)*i.scaleY;if(L>=wt)return;const bt=A[l],At=A[l+1],E=A[l+2],O=A[p],Z=A[p+1],q=A[p+2],St=A[f],et=A[f+1],S=A[f+2],$=Math.round(L),j=Math.round(wt);let ht,xt,Lt,jt,Kt,De,fe,ye;for(let de=$;de<=j;de++){if(de<dt){const te=de<L?0:(L-de)/(L-dt);ht=F-(F-it)*te,xt=bt-(bt-O)*te,Lt=At-(At-Z)*te,jt=E-(E-q)*te}else{let te;de>wt?te=1:dt===wt?te=0:te=(dt-de)/(dt-wt),ht=it-(it-ut)*te,xt=O-(O-St)*te,Lt=Z-(Z-et)*te,jt=q-(q-S)*te}let Re;de<L?Re=0:de>wt?Re=1:Re=(L-de)/(L-wt),Kt=F-(F-ut)*Re,De=bt-(bt-St)*Re,fe=At-(At-et)*Re,ye=E-(E-S)*Re;const Ee=Math.round(Math.min(ht,Kt)),Ve=Math.round(Math.max(ht,Kt));let Le=a*de+Ee*4;for(let te=Ee;te<=Ve;te++)Re=(ht-te)/(ht-Kt),Re<0?Re=0:Re>1&&(Re=1),u[Le++]=xt-(xt-De)*Re|0,u[Le++]=Lt-(Lt-fe)*Re|0,u[Le++]=jt-(jt-ye)*Re|0,u[Le++]=255}}function M(K,i,n){const r=i.coords,c=i.colors;let l,p;switch(i.type){case"lattice":const f=i.verticesPerRow,d=Math.floor(r.length/f)-1,A=f-1;for(l=0;l<d;l++){let u=l*f;for(let a=0;a<A;a++,u++)I(K,n,r[u],r[u+1],r[u+f],c[u],c[u+1],c[u+f]),I(K,n,r[u+f+1],r[u+1],r[u+f],c[u+f+1],c[u+1],c[u+f])}break;case"triangles":for(l=0,p=r.length;l<p;l+=3)I(K,n,r[l],r[l+1],r[l+2],c[l],c[l+1],c[l+2]);break;default:throw new Error("illegal figure")}}class W extends rt{constructor(i){super(),this._coords=i[2],this._colors=i[3],this._figures=i[4],this._bounds=i[5],this._bbox=i[7],this._background=i[8],this.matrix=null}_createMeshCanvas(i,n,r){const f=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),A=Math.ceil(this._bounds[2])-f,u=Math.ceil(this._bounds[3])-d,a=Math.min(Math.ceil(Math.abs(A*i[0]*1.1)),3e3),h=Math.min(Math.ceil(Math.abs(u*i[1]*1.1)),3e3),F=A/a,L=u/h,it={coords:this._coords,colors:this._colors,offsetX:-f,offsetY:-d,scaleX:1/F,scaleY:1/L},dt=a+2*2,ut=h+2*2,wt=r.getCanvas("mesh",dt,ut,!1),bt=wt.context,At=bt.createImageData(a,h);if(n){const O=At.data;for(let Z=0,q=O.length;Z<q;Z+=4)O[Z]=n[0],O[Z+1]=n[1],O[Z+2]=n[2],O[Z+3]=255}for(const O of this._figures)M(At,O,it);return bt.putImageData(At,2,2),{canvas:wt.canvas,offsetX:f-2*F,offsetY:d-2*L,scaleX:F,scaleY:L}}getPattern(i,n,r,c){X(i,this._bbox);let l;if(c===w.SHADING)l=s.Util.singularValueDecompose2dScale((0,H.getCurrentTransform)(i));else if(l=s.Util.singularValueDecompose2dScale(n.baseTransform),this.matrix){const f=s.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*f[0],l[1]*f[1]]}const p=this._createMeshCanvas(l,c===w.SHADING?null:this._background,n.cachedCanvases);return c!==w.SHADING&&(i.setTransform(...n.baseTransform),this.matrix&&i.transform(...this.matrix)),i.translate(p.offsetX,p.offsetY),i.scale(p.scaleX,p.scaleY),i.createPattern(p.canvas,"no-repeat")}}class x extends rt{getPattern(){return"hotpink"}}function g(K){switch(K[0]){case"RadialAxial":return new V(K);case"Mesh":return new W(K);case"Dummy":return new x}throw new Error(`Unknown IR type: ${K[0]}`)}const P={COLORED:1,UNCOLORED:2},re=class re{constructor(i,n,r,c,l){this.operatorList=i[2],this.matrix=i[3]||[1,0,0,1,0,0],this.bbox=i[4],this.xstep=i[5],this.ystep=i[6],this.paintType=i[7],this.tilingType=i[8],this.color=n,this.ctx=r,this.canvasGraphicsFactory=c,this.baseTransform=l}createPatternCanvas(i){const n=this.operatorList,r=this.bbox,c=this.xstep,l=this.ystep,p=this.paintType,f=this.tilingType,d=this.color,A=this.canvasGraphicsFactory;(0,s.info)("TilingType: "+f);const u=r[0],a=r[1],h=r[2],F=r[3],L=s.Util.singularValueDecompose2dScale(this.matrix),it=s.Util.singularValueDecompose2dScale(this.baseTransform),dt=[L[0]*it[0],L[1]*it[1]],ut=this.getSizeAndScale(c,this.ctx.canvas.width,dt[0]),wt=this.getSizeAndScale(l,this.ctx.canvas.height,dt[1]),bt=i.cachedCanvases.getCanvas("pattern",ut.size,wt.size,!0),At=bt.context,E=A.createCanvasGraphics(At);E.groupLevel=i.groupLevel,this.setFillAndStrokeStyleToContext(E,p,d);let O=u,Z=a,q=h,St=F;return u<0&&(O=0,q+=Math.abs(u)),a<0&&(Z=0,St+=Math.abs(a)),At.translate(-(ut.scale*O),-(wt.scale*Z)),E.transform(ut.scale,0,0,wt.scale,0,0),At.save(),this.clipBbox(E,O,Z,q,St),E.baseTransform=(0,H.getCurrentTransform)(E.ctx),E.executeOperatorList(n),E.endDrawing(),{canvas:bt.canvas,scaleX:ut.scale,scaleY:wt.scale,offsetX:O,offsetY:Z}}getSizeAndScale(i,n,r){i=Math.abs(i);const c=Math.max(re.MAX_PATTERN_SIZE,n);let l=Math.ceil(i*r);return l>=c?l=c:r=l/i,{scale:r,size:l}}clipBbox(i,n,r,c,l){const p=c-n,f=l-r;i.ctx.rect(n,r,p,f),i.current.updateRectMinMax((0,H.getCurrentTransform)(i.ctx),[n,r,c,l]),i.clip(),i.endPath()}setFillAndStrokeStyleToContext(i,n,r){const c=i.ctx,l=i.current;switch(n){case P.COLORED:const p=this.ctx;c.fillStyle=p.fillStyle,c.strokeStyle=p.strokeStyle,l.fillColor=p.fillStyle,l.strokeColor=p.strokeStyle;break;case P.UNCOLORED:const f=s.Util.makeHexColor(r[0],r[1],r[2]);c.fillStyle=f,c.strokeStyle=f,l.fillColor=f,l.strokeColor=f;break;default:throw new s.FormatError(`Unsupported paint type: ${n}`)}}getPattern(i,n,r,c){let l=r;c!==w.SHADING&&(l=s.Util.transform(l,n.baseTransform),this.matrix&&(l=s.Util.transform(l,this.matrix)));const p=this.createPatternCanvas(n);let f=new DOMMatrix(l);f=f.translate(p.offsetX,p.offsetY),f=f.scale(1/p.scaleX,1/p.scaleY);const d=i.createPattern(p.canvas,"repeat");return d.setTransform(f),d}};be(re,"MAX_PATTERN_SIZE",3e3);let R=re;function z({src:K,srcPos:i=0,dest:n,width:r,height:c,nonBlackColor:l=4294967295,inverseDecode:p=!1}){const f=s.FeatureTest.isLittleEndian?4278190080:255,[d,A]=p?[l,f]:[f,l],u=r>>3,a=r&7,h=K.length;n=new Uint32Array(n.buffer);let F=0;for(let L=0;L<c;L++){for(const dt=i+u;i<dt;i++){const ut=i<h?K[i]:255;n[F++]=ut&128?A:d,n[F++]=ut&64?A:d,n[F++]=ut&32?A:d,n[F++]=ut&16?A:d,n[F++]=ut&8?A:d,n[F++]=ut&4?A:d,n[F++]=ut&2?A:d,n[F++]=ut&1?A:d}if(a===0)continue;const it=i<h?K[i++]:255;for(let dt=0;dt<a;dt++)n[F++]=it&1<<7-dt?A:d}return{srcPos:i,destPos:F}}const ct=16,tt=100,N=4096,B=15,D=10,_=1e3,U=16;function G(K,i){if(K._removeMirroring)throw new Error("Context is already forwarding operations.");K.__originalSave=K.save,K.__originalRestore=K.restore,K.__originalRotate=K.rotate,K.__originalScale=K.scale,K.__originalTranslate=K.translate,K.__originalTransform=K.transform,K.__originalSetTransform=K.setTransform,K.__originalResetTransform=K.resetTransform,K.__originalClip=K.clip,K.__originalMoveTo=K.moveTo,K.__originalLineTo=K.lineTo,K.__originalBezierCurveTo=K.bezierCurveTo,K.__originalRect=K.rect,K.__originalClosePath=K.closePath,K.__originalBeginPath=K.beginPath,K._removeMirroring=()=>{K.save=K.__originalSave,K.restore=K.__originalRestore,K.rotate=K.__originalRotate,K.scale=K.__originalScale,K.translate=K.__originalTranslate,K.transform=K.__originalTransform,K.setTransform=K.__originalSetTransform,K.resetTransform=K.__originalResetTransform,K.clip=K.__originalClip,K.moveTo=K.__originalMoveTo,K.lineTo=K.__originalLineTo,K.bezierCurveTo=K.__originalBezierCurveTo,K.rect=K.__originalRect,K.closePath=K.__originalClosePath,K.beginPath=K.__originalBeginPath,delete K._removeMirroring},K.save=function(){i.save(),this.__originalSave()},K.restore=function(){i.restore(),this.__originalRestore()},K.translate=function(r,c){i.translate(r,c),this.__originalTranslate(r,c)},K.scale=function(r,c){i.scale(r,c),this.__originalScale(r,c)},K.transform=function(r,c,l,p,f,d){i.transform(r,c,l,p,f,d),this.__originalTransform(r,c,l,p,f,d)},K.setTransform=function(r,c,l,p,f,d){i.setTransform(r,c,l,p,f,d),this.__originalSetTransform(r,c,l,p,f,d)},K.resetTransform=function(){i.resetTransform(),this.__originalResetTransform()},K.rotate=function(r){i.rotate(r),this.__originalRotate(r)},K.clip=function(r){i.clip(r),this.__originalClip(r)},K.moveTo=function(n,r){i.moveTo(n,r),this.__originalMoveTo(n,r)},K.lineTo=function(n,r){i.lineTo(n,r),this.__originalLineTo(n,r)},K.bezierCurveTo=function(n,r,c,l,p,f){i.bezierCurveTo(n,r,c,l,p,f),this.__originalBezierCurveTo(n,r,c,l,p,f)},K.rect=function(n,r,c,l){i.rect(n,r,c,l),this.__originalRect(n,r,c,l)},K.closePath=function(){i.closePath(),this.__originalClosePath()},K.beginPath=function(){i.beginPath(),this.__originalBeginPath()}}class pt{constructor(i){this.canvasFactory=i,this.cache=Object.create(null)}getCanvas(i,n,r){let c;return this.cache[i]!==void 0?(c=this.cache[i],this.canvasFactory.reset(c,n,r)):(c=this.canvasFactory.create(n,r),this.cache[i]=c),c}delete(i){delete this.cache[i]}clear(){for(const i in this.cache){const n=this.cache[i];this.canvasFactory.destroy(n),delete this.cache[i]}}}function Mt(K,i,n,r,c,l,p,f,d,A){const[u,a,h,F,L,it]=(0,H.getCurrentTransform)(K);if(a===0&&h===0){const wt=p*u+L,bt=Math.round(wt),At=f*F+it,E=Math.round(At),O=(p+d)*u+L,Z=Math.abs(Math.round(O)-bt)||1,q=(f+A)*F+it,St=Math.abs(Math.round(q)-E)||1;return K.setTransform(Math.sign(u),0,0,Math.sign(F),bt,E),K.drawImage(i,n,r,c,l,0,0,Z,St),K.setTransform(u,a,h,F,L,it),[Z,St]}if(u===0&&F===0){const wt=f*h+L,bt=Math.round(wt),At=p*a+it,E=Math.round(At),O=(f+A)*h+L,Z=Math.abs(Math.round(O)-bt)||1,q=(p+d)*a+it,St=Math.abs(Math.round(q)-E)||1;return K.setTransform(0,Math.sign(a),Math.sign(h),0,bt,E),K.drawImage(i,n,r,c,l,0,0,St,Z),K.setTransform(u,a,h,F,L,it),[St,Z]}K.drawImage(i,n,r,c,l,p,f,d,A);const dt=Math.hypot(u,a),ut=Math.hypot(h,F);return[dt*d,ut*A]}function Tt(K){const{width:i,height:n}=K;if(i>_||n>_)return null;const r=1e3,c=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),l=i+1;let p=new Uint8Array(l*(n+1)),f,d,A;const u=i+7&-8;let a=new Uint8Array(u*n),h=0;for(const ut of K.data){let wt=128;for(;wt>0;)a[h++]=ut&wt?0:255,wt>>=1}let F=0;for(h=0,a[h]!==0&&(p[0]=1,++F),d=1;d<i;d++)a[h]!==a[h+1]&&(p[d]=a[h]?2:1,++F),h++;for(a[h]!==0&&(p[d]=2,++F),f=1;f<n;f++){h=f*u,A=f*l,a[h-u]!==a[h]&&(p[A]=a[h]?1:8,++F);let ut=(a[h]?4:0)+(a[h-u]?8:0);for(d=1;d<i;d++)ut=(ut>>2)+(a[h+1]?4:0)+(a[h-u+1]?8:0),c[ut]&&(p[A+d]=c[ut],++F),h++;if(a[h-u]!==a[h]&&(p[A+d]=a[h]?2:4,++F),F>r)return null}for(h=u*(n-1),A=f*l,a[h]!==0&&(p[A]=8,++F),d=1;d<i;d++)a[h]!==a[h+1]&&(p[A+d]=a[h]?4:8,++F),h++;if(a[h]!==0&&(p[A+d]=4,++F),F>r)return null;const L=new Int32Array([0,l,-1,0,-l,0,0,0,1]),it=new Path2D;for(f=0;F&&f<=n;f++){let ut=f*l;const wt=ut+i;for(;ut<wt&&!p[ut];)ut++;if(ut===wt)continue;it.moveTo(ut%l,f);const bt=ut;let At=p[ut];do{const E=L[At];do ut+=E;while(!p[ut]);const O=p[ut];O!==5&&O!==10?(At=O,p[ut]=0):(At=O&51*At>>4,p[ut]&=At>>2|At<<2),it.lineTo(ut%l,ut/l|0),p[ut]||--F}while(bt!==ut);--f}return a=null,p=null,function(ut){ut.save(),ut.scale(1/i,-1/n),ut.translate(0,-n),ut.fill(it),ut.beginPath(),ut.restore()}}class Ft{constructor(i,n){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=s.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=s.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=s.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,i,n])}clone(){const i=Object.create(this);return i.clipBox=this.clipBox.slice(),i}setCurrentPoint(i,n){this.x=i,this.y=n}updatePathMinMax(i,n,r){[n,r]=s.Util.applyTransform([n,r],i),this.minX=Math.min(this.minX,n),this.minY=Math.min(this.minY,r),this.maxX=Math.max(this.maxX,n),this.maxY=Math.max(this.maxY,r)}updateRectMinMax(i,n){const r=s.Util.applyTransform(n,i),c=s.Util.applyTransform(n.slice(2),i),l=s.Util.applyTransform([n[0],n[3]],i),p=s.Util.applyTransform([n[2],n[1]],i);this.minX=Math.min(this.minX,r[0],c[0],l[0],p[0]),this.minY=Math.min(this.minY,r[1],c[1],l[1],p[1]),this.maxX=Math.max(this.maxX,r[0],c[0],l[0],p[0]),this.maxY=Math.max(this.maxY,r[1],c[1],l[1],p[1])}updateScalingPathMinMax(i,n){s.Util.scaleMinMax(i,n),this.minX=Math.min(this.minX,n[0]),this.minY=Math.min(this.minY,n[1]),this.maxX=Math.max(this.maxX,n[2]),this.maxY=Math.max(this.maxY,n[3])}updateCurvePathMinMax(i,n,r,c,l,p,f,d,A,u){const a=s.Util.bezierBoundingBox(n,r,c,l,p,f,d,A,u);u||this.updateRectMinMax(i,a)}getPathBoundingBox(i=w.FILL,n=null){const r=[this.minX,this.minY,this.maxX,this.maxY];if(i===w.STROKE){n||(0,s.unreachable)("Stroke bounding box must include transform.");const c=s.Util.singularValueDecompose2dScale(n),l=c[0]*this.lineWidth/2,p=c[1]*this.lineWidth/2;r[0]-=l,r[1]-=p,r[2]+=l,r[3]+=p}return r}updateClipFromPath(){const i=s.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(i||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(i){this.clipBox=i,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(i=w.FILL,n=null){return s.Util.intersect(this.clipBox,this.getPathBoundingBox(i,n))}}function Pt(K,i){if(typeof ImageData<"u"&&i instanceof ImageData){K.putImageData(i,0,0);return}const n=i.height,r=i.width,c=n%U,l=(n-c)/U,p=c===0?l:l+1,f=K.createImageData(r,U);let d=0,A;const u=i.data,a=f.data;let h,F,L,it;if(i.kind===s.ImageKind.GRAYSCALE_1BPP){const dt=u.byteLength,ut=new Uint32Array(a.buffer,0,a.byteLength>>2),wt=ut.length,bt=r+7>>3,At=4294967295,E=s.FeatureTest.isLittleEndian?4278190080:255;for(h=0;h<p;h++){for(L=h<l?U:c,A=0,F=0;F<L;F++){const O=dt-d;let Z=0;const q=O>bt?r:O*8-7,St=q&-8;let et=0,S=0;for(;Z<St;Z+=8)S=u[d++],ut[A++]=S&128?At:E,ut[A++]=S&64?At:E,ut[A++]=S&32?At:E,ut[A++]=S&16?At:E,ut[A++]=S&8?At:E,ut[A++]=S&4?At:E,ut[A++]=S&2?At:E,ut[A++]=S&1?At:E;for(;Z<q;Z++)et===0&&(S=u[d++],et=128),ut[A++]=S&et?At:E,et>>=1}for(;A<wt;)ut[A++]=0;K.putImageData(f,0,h*U)}}else if(i.kind===s.ImageKind.RGBA_32BPP){for(F=0,it=r*U*4,h=0;h<l;h++)a.set(u.subarray(d,d+it)),d+=it,K.putImageData(f,0,F),F+=U;h<p&&(it=r*c*4,a.set(u.subarray(d,d+it)),K.putImageData(f,0,F))}else if(i.kind===s.ImageKind.RGB_24BPP)for(L=U,it=r*L,h=0;h<p;h++){for(h>=l&&(L=c,it=r*L),A=0,F=it;F--;)a[A++]=u[d++],a[A++]=u[d++],a[A++]=u[d++],a[A++]=255;K.putImageData(f,0,h*U)}else throw new Error(`bad image kind: ${i.kind}`)}function Vt(K,i){if(i.bitmap){K.drawImage(i.bitmap,0,0);return}const n=i.height,r=i.width,c=n%U,l=(n-c)/U,p=c===0?l:l+1,f=K.createImageData(r,U);let d=0;const A=i.data,u=f.data;for(let a=0;a<p;a++){const h=a<l?U:c;({srcPos:d}=z({src:A,srcPos:d,dest:u,width:r,height:h,nonBlackColor:0})),K.putImageData(f,0,a*U)}}function Wt(K,i){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of n)K[r]!==void 0&&(i[r]=K[r]);K.setLineDash!==void 0&&(i.setLineDash(K.getLineDash()),i.lineDashOffset=K.lineDashOffset)}function qt(K){if(K.strokeStyle=K.fillStyle="#000000",K.fillRule="nonzero",K.globalAlpha=1,K.lineWidth=1,K.lineCap="butt",K.lineJoin="miter",K.miterLimit=10,K.globalCompositeOperation="source-over",K.font="10px sans-serif",K.setLineDash!==void 0&&(K.setLineDash([]),K.lineDashOffset=0),!s.isNodeJS){const{filter:i}=K;i!=="none"&&i!==""&&(K.filter="none")}}function at(K,i,n,r){const c=K.length;for(let l=3;l<c;l+=4){const p=K[l];if(p===0)K[l-3]=i,K[l-2]=n,K[l-1]=r;else if(p<255){const f=255-p;K[l-3]=K[l-3]*p+i*f>>8,K[l-2]=K[l-2]*p+n*f>>8,K[l-1]=K[l-1]*p+r*f>>8}}}function kt(K,i,n){const r=K.length,c=1/255;for(let l=3;l<r;l+=4){const p=n?n[K[l]]:K[l];i[l]=i[l]*p*c|0}}function Xt(K,i,n){const r=K.length;for(let c=3;c<r;c+=4){const l=K[c-3]*77+K[c-2]*152+K[c-1]*28;i[c]=n?i[c]*n[l>>8]>>8:i[c]*l>>16}}function zt(K,i,n,r,c,l,p,f,d,A,u){const a=!!l,h=a?l[0]:0,F=a?l[1]:0,L=a?l[2]:0,it=c==="Luminosity"?Xt:kt,ut=Math.min(r,Math.ceil(1048576/n));for(let wt=0;wt<r;wt+=ut){const bt=Math.min(ut,r-wt),At=K.getImageData(f-A,wt+(d-u),n,bt),E=i.getImageData(f,wt+d,n,bt);a&&at(At.data,h,F,L),it(At.data,E.data,p),i.putImageData(E,f,wt+d)}}function ie(K,i,n,r){const c=r[0],l=r[1],p=r[2]-c,f=r[3]-l;p===0||f===0||(zt(i.context,n,p,f,i.subtype,i.backdrop,i.transferMap,c,l,i.offsetX,i.offsetY),K.save(),K.globalAlpha=1,K.globalCompositeOperation="source-over",K.setTransform(1,0,0,1,0,0),K.drawImage(n.canvas,0,0),K.restore())}function oe(K,i){if(i)return!0;const n=s.Util.singularValueDecompose2dScale(K);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const r=Math.fround((globalThis.devicePixelRatio||1)*H.PixelsPerInch.PDF_TO_CSS_UNITS);return n[0]<=r&&n[1]<=r}const he=["butt","round","square"],xe=["miter","round","bevel"],Me={},ce={},ee=class ee{constructor(i,n,r,c,l,{optionalContentConfig:p,markedContentStack:f=null},d,A){o(this,ae);o(this,Zt);this.ctx=i,this.current=new Ft(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=n,this.objs=r,this.canvasFactory=c,this.filterFactory=l,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=f||[],this.optionalContentConfig=p,this.cachedCanvases=new pt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=A,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(i,n=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):n}beginDrawing({transform:i,viewport:n,transparency:r=!1,background:c=null}){const l=this.ctx.canvas.width,p=this.ctx.canvas.height,f=this.ctx.fillStyle;if(this.ctx.fillStyle=c||"#ffffff",this.ctx.fillRect(0,0,l,p),this.ctx.fillStyle=f,r){const d=this.cachedCanvases.getCanvas("transparent",l,p);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...(0,H.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),qt(this.ctx),i&&(this.ctx.transform(...i),this.outputScaleX=i[0],this.outputScaleY=i[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=(0,H.getCurrentTransform)(this.ctx)}executeOperatorList(i,n,r,c){const l=i.argsArray,p=i.fnArray;let f=n||0;const d=l.length;if(d===f)return f;const A=d-f>D&&typeof r=="function",u=A?Date.now()+B:0;let a=0;const h=this.commonObjs,F=this.objs;let L;for(;;){if(c!==void 0&&f===c.nextBreakPoint)return c.breakIt(f,r),f;if(L=p[f],L!==s.OPS.dependency)this[L].apply(this,l[f]);else for(const it of l[f]){const dt=it.startsWith("g_")?h:F;if(!dt.has(it))return dt.get(it,r),f}if(f++,f===d)return f;if(A&&++a>D){if(Date.now()>u)return r(),f;a=0}}}endDrawing(){y(this,ae,Mn).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const i of this._cachedBitmapsMap.values()){for(const n of i.values())typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&(n.width=n.height=0);i.clear()}this._cachedBitmapsMap.clear(),y(this,Zt,In).call(this)}_scaleImage(i,n){const r=i.width,c=i.height;let l=Math.max(Math.hypot(n[0],n[1]),1),p=Math.max(Math.hypot(n[2],n[3]),1),f=r,d=c,A="prescale1",u,a;for(;l>2&&f>1||p>2&&d>1;){let h=f,F=d;l>2&&f>1&&(h=f>=16384?Math.floor(f/2)-1||1:Math.ceil(f/2),l/=f/h),p>2&&d>1&&(F=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,p/=d/F),u=this.cachedCanvases.getCanvas(A,h,F),a=u.context,a.clearRect(0,0,h,F),a.drawImage(i,0,0,f,d,0,0,h,F),i=u.canvas,f=h,d=F,A=A==="prescale1"?"prescale2":"prescale1"}return{img:i,paintWidth:f,paintHeight:d}}_createMaskCanvas(i){const n=this.ctx,{width:r,height:c}=i,l=this.current.fillColor,p=this.current.patternFill,f=(0,H.getCurrentTransform)(n);let d,A,u,a;if((i.bitmap||i.data)&&i.count>1){const q=i.bitmap||i.data.buffer;A=JSON.stringify(p?f:[f.slice(0,4),l]),d=this._cachedBitmapsMap.get(q),d||(d=new Map,this._cachedBitmapsMap.set(q,d));const St=d.get(A);if(St&&!p){const et=Math.round(Math.min(f[0],f[2])+f[4]),S=Math.round(Math.min(f[1],f[3])+f[5]);return{canvas:St,offsetX:et,offsetY:S}}u=St}u||(a=this.cachedCanvases.getCanvas("maskCanvas",r,c),Vt(a.context,i));let h=s.Util.transform(f,[1/r,0,0,-1/c,0,0]);h=s.Util.transform(h,[1,0,0,1,0,-c]);const[F,L,it,dt]=s.Util.getAxialAlignedBoundingBox([0,0,r,c],h),ut=Math.round(it-F)||1,wt=Math.round(dt-L)||1,bt=this.cachedCanvases.getCanvas("fillCanvas",ut,wt),At=bt.context,E=F,O=L;At.translate(-E,-O),At.transform(...h),u||(u=this._scaleImage(a.canvas,(0,H.getCurrentTransformInverse)(At)),u=u.img,d&&p&&d.set(A,u)),At.imageSmoothingEnabled=oe((0,H.getCurrentTransform)(At),i.interpolate),Mt(At,u,0,0,u.width,u.height,0,0,r,c),At.globalCompositeOperation="source-in";const Z=s.Util.transform((0,H.getCurrentTransformInverse)(At),[1,0,0,1,-E,-O]);return At.fillStyle=p?l.getPattern(n,this,Z,w.FILL):l,At.fillRect(0,0,r,c),d&&!p&&(this.cachedCanvases.delete("fillCanvas"),d.set(A,bt.canvas)),{canvas:bt.canvas,offsetX:Math.round(E),offsetY:Math.round(O)}}setLineWidth(i){i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(i){this.ctx.lineCap=he[i]}setLineJoin(i){this.ctx.lineJoin=xe[i]}setMiterLimit(i){this.ctx.miterLimit=i}setDash(i,n){const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(i),r.lineDashOffset=n)}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[n,r]of i)switch(n){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=r;break;case"ca":this.current.fillAlpha=r,this.ctx.globalAlpha=r;break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const i=this.inSMaskMode;this.current.activeSMask&&!i?this.beginSMaskMode():!this.current.activeSMask&&i&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,n=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,c=this.cachedCanvases.getCanvas(r,i,n);this.suspendedCtx=this.ctx,this.ctx=c.context;const l=this.ctx;l.setTransform(...(0,H.getCurrentTransform)(this.suspendedCtx)),Wt(this.suspendedCtx,l),G(l,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Wt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(i){if(!this.current.activeSMask)return;i?(i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i[2]=Math.ceil(i[2]),i[3]=Math.ceil(i[3])):i=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const n=this.current.activeSMask,r=this.suspendedCtx;ie(r,n,this.ctx,i),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Wt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Wt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(i,n,r,c,l,p){this.ctx.transform(i,n,r,c,l,p),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(i,n,r){const c=this.ctx,l=this.current;let p=l.x,f=l.y,d,A;const u=(0,H.getCurrentTransform)(c),a=u[0]===0&&u[3]===0||u[1]===0&&u[2]===0,h=a?r.slice(0):null;for(let F=0,L=0,it=i.length;F<it;F++)switch(i[F]|0){case s.OPS.rectangle:p=n[L++],f=n[L++];const dt=n[L++],ut=n[L++],wt=p+dt,bt=f+ut;c.moveTo(p,f),dt===0||ut===0?c.lineTo(wt,bt):(c.lineTo(wt,f),c.lineTo(wt,bt),c.lineTo(p,bt)),a||l.updateRectMinMax(u,[p,f,wt,bt]),c.closePath();break;case s.OPS.moveTo:p=n[L++],f=n[L++],c.moveTo(p,f),a||l.updatePathMinMax(u,p,f);break;case s.OPS.lineTo:p=n[L++],f=n[L++],c.lineTo(p,f),a||l.updatePathMinMax(u,p,f);break;case s.OPS.curveTo:d=p,A=f,p=n[L+4],f=n[L+5],c.bezierCurveTo(n[L],n[L+1],n[L+2],n[L+3],p,f),l.updateCurvePathMinMax(u,d,A,n[L],n[L+1],n[L+2],n[L+3],p,f,h),L+=6;break;case s.OPS.curveTo2:d=p,A=f,c.bezierCurveTo(p,f,n[L],n[L+1],n[L+2],n[L+3]),l.updateCurvePathMinMax(u,d,A,p,f,n[L],n[L+1],n[L+2],n[L+3],h),p=n[L+2],f=n[L+3],L+=4;break;case s.OPS.curveTo3:d=p,A=f,p=n[L+2],f=n[L+3],c.bezierCurveTo(n[L],n[L+1],p,f,p,f),l.updateCurvePathMinMax(u,d,A,n[L],n[L+1],p,f,p,f,h),L+=4;break;case s.OPS.closePath:c.closePath();break}a&&l.updateScalingPathMinMax(u,h),l.setCurrentPoint(p,f)}closePath(){this.ctx.closePath()}stroke(i=!0){const n=this.ctx,r=this.current.strokeColor;n.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof r=="object"&&(r!=null&&r.getPattern)?(n.save(),n.strokeStyle=r.getPattern(n,this,(0,H.getCurrentTransformInverse)(n),w.STROKE),this.rescaleAndStroke(!1),n.restore()):this.rescaleAndStroke(!0)),i&&this.consumePath(this.current.getClippedPathBoundingBox()),n.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(i=!0){const n=this.ctx,r=this.current.fillColor,c=this.current.patternFill;let l=!1;c&&(n.save(),n.fillStyle=r.getPattern(n,this,(0,H.getCurrentTransformInverse)(n),w.FILL),l=!0);const p=this.current.getClippedPathBoundingBox();this.contentVisible&&p!==null&&(this.pendingEOFill?(n.fill("evenodd"),this.pendingEOFill=!1):n.fill()),l&&n.restore(),i&&this.consumePath(p)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Me}eoClip(){this.pendingClip=ce}beginText(){this.current.textMatrix=s.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const i=this.pendingTextPaths,n=this.ctx;if(i===void 0){n.beginPath();return}n.save(),n.beginPath();for(const r of i)n.setTransform(...r.transform),n.translate(r.x,r.y),r.addToPath(n,r.fontSize);n.restore(),n.clip(),n.beginPath(),delete this.pendingTextPaths}setCharSpacing(i){this.current.charSpacing=i}setWordSpacing(i){this.current.wordSpacing=i}setHScale(i){this.current.textHScale=i/100}setLeading(i){this.current.leading=-i}setFont(i,n){var u;const r=this.commonObjs.get(i),c=this.current;if(!r)throw new Error(`Can't find font for ${i}`);if(c.fontMatrix=r.fontMatrix||s.FONT_IDENTITY_MATRIX,(c.fontMatrix[0]===0||c.fontMatrix[3]===0)&&(0,s.warn)("Invalid font matrix for font "+i),n<0?(n=-n,c.fontDirection=-1):c.fontDirection=1,this.current.font=r,this.current.fontSize=n,r.isType3Font)return;const l=r.loadedName||"sans-serif",p=((u=r.systemFontInfo)==null?void 0:u.css)||`"${l}", ${r.fallbackName}`;let f="normal";r.black?f="900":r.bold&&(f="bold");const d=r.italic?"italic":"normal";let A=n;n<ct?A=ct:n>tt&&(A=tt),this.current.fontSizeScale=n/A,this.ctx.font=`${d} ${f} ${A}px ${p}`}setTextRenderingMode(i){this.current.textRenderingMode=i}setTextRise(i){this.current.textRise=i}moveText(i,n){this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=n}setLeadingMoveText(i,n){this.setLeading(-n),this.moveText(i,n)}setTextMatrix(i,n,r,c,l,p){this.current.textMatrix=[i,n,r,c,l,p],this.current.textMatrixScale=Math.hypot(i,n),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(i,n,r,c){const l=this.ctx,p=this.current,f=p.font,d=p.textRenderingMode,A=p.fontSize/p.fontSizeScale,u=d&s.TextRenderingMode.FILL_STROKE_MASK,a=!!(d&s.TextRenderingMode.ADD_TO_PATH_FLAG),h=p.patternFill&&!f.missingFile;let F;(f.disableFontFace||a||h)&&(F=f.getPathGenerator(this.commonObjs,i)),f.disableFontFace||h?(l.save(),l.translate(n,r),l.beginPath(),F(l,A),c&&l.setTransform(...c),(u===s.TextRenderingMode.FILL||u===s.TextRenderingMode.FILL_STROKE)&&l.fill(),(u===s.TextRenderingMode.STROKE||u===s.TextRenderingMode.FILL_STROKE)&&l.stroke(),l.restore()):((u===s.TextRenderingMode.FILL||u===s.TextRenderingMode.FILL_STROKE)&&l.fillText(i,n,r),(u===s.TextRenderingMode.STROKE||u===s.TextRenderingMode.FILL_STROKE)&&l.strokeText(i,n,r)),a&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,H.getCurrentTransform)(l),x:n,y:r,fontSize:A,addToPath:F})}get isFontSubpixelAAEnabled(){const{context:i}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);i.scale(1.5,1),i.fillText("I",0,10);const n=i.getImageData(0,0,10,10).data;let r=!1;for(let c=3;c<n.length;c+=4)if(n[c]>0&&n[c]<255){r=!0;break}return(0,s.shadow)(this,"isFontSubpixelAAEnabled",r)}showText(i){const n=this.current,r=n.font;if(r.isType3Font)return this.showType3Text(i);const c=n.fontSize;if(c===0)return;const l=this.ctx,p=n.fontSizeScale,f=n.charSpacing,d=n.wordSpacing,A=n.fontDirection,u=n.textHScale*A,a=i.length,h=r.vertical,F=h?1:-1,L=r.defaultVMetrics,it=c*n.fontMatrix[0],dt=n.textRenderingMode===s.TextRenderingMode.FILL&&!r.disableFontFace&&!n.patternFill;l.save(),l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),A>0?l.scale(u,-1):l.scale(u,1);let ut;if(n.patternFill){l.save();const O=n.fillColor.getPattern(l,this,(0,H.getCurrentTransformInverse)(l),w.FILL);ut=(0,H.getCurrentTransform)(l),l.restore(),l.fillStyle=O}let wt=n.lineWidth;const bt=n.textMatrixScale;if(bt===0||wt===0){const O=n.textRenderingMode&s.TextRenderingMode.FILL_STROKE_MASK;(O===s.TextRenderingMode.STROKE||O===s.TextRenderingMode.FILL_STROKE)&&(wt=this.getSinglePixelWidth())}else wt/=bt;if(p!==1&&(l.scale(p,p),wt/=p),l.lineWidth=wt,r.isInvalidPDFjsFont){const O=[];let Z=0;for(const q of i)O.push(q.unicode),Z+=q.width;l.fillText(O.join(""),0,0),n.x+=Z*it*u,l.restore(),this.compose();return}let At=0,E;for(E=0;E<a;++E){const O=i[E];if(typeof O=="number"){At+=F*O*c/1e3;continue}let Z=!1;const q=(O.isSpace?d:0)+f,St=O.fontChar,et=O.accent;let S,$,j=O.width;if(h){const xt=O.vmetric||L,Lt=-(O.vmetric?xt[1]:j*.5)*it,jt=xt[2]*it;j=xt?-xt[0]:j,S=Lt/p,$=(At+jt)/p}else S=At/p,$=0;if(r.remeasure&&j>0){const xt=l.measureText(St).width*1e3/c*p;if(j<xt&&this.isFontSubpixelAAEnabled){const Lt=j/xt;Z=!0,l.save(),l.scale(Lt,1),S/=Lt}else j!==xt&&(S+=(j-xt)/2e3*c/p)}if(this.contentVisible&&(O.isInFont||r.missingFile)){if(dt&&!et)l.fillText(St,S,$);else if(this.paintChar(St,S,$,ut),et){const xt=S+c*et.offset.x/p,Lt=$-c*et.offset.y/p;this.paintChar(et.fontChar,xt,Lt,ut)}}const ht=h?j*it-q*A:j*it+q*A;At+=ht,Z&&l.restore()}h?n.y-=At:n.x+=At*u,l.restore(),this.compose()}showType3Text(i){const n=this.ctx,r=this.current,c=r.font,l=r.fontSize,p=r.fontDirection,f=c.vertical?1:-1,d=r.charSpacing,A=r.wordSpacing,u=r.textHScale*p,a=r.fontMatrix||s.FONT_IDENTITY_MATRIX,h=i.length,F=r.textRenderingMode===s.TextRenderingMode.INVISIBLE;let L,it,dt,ut;if(!(F||l===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),n.transform(...r.textMatrix),n.translate(r.x,r.y),n.scale(u,p),L=0;L<h;++L){if(it=i[L],typeof it=="number"){ut=f*it*l/1e3,this.ctx.translate(ut,0),r.x+=ut*u;continue}const wt=(it.isSpace?A:0)+d,bt=c.charProcOperatorList[it.operatorListId];if(!bt){(0,s.warn)(`Type3 character "${it.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=it,this.save(),n.scale(l,l),n.transform(...a),this.executeOperatorList(bt),this.restore()),dt=s.Util.applyTransform([it.width,0],a)[0]*l+wt,n.translate(dt,0),r.x+=dt*u}n.restore(),this.processingType3=null}}setCharWidth(i,n){}setCharWidthAndBounds(i,n,r,c,l,p){this.ctx.rect(r,c,l-r,p-c),this.ctx.clip(),this.endPath()}getColorN_Pattern(i){let n;if(i[0]==="TilingPattern"){const r=i[1],c=this.baseTransform||(0,H.getCurrentTransform)(this.ctx),l={createCanvasGraphics:p=>new ee(p,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};n=new R(i,r,this.ctx,l,c)}else n=this._getPattern(i[1],i[2]);return n}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(i,n,r){const c=s.Util.makeHexColor(i,n,r);this.ctx.strokeStyle=c,this.current.strokeColor=c}setFillRGBColor(i,n,r){const c=s.Util.makeHexColor(i,n,r);this.ctx.fillStyle=c,this.current.fillColor=c,this.current.patternFill=!1}_getPattern(i,n=null){let r;return this.cachedPatterns.has(i)?r=this.cachedPatterns.get(i):(r=g(this.getObject(i)),this.cachedPatterns.set(i,r)),n&&(r.matrix=n),r}shadingFill(i){if(!this.contentVisible)return;const n=this.ctx;this.save();const r=this._getPattern(i);n.fillStyle=r.getPattern(n,this,(0,H.getCurrentTransformInverse)(n),w.SHADING);const c=(0,H.getCurrentTransformInverse)(n);if(c){const{width:l,height:p}=n.canvas,[f,d,A,u]=s.Util.getAxialAlignedBoundingBox([0,0,l,p],c);this.ctx.fillRect(f,d,A-f,u-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,s.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,s.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(i,n){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(i)&&i.length===6&&this.transform(...i),this.baseTransform=(0,H.getCurrentTransform)(this.ctx),n)){const r=n[2]-n[0],c=n[3]-n[1];this.ctx.rect(n[0],n[1],r,c),this.current.updateRectMinMax((0,H.getCurrentTransform)(this.ctx),n),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(i){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;i.isolated||(0,s.info)("TODO: Support non-isolated groups."),i.knockout&&(0,s.warn)("Knockout groups not supported.");const r=(0,H.getCurrentTransform)(n);if(i.matrix&&n.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let c=s.Util.getAxialAlignedBoundingBox(i.bbox,(0,H.getCurrentTransform)(n));const l=[0,0,n.canvas.width,n.canvas.height];c=s.Util.intersect(c,l)||[0,0,0,0];const p=Math.floor(c[0]),f=Math.floor(c[1]);let d=Math.max(Math.ceil(c[2])-p,1),A=Math.max(Math.ceil(c[3])-f,1),u=1,a=1;d>N&&(u=d/N,d=N),A>N&&(a=A/N,A=N),this.current.startNewPathAndClipBox([0,0,d,A]);let h="groupAt"+this.groupLevel;i.smask&&(h+="_smask_"+this.smaskCounter++%2);const F=this.cachedCanvases.getCanvas(h,d,A),L=F.context;L.scale(1/u,1/a),L.translate(-p,-f),L.transform(...r),i.smask?this.smaskStack.push({canvas:F.canvas,context:L,offsetX:p,offsetY:f,scaleX:u,scaleY:a,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}):(n.setTransform(1,0,0,1,0,0),n.translate(p,f),n.scale(u,a),n.save()),Wt(n,L),this.ctx=L,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(i){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,i.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const c=(0,H.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...c);const l=s.Util.getAxialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],c);this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(i,n,r,c,l){if(y(this,ae,Mn).call(this),qt(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(n)&&n.length===4){const p=n[2]-n[0],f=n[3]-n[1];if(l&&this.annotationCanvasMap){r=r.slice(),r[4]-=n[0],r[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=p,n[3]=f;const[d,A]=s.Util.singularValueDecompose2dScale((0,H.getCurrentTransform)(this.ctx)),{viewportScale:u}=this,a=Math.ceil(p*this.outputScaleX*u),h=Math.ceil(f*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(a,h);const{canvas:F,context:L}=this.annotationCanvas;this.annotationCanvasMap.set(i,F),this.annotationCanvas.savedCtx=this.ctx,this.ctx=L,this.ctx.save(),this.ctx.setTransform(d,0,0,-A,0,f*A),qt(this.ctx)}else qt(this.ctx),this.ctx.rect(n[0],n[1],p,f),this.ctx.clip(),this.endPath()}this.current=new Ft(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...r),this.transform(...c)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),y(this,Zt,In).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(i){if(!this.contentVisible)return;const n=i.count;i=this.getObject(i.data,i),i.count=n;const r=this.ctx,c=this.processingType3;if(c&&(c.compiled===void 0&&(c.compiled=Tt(i)),c.compiled)){c.compiled(r);return}const l=this._createMaskCanvas(i),p=l.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(p,l.offsetX,l.offsetY),r.restore(),this.compose()}paintImageMaskXObjectRepeat(i,n,r=0,c=0,l,p){if(!this.contentVisible)return;i=this.getObject(i.data,i);const f=this.ctx;f.save();const d=(0,H.getCurrentTransform)(f);f.transform(n,r,c,l,0,0);const A=this._createMaskCanvas(i);f.setTransform(1,0,0,1,A.offsetX-d[4],A.offsetY-d[5]);for(let u=0,a=p.length;u<a;u+=2){const h=s.Util.transform(d,[n,r,c,l,p[u],p[u+1]]),[F,L]=s.Util.applyTransform([0,0],h);f.drawImage(A.canvas,F,L)}f.restore(),this.compose()}paintImageMaskXObjectGroup(i){if(!this.contentVisible)return;const n=this.ctx,r=this.current.fillColor,c=this.current.patternFill;for(const l of i){const{data:p,width:f,height:d,transform:A}=l,u=this.cachedCanvases.getCanvas("maskCanvas",f,d),a=u.context;a.save();const h=this.getObject(p,l);Vt(a,h),a.globalCompositeOperation="source-in",a.fillStyle=c?r.getPattern(a,this,(0,H.getCurrentTransformInverse)(n),w.FILL):r,a.fillRect(0,0,f,d),a.restore(),n.save(),n.transform(...A),n.scale(1,-1),Mt(n,u.canvas,0,0,f,d,0,-1,1,1),n.restore()}this.compose()}paintImageXObject(i){if(!this.contentVisible)return;const n=this.getObject(i);if(!n){(0,s.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(n)}paintImageXObjectRepeat(i,n,r,c){if(!this.contentVisible)return;const l=this.getObject(i);if(!l){(0,s.warn)("Dependent image isn't ready yet");return}const p=l.width,f=l.height,d=[];for(let A=0,u=c.length;A<u;A+=2)d.push({transform:[n,0,0,r,c[A],c[A+1]],x:0,y:0,w:p,h:f});this.paintInlineImageXObjectGroup(l,d)}applyTransferMapsToCanvas(i){return this.current.transferMaps!=="none"&&(i.filter=this.current.transferMaps,i.drawImage(i.canvas,0,0),i.filter="none"),i.canvas}applyTransferMapsToBitmap(i){if(this.current.transferMaps==="none")return i.bitmap;const{bitmap:n,width:r,height:c}=i,l=this.cachedCanvases.getCanvas("inlineImage",r,c),p=l.context;return p.filter=this.current.transferMaps,p.drawImage(n,0,0),p.filter="none",l.canvas}paintInlineImageXObject(i){if(!this.contentVisible)return;const n=i.width,r=i.height,c=this.ctx;if(this.save(),!s.isNodeJS){const{filter:f}=c;f!=="none"&&f!==""&&(c.filter="none")}c.scale(1/n,-1/r);let l;if(i.bitmap)l=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)l=i;else{const d=this.cachedCanvases.getCanvas("inlineImage",n,r).context;Pt(d,i),l=this.applyTransferMapsToCanvas(d)}const p=this._scaleImage(l,(0,H.getCurrentTransformInverse)(c));c.imageSmoothingEnabled=oe((0,H.getCurrentTransform)(c),i.interpolate),Mt(c,p.img,0,0,p.paintWidth,p.paintHeight,0,-r,n,r),this.compose(),this.restore()}paintInlineImageXObjectGroup(i,n){if(!this.contentVisible)return;const r=this.ctx;let c;if(i.bitmap)c=i.bitmap;else{const l=i.width,p=i.height,d=this.cachedCanvases.getCanvas("inlineImage",l,p).context;Pt(d,i),c=this.applyTransferMapsToCanvas(d)}for(const l of n)r.save(),r.transform(...l.transform),r.scale(1,-1),Mt(r,c,l.x,l.y,l.w,l.h,0,-1,1,1),r.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(i){}markPointProps(i,n){}beginMarkedContent(i){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(i,n){i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(i){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const r=this.ctx;this.pendingClip&&(n||(this.pendingClip===ce?r.clip("evenodd"):r.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),r.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const i=(0,H.getCurrentTransform)(this.ctx);if(i[1]===0&&i[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(i[0]),Math.abs(i[3]));else{const n=Math.abs(i[0]*i[3]-i[2]*i[1]),r=Math.hypot(i[0],i[2]),c=Math.hypot(i[1],i[3]);this._cachedGetSinglePixelWidth=Math.max(r,c)/n}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:i}=this.current,{a:n,b:r,c,d:l}=this.ctx.getTransform();let p,f;if(r===0&&c===0){const d=Math.abs(n),A=Math.abs(l);if(d===A)if(i===0)p=f=1/d;else{const u=d*i;p=f=u<1?1/u:1}else if(i===0)p=1/d,f=1/A;else{const u=d*i,a=A*i;p=u<1?1/u:1,f=a<1?1/a:1}}else{const d=Math.abs(n*l-r*c),A=Math.hypot(n,r),u=Math.hypot(c,l);if(i===0)p=u/d,f=A/d;else{const a=i*d;p=u>a?u/a:1,f=A>a?A/a:1}}this._cachedScaleForStroking[0]=p,this._cachedScaleForStroking[1]=f}return this._cachedScaleForStroking}rescaleAndStroke(i){const{ctx:n}=this,{lineWidth:r}=this.current,[c,l]=this.getScaleForStroking();if(n.lineWidth=r||1,c===1&&l===1){n.stroke();return}const p=n.getLineDash();if(i&&n.save(),n.scale(c,l),p.length>0){const f=Math.max(c,l);n.setLineDash(p.map(d=>d/f)),n.lineDashOffset/=f}n.stroke(),i&&n.restore()}isContentVisible(){for(let i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}};ae=new WeakSet,Mn=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Zt=new WeakSet,In=function(){if(this.pageColors){const i=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(i!=="none"){const n=this.ctx.filter;this.ctx.filter=i,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=n}}};let pe=ee;for(const K in s.OPS)pe.prototype[K]!==void 0&&(pe.prototype[s.OPS[K]]=pe.prototype[K])},419:(st,ot,k)=>{var Wt,qt,at,kt,Xt,zt,ie,ti,he,ei,Me,si,pe,Nn,ae,Ki,Zt,Ji,ee,wi,i,Si;k.d(ot,{DOMCMapReaderFactory:()=>M,DOMCanvasFactory:()=>V,DOMFilterFactory:()=>rt,DOMSVGFactory:()=>x,DOMStandardFontDataFactory:()=>W,PDFDateString:()=>U,PageViewport:()=>g,PixelsPerInch:()=>X,RenderingCancelledException:()=>P,StatTimer:()=>N,fetchData:()=>I,getColorValues:()=>Mt,getCurrentTransform:()=>Tt,getCurrentTransformInverse:()=>Ft,getFilenameFromUrl:()=>ct,getPdfFilenameFromUrl:()=>tt,getRGB:()=>pt,getXfaPageViewport:()=>G,isDataScheme:()=>R,isPdfFile:()=>z,isValidFetchUrl:()=>B,noContextMenu:()=>D,setLayerDimensions:()=>Pt});var s=k(583),H=k(292);const w="http://www.w3.org/2000/svg",Vt=class Vt{};be(Vt,"CSS",96),be(Vt,"PDF",72),be(Vt,"PDF_TO_CSS_UNITS",Vt.CSS/Vt.PDF);let X=Vt;class rt extends s.BaseFilterFactory{constructor({docId:l,ownerDocument:p=globalThis.document}={}){super();o(this,ie);o(this,he);o(this,Me);o(this,pe);o(this,ae);o(this,Zt);o(this,ee);o(this,i);o(this,Wt,void 0);o(this,qt,void 0);o(this,at,void 0);o(this,kt,void 0);o(this,Xt,void 0);o(this,zt,0);T(this,at,l),T(this,kt,p)}addFilter(l){if(!l)return"none";let p=t(this,ie,ti).get(l);if(p)return p;let f,d,A,u;if(l.length===1){const L=l[0],it=new Array(256);for(let dt=0;dt<256;dt++)it[dt]=L[dt]/255;u=f=d=A=it.join(",")}else{const[L,it,dt]=l,ut=new Array(256),wt=new Array(256),bt=new Array(256);for(let At=0;At<256;At++)ut[At]=L[At]/255,wt[At]=it[At]/255,bt[At]=dt[At]/255;f=ut.join(","),d=wt.join(","),A=bt.join(","),u=`${f}${d}${A}`}if(p=t(this,ie,ti).get(u),p)return t(this,ie,ti).set(l,p),p;const a=`g_${t(this,at)}_transfer_map_${gs(this,zt)._++}`,h=`url(#${a})`;t(this,ie,ti).set(l,h),t(this,ie,ti).set(u,h);const F=y(this,ae,Ki).call(this,a);return y(this,ee,wi).call(this,f,d,A,F),h}addHCMFilter(l,p){var ut;const f=`${l}-${p}`,d="base";let A=t(this,he,ei).get(d);if((A==null?void 0:A.key)===f||(A?((ut=A.filter)==null||ut.remove(),A.key=f,A.url="none",A.filter=null):(A={key:f,url:"none",filter:null},t(this,he,ei).set(d,A)),!l||!p))return A.url;const u=y(this,i,Si).call(this,l);l=H.Util.makeHexColor(...u);const a=y(this,i,Si).call(this,p);if(p=H.Util.makeHexColor(...a),t(this,Me,si).style.color="",l==="#000000"&&p==="#ffffff"||l===p)return A.url;const h=new Array(256);for(let wt=0;wt<=255;wt++){const bt=wt/255;h[wt]=bt<=.03928?bt/12.92:((bt+.055)/1.055)**2.4}const F=h.join(","),L=`g_${t(this,at)}_hcm_filter`,it=A.filter=y(this,ae,Ki).call(this,L);y(this,ee,wi).call(this,F,F,F,it),y(this,pe,Nn).call(this,it);const dt=(wt,bt)=>{const At=u[wt]/255,E=a[wt]/255,O=new Array(bt+1);for(let Z=0;Z<=bt;Z++)O[Z]=At+Z/bt*(E-At);return O.join(",")};return y(this,ee,wi).call(this,dt(0,5),dt(1,5),dt(2,5),it),A.url=`url(#${L})`,A.url}addHighlightHCMFilter(l,p,f,d,A){var E;const u=`${p}-${f}-${d}-${A}`;let a=t(this,he,ei).get(l);if((a==null?void 0:a.key)===u||(a?((E=a.filter)==null||E.remove(),a.key=u,a.url="none",a.filter=null):(a={key:u,url:"none",filter:null},t(this,he,ei).set(l,a)),!p||!f))return a.url;const[h,F]=[p,f].map(y(this,i,Si).bind(this));let L=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),it=Math.round(.2126*F[0]+.7152*F[1]+.0722*F[2]),[dt,ut]=[d,A].map(y(this,i,Si).bind(this));it<L&&([L,it,dt,ut]=[it,L,ut,dt]),t(this,Me,si).style.color="";const wt=(O,Z,q)=>{const St=new Array(256),et=(it-L)/q,S=O/255,$=(Z-O)/(255*q);let j=0;for(let ht=0;ht<=q;ht++){const xt=Math.round(L+ht*et),Lt=S+ht*$;for(let jt=j;jt<=xt;jt++)St[jt]=Lt;j=xt+1}for(let ht=j;ht<256;ht++)St[ht]=St[j-1];return St.join(",")},bt=`g_${t(this,at)}_hcm_${l}_filter`,At=a.filter=y(this,ae,Ki).call(this,bt);return y(this,pe,Nn).call(this,At),y(this,ee,wi).call(this,wt(dt[0],ut[0],5),wt(dt[1],ut[1],5),wt(dt[2],ut[2],5),At),a.url=`url(#${bt})`,a.url}destroy(l=!1){l&&t(this,he,ei).size!==0||(t(this,qt)&&(t(this,qt).parentNode.parentNode.remove(),T(this,qt,null)),t(this,Wt)&&(t(this,Wt).clear(),T(this,Wt,null)),T(this,zt,0))}}Wt=new WeakMap,qt=new WeakMap,at=new WeakMap,kt=new WeakMap,Xt=new WeakMap,zt=new WeakMap,ie=new WeakSet,ti=function(){return t(this,Wt)||T(this,Wt,new Map)},he=new WeakSet,ei=function(){return t(this,Xt)||T(this,Xt,new Map)},Me=new WeakSet,si=function(){if(!t(this,qt)){const l=t(this,kt).createElement("div"),{style:p}=l;p.visibility="hidden",p.contain="strict",p.width=p.height=0,p.position="absolute",p.top=p.left=0,p.zIndex=-1;const f=t(this,kt).createElementNS(w,"svg");f.setAttribute("width",0),f.setAttribute("height",0),T(this,qt,t(this,kt).createElementNS(w,"defs")),l.append(f),f.append(t(this,qt)),t(this,kt).body.append(l)}return t(this,qt)},pe=new WeakSet,Nn=function(l){const p=t(this,kt).createElementNS(w,"feColorMatrix");p.setAttribute("type","matrix"),p.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),l.append(p)},ae=new WeakSet,Ki=function(l){const p=t(this,kt).createElementNS(w,"filter");return p.setAttribute("color-interpolation-filters","sRGB"),p.setAttribute("id",l),t(this,Me,si).append(p),p},Zt=new WeakSet,Ji=function(l,p,f){const d=t(this,kt).createElementNS(w,p);d.setAttribute("type","discrete"),d.setAttribute("tableValues",f),l.append(d)},ee=new WeakSet,wi=function(l,p,f,d){const A=t(this,kt).createElementNS(w,"feComponentTransfer");d.append(A),y(this,Zt,Ji).call(this,A,"feFuncR",l),y(this,Zt,Ji).call(this,A,"feFuncG",p),y(this,Zt,Ji).call(this,A,"feFuncB",f)},i=new WeakSet,Si=function(l){return t(this,Me,si).style.color=l,pt(getComputedStyle(t(this,Me,si)).getPropertyValue("color"))};class V extends s.BaseCanvasFactory{constructor({ownerDocument:c=globalThis.document}={}){super(),this._document=c}_createCanvas(c,l){const p=this._document.createElement("canvas");return p.width=c,p.height=l,p}}async function I(r,c="text"){if(B(r,document.baseURI)){const l=await fetch(r);if(!l.ok)throw new Error(l.statusText);switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"json":return l.json()}return l.text()}return new Promise((l,p)=>{const f=new XMLHttpRequest;f.open("GET",r,!0),f.responseType=c,f.onreadystatechange=()=>{if(f.readyState===XMLHttpRequest.DONE){if(f.status===200||f.status===0){switch(c){case"arraybuffer":case"blob":case"json":l(f.response);return}l(f.responseText);return}p(new Error(f.statusText))}},f.send(null)})}class M extends s.BaseCMapReaderFactory{_fetchData(c,l){return I(c,this.isCompressed?"arraybuffer":"text").then(p=>({cMapData:p instanceof ArrayBuffer?new Uint8Array(p):(0,H.stringToBytes)(p),compressionType:l}))}}class W extends s.BaseStandardFontDataFactory{_fetchData(c){return I(c,"arraybuffer").then(l=>new Uint8Array(l))}}class x extends s.BaseSVGFactory{_createSVG(c){return document.createElementNS(w,c)}}class g{constructor({viewBox:c,scale:l,rotation:p,offsetX:f=0,offsetY:d=0,dontFlip:A=!1}){this.viewBox=c,this.scale=l,this.rotation=p,this.offsetX=f,this.offsetY=d;const u=(c[2]+c[0])/2,a=(c[3]+c[1])/2;let h,F,L,it;switch(p%=360,p<0&&(p+=360),p){case 180:h=-1,F=0,L=0,it=1;break;case 90:h=0,F=1,L=1,it=0;break;case 270:h=0,F=-1,L=-1,it=0;break;case 0:h=1,F=0,L=0,it=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}A&&(L=-L,it=-it);let dt,ut,wt,bt;h===0?(dt=Math.abs(a-c[1])*l+f,ut=Math.abs(u-c[0])*l+d,wt=(c[3]-c[1])*l,bt=(c[2]-c[0])*l):(dt=Math.abs(u-c[0])*l+f,ut=Math.abs(a-c[1])*l+d,wt=(c[2]-c[0])*l,bt=(c[3]-c[1])*l),this.transform=[h*l,F*l,L*l,it*l,dt-h*l*u-L*l*a,ut-F*l*u-it*l*a],this.width=wt,this.height=bt}get rawDims(){const{viewBox:c}=this;return(0,H.shadow)(this,"rawDims",{pageWidth:c[2]-c[0],pageHeight:c[3]-c[1],pageX:c[0],pageY:c[1]})}clone({scale:c=this.scale,rotation:l=this.rotation,offsetX:p=this.offsetX,offsetY:f=this.offsetY,dontFlip:d=!1}={}){return new g({viewBox:this.viewBox.slice(),scale:c,rotation:l,offsetX:p,offsetY:f,dontFlip:d})}convertToViewportPoint(c,l){return H.Util.applyTransform([c,l],this.transform)}convertToViewportRectangle(c){const l=H.Util.applyTransform([c[0],c[1]],this.transform),p=H.Util.applyTransform([c[2],c[3]],this.transform);return[l[0],l[1],p[0],p[1]]}convertToPdfPoint(c,l){return H.Util.applyInverseTransform([c,l],this.transform)}}class P extends H.BaseException{constructor(c,l=0){super(c,"RenderingCancelledException"),this.extraDelay=l}}function R(r){const c=r.length;let l=0;for(;l<c&&r[l].trim()==="";)l++;return r.substring(l,l+5).toLowerCase()==="data:"}function z(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function ct(r,c=!1){return c||([r]=r.split(/[#?]/,1)),r.substring(r.lastIndexOf("/")+1)}function tt(r,c="document.pdf"){if(typeof r!="string")return c;if(R(r))return(0,H.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),c;const l=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,p=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,f=l.exec(r);let d=p.exec(f[1])||p.exec(f[2])||p.exec(f[3]);if(d&&(d=d[0],d.includes("%")))try{d=p.exec(decodeURIComponent(d))[0]}catch{}return d||c}class N{constructor(){be(this,"started",Object.create(null));be(this,"times",[])}time(c){c in this.started&&(0,H.warn)(`Timer is already running for ${c}`),this.started[c]=Date.now()}timeEnd(c){c in this.started||(0,H.warn)(`Timer has not been started for ${c}`),this.times.push({name:c,start:this.started[c],end:Date.now()}),delete this.started[c]}toString(){const c=[];let l=0;for(const{name:p}of this.times)l=Math.max(p.length,l);for(const{name:p,start:f,end:d}of this.times)c.push(`${p.padEnd(l)} ${d-f}ms
`);return c.join("")}}function B(r,c){try{const{protocol:l}=c?new URL(r,c):new URL(r);return l==="http:"||l==="https:"}catch{return!1}}function D(r){r.preventDefault()}let _;class U{static toDateObject(c){if(!c||typeof c!="string")return null;_||(_=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const l=_.exec(c);if(!l)return null;const p=parseInt(l[1],10);let f=parseInt(l[2],10);f=f>=1&&f<=12?f-1:0;let d=parseInt(l[3],10);d=d>=1&&d<=31?d:1;let A=parseInt(l[4],10);A=A>=0&&A<=23?A:0;let u=parseInt(l[5],10);u=u>=0&&u<=59?u:0;let a=parseInt(l[6],10);a=a>=0&&a<=59?a:0;const h=l[7]||"Z";let F=parseInt(l[8],10);F=F>=0&&F<=23?F:0;let L=parseInt(l[9],10)||0;return L=L>=0&&L<=59?L:0,h==="-"?(A+=F,u+=L):h==="+"&&(A-=F,u-=L),new Date(Date.UTC(p,f,d,A,u,a))}}function G(r,{scale:c=1,rotation:l=0}){const{width:p,height:f}=r.attributes.style,d=[0,0,parseInt(p),parseInt(f)];return new g({viewBox:d,scale:c,rotation:l})}function pt(r){if(r.startsWith("#")){const c=parseInt(r.slice(1),16);return[(c&16711680)>>16,(c&65280)>>8,c&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(c=>parseInt(c)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(c=>parseInt(c)).slice(0,3):((0,H.warn)(`Not a valid color format: "${r}"`),[0,0,0])}function Mt(r){const c=document.createElement("span");c.style.visibility="hidden",document.body.append(c);for(const l of r.keys()){c.style.color=l;const p=window.getComputedStyle(c).color;r.set(l,pt(p))}c.remove()}function Tt(r){const{a:c,b:l,c:p,d:f,e:d,f:A}=r.getTransform();return[c,l,p,f,d,A]}function Ft(r){const{a:c,b:l,c:p,d:f,e:d,f:A}=r.getTransform().invertSelf();return[c,l,p,f,d,A]}function Pt(r,c,l=!1,p=!0){if(c instanceof g){const{pageWidth:f,pageHeight:d}=c.rawDims,{style:A}=r,u=H.FeatureTest.isCSSRoundSupported,a=`var(--scale-factor) * ${f}px`,h=`var(--scale-factor) * ${d}px`,F=u?`round(${a}, 1px)`:`calc(${a})`,L=u?`round(${h}, 1px)`:`calc(${h})`;!l||c.rotation%180===0?(A.width=F,A.height=L):(A.width=L,A.height=F)}p&&r.setAttribute("data-main-rotation",c.rotation)}},47:(st,ot,k)=>{var X,rt,V,I,M,Dn,x,_n,P,Hr;k.d(ot,{DrawLayer:()=>w});var s=k(419),H=k(292);const z=class z{constructor({pageIndex:tt}){o(this,x);o(this,P);o(this,X,null);o(this,rt,0);o(this,V,new Map);o(this,I,new Map);this.pageIndex=tt}setParent(tt){if(!t(this,X)){T(this,X,tt);return}if(t(this,X)!==tt){if(t(this,V).size>0)for(const N of t(this,V).values())N.remove(),tt.append(N);T(this,X,tt)}}static get _svgFactory(){return(0,H.shadow)(this,"_svgFactory",new s.DOMSVGFactory)}highlight(tt,N,B,D=!1){const _=gs(this,rt)._++,U=y(this,x,_n).call(this,tt.box);U.classList.add("highlight"),tt.free&&U.classList.add("free");const G=z._svgFactory.createElement("defs");U.append(G);const pt=z._svgFactory.createElement("path");G.append(pt);const Mt=`path_p${this.pageIndex}_${_}`;pt.setAttribute("id",Mt),pt.setAttribute("d",tt.toSVGPath()),D&&t(this,I).set(_,pt);const Tt=y(this,P,Hr).call(this,G,Mt),Ft=z._svgFactory.createElement("use");return U.append(Ft),U.setAttribute("fill",N),U.setAttribute("fill-opacity",B),Ft.setAttribute("href",`#${Mt}`),t(this,V).set(_,U),{id:_,clipPathId:`url(#${Tt})`}}highlightOutline(tt){const N=gs(this,rt)._++,B=y(this,x,_n).call(this,tt.box);B.classList.add("highlightOutline");const D=z._svgFactory.createElement("defs");B.append(D);const _=z._svgFactory.createElement("path");D.append(_);const U=`path_p${this.pageIndex}_${N}`;_.setAttribute("id",U),_.setAttribute("d",tt.toSVGPath()),_.setAttribute("vector-effect","non-scaling-stroke");let G;if(tt.free){B.classList.add("free");const Tt=z._svgFactory.createElement("mask");D.append(Tt),G=`mask_p${this.pageIndex}_${N}`,Tt.setAttribute("id",G),Tt.setAttribute("maskUnits","objectBoundingBox");const Ft=z._svgFactory.createElement("rect");Tt.append(Ft),Ft.setAttribute("width","1"),Ft.setAttribute("height","1"),Ft.setAttribute("fill","white");const Pt=z._svgFactory.createElement("use");Tt.append(Pt),Pt.setAttribute("href",`#${U}`),Pt.setAttribute("stroke","none"),Pt.setAttribute("fill","black"),Pt.setAttribute("fill-rule","nonzero"),Pt.classList.add("mask")}const pt=z._svgFactory.createElement("use");B.append(pt),pt.setAttribute("href",`#${U}`),G&&pt.setAttribute("mask",`url(#${G})`);const Mt=pt.cloneNode();return B.append(Mt),pt.classList.add("mainOutline"),Mt.classList.add("secondaryOutline"),t(this,V).set(N,B),N}finalizeLine(tt,N){const B=t(this,I).get(tt);t(this,I).delete(tt),this.updateBox(tt,N.box),B.setAttribute("d",N.toSVGPath())}updateLine(tt,N){t(this,V).get(tt).firstChild.firstChild.setAttribute("d",N.toSVGPath())}removeFreeHighlight(tt){this.remove(tt),t(this,I).delete(tt)}updatePath(tt,N){t(this,I).get(tt).setAttribute("d",N.toSVGPath())}updateBox(tt,N){var B;y(B=z,M,Dn).call(B,t(this,V).get(tt),N)}show(tt,N){t(this,V).get(tt).classList.toggle("hidden",!N)}rotate(tt,N){t(this,V).get(tt).setAttribute("data-main-rotation",N)}changeColor(tt,N){t(this,V).get(tt).setAttribute("fill",N)}changeOpacity(tt,N){t(this,V).get(tt).setAttribute("fill-opacity",N)}addClass(tt,N){t(this,V).get(tt).classList.add(N)}removeClass(tt,N){t(this,V).get(tt).classList.remove(N)}remove(tt){t(this,X)!==null&&(t(this,V).get(tt).remove(),t(this,V).delete(tt))}destroy(){T(this,X,null);for(const tt of t(this,V).values())tt.remove();t(this,V).clear()}};X=new WeakMap,rt=new WeakMap,V=new WeakMap,I=new WeakMap,M=new WeakSet,Dn=function(tt,{x:N=0,y:B=0,width:D=1,height:_=1}={}){const{style:U}=tt;U.top=`${100*B}%`,U.left=`${100*N}%`,U.width=`${100*D}%`,U.height=`${100*_}%`},x=new WeakSet,_n=function(tt){var B;const N=z._svgFactory.create(1,1,!0);return t(this,X).append(N),N.setAttribute("aria-hidden",!0),y(B=z,M,Dn).call(B,N,tt),N},P=new WeakSet,Hr=function(tt,N){const B=z._svgFactory.createElement("clipPath");tt.append(B);const D=`clip_${N}`;B.setAttribute("id",D),B.setAttribute("clipPathUnits","objectBoundingBox");const _=z._svgFactory.createElement("use");return B.append(_),_.setAttribute("href",`#${N}`),_.classList.add("clip"),D},o(z,M);let w=z},731:(st,ot,k)=>{var z,ct,tt,N,B,D,_,U,G,pt,Mt,Br,Ft,Vr,Vt,$r,qt,Qi,kt,Zi,zt,tn,oe,zr,xe,On,ce,Ur,ae,Fe,Zt,Ie,ee,K,i,n,r,c,l,p,f,d,A,u,a,h,F,L,Hn,dt,Bn,wt,Gr,At,Xr,O,Wr,q,Vn,et,xi,$,ii,ht,Yr,Lt,en,Kt,Ei,fe,jr,de,qr,Ee,Kr,Le,Jr,m,Y,nt,lt,vt,yt,$t,Ot,Et,It,Bt,_t,ne,Qt,le,ge,Qr,Te,Zr,He,ta,C,ea,Nt,$n,Ut,sa,se,zn,we,ia,Oe,na,Bs,ra,Cs,aa,Ni,oa,cs,Ds,ri,Un,Vs,sn,$s,nn,vs,ni,ai,Gn,zs,rn,Di,la,oi,Xn,_i,ha,Oi,ca,li,Wn,Us,an,ks,Ti,Ge,Xe,As,ds,ys,Gs,as,Rs,os,is,hi,Fs,Ci,Ls,ki,Xs,on,ci,Yn,Hi,da,Bi,ua,di,jn,Ws,ln,Vi,fa,Ps,Ys,ls,Ms,us,fs,ps,Ke,ws,js,qs,Ye,ue,Ss,$i,pa,fi,qn,pi,Kn,gi,Jn,Ks,hn;k.d(ot,{AnnotationEditorLayer:()=>R});var s=k(292),H=k(310),w=k(830),X=k(976);const rt=/\r\n?|\n/g,re=class re extends H.AnnotationEditor{constructor(e){super({...e,name:"freeTextEditor"});o(this,Mt);o(this,Ft);o(this,Vt);o(this,qt);o(this,zt);o(this,oe);o(this,ce);o(this,z,this.editorDivBlur.bind(this));o(this,ct,this.editorDivFocus.bind(this));o(this,tt,this.editorDivInput.bind(this));o(this,N,this.editorDivKeydown.bind(this));o(this,B,this.editorDivPaste.bind(this));o(this,D,void 0);o(this,_,"");o(this,U,`${this.id}-editor`);o(this,G,void 0);o(this,pt,null);T(this,D,e.color||re._defaultColor||H.AnnotationEditor._defaultLineColor),T(this,G,e.fontSize||re._defaultFontSize)}static get _keyboardManager(){const e=re.prototype,b=mt=>mt.isEmpty(),J=w.AnnotationEditorUIManager.TRANSLATE_SMALL,Q=w.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,s.shadow)(this,"_keyboardManager",new w.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-J,0],checker:b}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-Q,0],checker:b}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[J,0],checker:b}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[Q,0],checker:b}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-J],checker:b}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-Q],checker:b}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,J],checker:b}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,Q],checker:b}]]))}static initialize(e,b){H.AnnotationEditor.initialize(e,b,{strings:["pdfjs-free-text-default-content"]});const J=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(J.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,b){switch(e){case s.AnnotationEditorParamsType.FREETEXT_SIZE:re._defaultFontSize=b;break;case s.AnnotationEditorParamsType.FREETEXT_COLOR:re._defaultColor=b;break}}updateParams(e,b){switch(e){case s.AnnotationEditorParamsType.FREETEXT_SIZE:y(this,Mt,Br).call(this,b);break;case s.AnnotationEditorParamsType.FREETEXT_COLOR:y(this,Ft,Vr).call(this,b);break}}static get defaultPropertiesToUpdate(){return[[s.AnnotationEditorParamsType.FREETEXT_SIZE,re._defaultFontSize],[s.AnnotationEditorParamsType.FREETEXT_COLOR,re._defaultColor||H.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[s.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,G)],[s.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,D)]]}_translateEmpty(e,b){this._uiManager.translateSelectedEditors(e,b,!0)}getInitialTranslation(){const e=this.parentScale;return[-re._internalPadding*e,-(re._internalPadding+t(this,G))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(s.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,N)),this.editorDiv.addEventListener("focus",t(this,ct)),this.editorDiv.addEventListener("blur",t(this,z)),this.editorDiv.addEventListener("input",t(this,tt)),this.editorDiv.addEventListener("paste",t(this,B)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,U)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,N)),this.editorDiv.removeEventListener("focus",t(this,ct)),this.editorDiv.removeEventListener("blur",t(this,z)),this.editorDiv.removeEventListener("input",t(this,tt)),this.editorDiv.removeEventListener("paste",t(this,B)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var e;this.width||(this.enableEditMode(),this.editorDiv.focus(),(e=this._initialOptions)!=null&&e.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=t(this,_),b=T(this,_,y(this,Vt,$r).call(this).trimEnd());if(e===b)return;const J=Q=>{if(T(this,_,Q),!Q){this.remove();return}y(this,zt,tn).call(this),this._uiManager.rebuild(this),y(this,qt,Qi).call(this)};this.addCommands({cmd:()=>{J(b)},undo:()=>{J(e)},mustExec:!1}),y(this,qt,Qi).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){re._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,b;this.width&&(e=this.x,b=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,U)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),H.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(Q=>{var mt;return(mt=this.editorDiv)==null?void 0:mt.setAttribute("default-content",Q)}),this.editorDiv.contentEditable=!0;const{style:J}=this.editorDiv;if(J.fontSize=`calc(${t(this,G)}px * var(--scale-factor))`,J.color=t(this,D),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,w.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Q,mt]=this.parentDimensions;if(this.annotationElementId){const{position:Rt}=t(this,pt);let[Dt,Ct]=this.getInitialTranslation();[Dt,Ct]=this.pageTranslationToScreen(Dt,Ct);const[Gt,Yt]=this.pageDimensions,[ve,Ae]=this.pageTranslation;let Ce,ke;switch(this.rotation){case 0:Ce=e+(Rt[0]-ve)/Gt,ke=b+this.height-(Rt[1]-Ae)/Yt;break;case 90:Ce=e+(Rt[0]-ve)/Gt,ke=b-(Rt[1]-Ae)/Yt,[Dt,Ct]=[Ct,-Dt];break;case 180:Ce=e-this.width+(Rt[0]-ve)/Gt,ke=b-(Rt[1]-Ae)/Yt,[Dt,Ct]=[-Dt,-Ct];break;case 270:Ce=e+(Rt[0]-ve-this.height*Yt)/Gt,ke=b+(Rt[1]-Ae-this.width*Gt)/Yt,[Dt,Ct]=[-Ct,Dt];break}this.setAt(Ce*Q,ke*mt,Dt,Ct)}else this.setAt(e*Q,b*mt,this.width*Q,this.height*mt);y(this,zt,tn).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var Ce,ke,ze;const b=e.clipboardData||window.clipboardData,{types:J}=b;if(J.length===1&&J[0]==="text/plain")return;e.preventDefault();const Q=y(Ce=re,xe,On).call(Ce,b.getData("text")||"").replaceAll(rt,`
`);if(!Q)return;const mt=window.getSelection();if(!mt.rangeCount)return;this.editorDiv.normalize(),mt.deleteFromDocument();const Rt=mt.getRangeAt(0);if(!Q.includes(`
`)){Rt.insertNode(document.createTextNode(Q)),this.editorDiv.normalize(),mt.collapseToStart();return}const{startContainer:Dt,startOffset:Ct}=Rt,Gt=[],Yt=[];if(Dt.nodeType===Node.TEXT_NODE){const Pe=Dt.parentElement;if(Yt.push(Dt.nodeValue.slice(Ct).replaceAll(rt,"")),Pe!==this.editorDiv){let $e=Gt;for(const Be of this.editorDiv.childNodes){if(Be===Pe){$e=Yt;continue}$e.push(y(ke=re,kt,Zi).call(ke,Be))}}Gt.push(Dt.nodeValue.slice(0,Ct).replaceAll(rt,""))}else if(Dt===this.editorDiv){let Pe=Gt,$e=0;for(const Be of this.editorDiv.childNodes)$e++===Ct&&(Pe=Yt),Pe.push(y(ze=re,kt,Zi).call(ze,Be))}T(this,_,`${Gt.join(`
`)}${Q}${Yt.join(`
`)}`),y(this,zt,tn).call(this);const ve=new Range;let Ae=Gt.reduce((Pe,$e)=>Pe+$e.length,0);for(const{firstChild:Pe}of this.editorDiv.childNodes)if(Pe.nodeType===Node.TEXT_NODE){const $e=Pe.nodeValue.length;if(Ae<=$e){ve.setStart(Pe,Ae),ve.setEnd(Pe,Ae);break}Ae-=$e}mt.removeAllRanges(),mt.addRange(ve)}get contentDiv(){return this.editorDiv}static deserialize(e,b,J){var Rt;let Q=null;if(e instanceof X.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Dt,fontColor:Ct},rect:Gt,rotation:Yt,id:ve},textContent:Ae,textPosition:Ce,parent:{page:{pageNumber:ke}}}=e;if(!Ae||Ae.length===0)return null;Q=e={annotationType:s.AnnotationEditorType.FREETEXT,color:Array.from(Ct),fontSize:Dt,value:Ae.join(`
`),position:Ce,pageIndex:ke-1,rect:Gt.slice(0),rotation:Yt,id:ve,deleted:!1}}const mt=super.deserialize(e,b,J);return T(mt,G,e.fontSize),T(mt,D,s.Util.makeHexColor(...e.color)),T(mt,_,y(Rt=re,xe,On).call(Rt,e.value)),mt.annotationElementId=e.id||null,T(mt,pt,Q),mt}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const b=re._internalPadding*this.parentScale,J=this.getRect(b,b),Q=H.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,D)),mt={annotationType:s.AnnotationEditorType.FREETEXT,color:Q,fontSize:t(this,G),value:y(this,oe,zr).call(this),pageIndex:this.pageIndex,rect:J,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?mt:this.annotationElementId&&!y(this,ce,Ur).call(this,mt)?null:(mt.id=this.annotationElementId,mt)}renderAnnotationElement(e){const b=super.renderAnnotationElement(e);if(this.deleted)return b;const{style:J}=b;J.fontSize=`calc(${t(this,G)}px * var(--scale-factor))`,J.color=t(this,D),b.replaceChildren();for(const mt of t(this,_).split(`
`)){const Rt=document.createElement("div");Rt.append(mt?document.createTextNode(mt):document.createElement("br")),b.append(Rt)}const Q=re._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(Q,Q)}),b}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};z=new WeakMap,ct=new WeakMap,tt=new WeakMap,N=new WeakMap,B=new WeakMap,D=new WeakMap,_=new WeakMap,U=new WeakMap,G=new WeakMap,pt=new WeakMap,Mt=new WeakSet,Br=function(e){const b=Q=>{this.editorDiv.style.fontSize=`calc(${Q}px * var(--scale-factor))`,this.translate(0,-(Q-t(this,G))*this.parentScale),T(this,G,Q),y(this,qt,Qi).call(this)},J=t(this,G);this.addCommands({cmd:b.bind(this,e),undo:b.bind(this,J),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:s.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Ft=new WeakSet,Vr=function(e){const b=Q=>{T(this,D,this.editorDiv.style.color=Q)},J=t(this,D);this.addCommands({cmd:b.bind(this,e),undo:b.bind(this,J),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:s.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Vt=new WeakSet,$r=function(){var b;const e=[];this.editorDiv.normalize();for(const J of this.editorDiv.childNodes)e.push(y(b=re,kt,Zi).call(b,J));return e.join(`
`)},qt=new WeakSet,Qi=function(){const[e,b]=this.parentDimensions;let J;if(this.isAttachedToDOM)J=this.div.getBoundingClientRect();else{const{currentLayer:Q,div:mt}=this,Rt=mt.style.display,Dt=mt.classList.contains("hidden");mt.classList.remove("hidden"),mt.style.display="hidden",Q.div.append(this.div),J=mt.getBoundingClientRect(),mt.remove(),mt.style.display=Rt,mt.classList.toggle("hidden",Dt)}this.rotation%180===this.parentRotation%180?(this.width=J.width/e,this.height=J.height/b):(this.width=J.height/e,this.height=J.width/b),this.fixAndSetPosition()},kt=new WeakSet,Zi=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(rt,"")},zt=new WeakSet,tn=function(){if(this.editorDiv.replaceChildren(),!!t(this,_))for(const e of t(this,_).split(`
`)){const b=document.createElement("div");b.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(b)}},oe=new WeakSet,zr=function(){return t(this,_).replaceAll(""," ")},xe=new WeakSet,On=function(e){return e.replaceAll(" ","")},ce=new WeakSet,Ur=function(e){const{value:b,fontSize:J,color:Q,pageIndex:mt}=t(this,pt);return this._hasBeenMoved||e.value!==b||e.fontSize!==J||e.color.some((Rt,Dt)=>Rt!==Q[Dt])||e.pageIndex!==mt},o(re,kt),o(re,xe),be(re,"_freeTextDefaultContent",""),be(re,"_internalPadding",0),be(re,"_defaultColor",null),be(re,"_defaultFontSize",10),be(re,"_type","freetext"),be(re,"_editorType",s.AnnotationEditorType.FREETEXT);let V=re;var I=k(61),M=k(259),W=k(419);const v=class v extends H.AnnotationEditor{constructor(e){super({...e,name:"highlightEditor"});o(this,L);o(this,dt);o(this,wt);o(this,At);o(this,O);o(this,q);o(this,et);o(this,ht);o(this,Lt);o(this,Kt);o(this,fe);o(this,de);o(this,ae,null);o(this,Fe,0);o(this,Zt,void 0);o(this,Ie,null);o(this,ee,null);o(this,K,null);o(this,i,null);o(this,n,0);o(this,r,null);o(this,c,null);o(this,l,null);o(this,p,!1);o(this,f,y(this,ht,Yr).bind(this));o(this,d,null);o(this,A,void 0);o(this,u,null);o(this,a,"");o(this,h,void 0);o(this,F,"");this.color=e.color||v._defaultColor,T(this,h,e.thickness||v._defaultThickness),T(this,A,e.opacity||v._defaultOpacity),T(this,Zt,e.boxes||null),T(this,F,e.methodOfCreation||""),T(this,a,e.text||""),this._isDraggable=!1,e.highlightId>-1?(T(this,p,!0),y(this,dt,Bn).call(this,e),y(this,et,xi).call(this)):(T(this,ae,e.anchorNode),T(this,Fe,e.anchorOffset),T(this,i,e.focusNode),T(this,n,e.focusOffset),y(this,L,Hn).call(this),y(this,et,xi).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=v.prototype;return(0,s.shadow)(this,"_keyboardManager",new w.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:t(this,p)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:t(this,h),methodOfCreation:t(this,F)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,b){var J;H.AnnotationEditor.initialize(e,b),v._defaultColor||(v._defaultColor=((J=b.highlightColors)==null?void 0:J.values().next().value)||"#fff066")}static updateDefaultParams(e,b){switch(e){case s.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:v._defaultColor=b;break;case s.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:v._defaultThickness=b;break}}translateInPage(e,b){}get toolbarPosition(){return t(this,d)}updateParams(e,b){switch(e){case s.AnnotationEditorParamsType.HIGHLIGHT_COLOR:y(this,wt,Gr).call(this,b);break;case s.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:y(this,At,Xr).call(this,b);break}}static get defaultPropertiesToUpdate(){return[[s.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,v._defaultColor],[s.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,v._defaultThickness]]}get propertiesToUpdate(){return[[s.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||v._defaultColor],[s.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,t(this,h)||v._defaultThickness],[s.AnnotationEditorParamsType.HIGHLIGHT_FREE,t(this,p)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(T(this,ee,new M.ColorPicker({editor:this})),e.addColorPicker(t(this,ee))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(y(this,Kt,Ei).call(this))}getBaseTranslation(){return[0,0]}getRect(e,b){return super.getRect(e,b,y(this,Kt,Ei).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){y(this,q,Vn).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(y(this,et,xi).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var J;let b=!1;this.parent&&!e?y(this,q,Vn).call(this):e&&(y(this,et,xi).call(this,e),b=!this.parent&&((J=this.div)==null?void 0:J.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),b&&this.select()}rotate(e){var Q,mt,Rt;const{drawLayer:b}=this.parent;let J;t(this,p)?(e=(e-this.rotation+360)%360,J=y(Q=v,$,ii).call(Q,t(this,c).box,e)):J=y(mt=v,$,ii).call(mt,this,e),b.rotate(t(this,l),e),b.rotate(t(this,u),e),b.updateBox(t(this,l),J),b.updateBox(t(this,u),y(Rt=v,$,ii).call(Rt,t(this,K).box,e))}render(){if(this.div)return this.div;const e=super.render();t(this,a)&&(e.setAttribute("aria-label",t(this,a)),e.setAttribute("role","mark")),t(this,p)?e.classList.add("free"):this.div.addEventListener("keydown",t(this,f));const b=T(this,r,document.createElement("div"));e.append(b),b.setAttribute("aria-hidden","true"),b.className="internal",b.style.clipPath=t(this,Ie);const[J,Q]=this.parentDimensions;return this.setDims(this.width*J,this.height*Q),(0,w.bindEvents)(this,t(this,r),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.parent.drawLayer.addClass(t(this,u),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(t(this,u),"hovered")}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:y(this,Lt,en).call(this,!0);break;case 1:case 3:y(this,Lt,en).call(this,!1);break}}select(){var e,b;super.select(),t(this,u)&&((e=this.parent)==null||e.drawLayer.removeClass(t(this,u),"hovered"),(b=this.parent)==null||b.drawLayer.addClass(t(this,u),"selected"))}unselect(){var e;super.unselect(),t(this,u)&&((e=this.parent)==null||e.drawLayer.removeClass(t(this,u),"selected"),t(this,p)||y(this,Lt,en).call(this,!1))}get _mustFixPosition(){return!t(this,p)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(t(this,l),e),this.parent.drawLayer.show(t(this,u),e))}static startHighlighting(e,b,{target:J,x:Q,y:mt}){const{x:Rt,y:Dt,width:Ct,height:Gt}=J.getBoundingClientRect(),Yt=ke=>{y(this,Ee,Kr).call(this,e,ke)},ve={capture:!0,passive:!1},Ae=ke=>{ke.preventDefault(),ke.stopPropagation()},Ce=ke=>{J.removeEventListener("pointermove",Yt),window.removeEventListener("blur",Ce),window.removeEventListener("pointerup",Ce),window.removeEventListener("pointerdown",Ae,ve),window.removeEventListener("contextmenu",W.noContextMenu),y(this,Le,Jr).call(this,e,ke)};window.addEventListener("blur",Ce),window.addEventListener("pointerup",Ce),window.addEventListener("pointerdown",Ae,ve),window.addEventListener("contextmenu",W.noContextMenu),J.addEventListener("pointermove",Yt),this._freeHighlight=new I.FreeOutliner({x:Q,y:mt},[Rt,Dt,Ct,Gt],e.scale,this._defaultThickness/2,b,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(e,b,J){var ke;const Q=super.deserialize(e,b,J),{rect:[mt,Rt,Dt,Ct],color:Gt,quadPoints:Yt}=e;Q.color=s.Util.makeHexColor(...Gt),T(Q,A,e.opacity);const[ve,Ae]=Q.pageDimensions;Q.width=(Dt-mt)/ve,Q.height=(Ct-Rt)/Ae;const Ce=T(Q,Zt,[]);for(let ze=0;ze<Yt.length;ze+=8)Ce.push({x:(Yt[4]-Dt)/ve,y:(Ct-(1-Yt[ze+5]))/Ae,width:(Yt[ze+2]-Yt[ze])/ve,height:(Yt[ze+5]-Yt[ze+1])/Ae});return y(ke=Q,L,Hn).call(ke),Q}serialize(e=!1){if(this.isEmpty()||e)return null;const b=this.getRect(0,0),J=H.AnnotationEditor._colorManager.convert(this.color);return{annotationType:s.AnnotationEditorType.HIGHLIGHT,color:J,opacity:t(this,A),thickness:t(this,h),quadPoints:y(this,fe,jr).call(this),outlines:y(this,de,qr).call(this,b),pageIndex:this.pageIndex,rect:b,rotation:y(this,Kt,Ei).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};ae=new WeakMap,Fe=new WeakMap,Zt=new WeakMap,Ie=new WeakMap,ee=new WeakMap,K=new WeakMap,i=new WeakMap,n=new WeakMap,r=new WeakMap,c=new WeakMap,l=new WeakMap,p=new WeakMap,f=new WeakMap,d=new WeakMap,A=new WeakMap,u=new WeakMap,a=new WeakMap,h=new WeakMap,F=new WeakMap,L=new WeakSet,Hn=function(){const e=new I.Outliner(t(this,Zt),.001);T(this,c,e.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=t(this,c).box;const b=new I.Outliner(t(this,Zt),.0025,.001,this._uiManager.direction==="ltr");T(this,K,b.getOutlines());const{lastPoint:J}=t(this,K).box;T(this,d,[(J[0]-this.x)/this.width,(J[1]-this.y)/this.height])},dt=new WeakSet,Bn=function({highlightOutlines:e,highlightId:b,clipPathId:J}){var Yt,ve;if(T(this,c,e),T(this,K,e.getNewOutline(t(this,h)/2+1.5,.0025)),b>=0)T(this,l,b),T(this,Ie,J),this.parent.drawLayer.finalizeLine(b,e),T(this,u,this.parent.drawLayer.highlightOutline(t(this,K)));else if(this.parent){const Ae=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(t(this,l),e),this.parent.drawLayer.updateBox(t(this,l),y(Yt=v,$,ii).call(Yt,t(this,c).box,(Ae-this.rotation+360)%360)),this.parent.drawLayer.updateLine(t(this,u),t(this,K)),this.parent.drawLayer.updateBox(t(this,u),y(ve=v,$,ii).call(ve,t(this,K).box,Ae))}const{x:mt,y:Rt,width:Dt,height:Ct}=e.box;switch(this.rotation){case 0:this.x=mt,this.y=Rt,this.width=Dt,this.height=Ct;break;case 90:{const[Ae,Ce]=this.parentDimensions;this.x=Rt,this.y=1-mt,this.width=Dt*Ce/Ae,this.height=Ct*Ae/Ce;break}case 180:this.x=1-mt,this.y=1-Rt,this.width=Dt,this.height=Ct;break;case 270:{const[Ae,Ce]=this.parentDimensions;this.x=1-Rt,this.y=mt,this.width=Dt*Ce/Ae,this.height=Ct*Ae/Ce;break}}const{lastPoint:Gt}=t(this,K).box;T(this,d,[(Gt[0]-mt)/Dt,(Gt[1]-Rt)/Ct])},wt=new WeakSet,Gr=function(e){const b=Q=>{var mt,Rt;this.color=Q,(mt=this.parent)==null||mt.drawLayer.changeColor(t(this,l),Q),(Rt=t(this,ee))==null||Rt.updateColor(Q)},J=this.color;this.addCommands({cmd:b.bind(this,e),undo:b.bind(this,J),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:s.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},At=new WeakSet,Xr=function(e){const b=t(this,h),J=Q=>{T(this,h,Q),y(this,O,Wr).call(this,Q)};this.addCommands({cmd:J.bind(this,e),undo:J.bind(this,b),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:s.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},O=new WeakSet,Wr=function(e){if(!t(this,p))return;y(this,dt,Bn).call(this,{highlightOutlines:t(this,c).getNewOutline(e/2)}),this.fixAndSetPosition();const[b,J]=this.parentDimensions;this.setDims(this.width*b,this.height*J)},q=new WeakSet,Vn=function(){t(this,l)===null||!this.parent||(this.parent.drawLayer.remove(t(this,l)),T(this,l,null),this.parent.drawLayer.remove(t(this,u)),T(this,u,null))},et=new WeakSet,xi=function(e=this.parent){t(this,l)===null&&({id:gs(this,l)._,clipPathId:gs(this,Ie)._}=e.drawLayer.highlight(t(this,c),this.color,t(this,A)),T(this,u,e.drawLayer.highlightOutline(t(this,K))),t(this,r)&&(t(this,r).style.clipPath=t(this,Ie)))},$=new WeakSet,ii=function({x:e,y:b,width:J,height:Q},mt){switch(mt){case 90:return{x:1-b-Q,y:e,width:Q,height:J};case 180:return{x:1-e-J,y:1-b-Q,width:J,height:Q};case 270:return{x:b,y:1-e-J,width:Q,height:J}}return{x:e,y:b,width:J,height:Q}},ht=new WeakSet,Yr=function(e){v._keyboardManager.exec(this,e)},Lt=new WeakSet,en=function(e){if(!t(this,ae))return;const b=window.getSelection();e?b.setPosition(t(this,ae),t(this,Fe)):b.setPosition(t(this,i),t(this,n))},Kt=new WeakSet,Ei=function(){return t(this,p)?this.rotation:0},fe=new WeakSet,jr=function(){if(t(this,p))return null;const[e,b]=this.pageDimensions,J=t(this,Zt),Q=new Array(J.length*8);let mt=0;for(const{x:Rt,y:Dt,width:Ct,height:Gt}of J){const Yt=Rt*e,ve=(1-Dt-Gt)*b;Q[mt]=Q[mt+4]=Yt,Q[mt+1]=Q[mt+3]=ve,Q[mt+2]=Q[mt+6]=Yt+Ct*e,Q[mt+5]=Q[mt+7]=ve+Gt*b,mt+=8}return Q},de=new WeakSet,qr=function(e){return t(this,c).serialize(e,y(this,Kt,Ei).call(this))},Ee=new WeakSet,Kr=function(e,b){this._freeHighlight.add(b)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},Le=new WeakSet,Jr=function(e,b){this._freeHighlight.isEmpty()?e.drawLayer.removeFreeHighlight(this._freeHighlightId):e.createAndAddNewEditor(b,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},o(v,$),o(v,Ee),o(v,Le),be(v,"_defaultColor",null),be(v,"_defaultOpacity",1),be(v,"_defaultThickness",12),be(v,"_l10nPromise"),be(v,"_type","highlight"),be(v,"_editorType",s.AnnotationEditorType.HIGHLIGHT),be(v,"_freeHighlightId",-1),be(v,"_freeHighlight",null),be(v,"_freeHighlightClipId","");let x=v;const Ne=class Ne extends H.AnnotationEditor{constructor(e){super({...e,name:"inkEditor"});o(this,ge);o(this,Te);o(this,He);o(this,C);o(this,Nt);o(this,Ut);o(this,se);o(this,we);o(this,Oe);o(this,Bs);o(this,Cs);o(this,Ni);o(this,cs);o(this,ri);o(this,Vs);o(this,$s);o(this,vs);o(this,ai);o(this,zs);o(this,Oi);o(this,li);o(this,Us);o(this,ks);o(this,m,0);o(this,Y,0);o(this,nt,this.canvasPointermove.bind(this));o(this,lt,this.canvasPointerleave.bind(this));o(this,vt,this.canvasPointerup.bind(this));o(this,yt,this.canvasPointerdown.bind(this));o(this,$t,null);o(this,Ot,new Path2D);o(this,Et,!1);o(this,It,!1);o(this,Bt,!1);o(this,_t,null);o(this,ne,0);o(this,Qt,0);o(this,le,null);this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,b){H.AnnotationEditor.initialize(e,b)}static updateDefaultParams(e,b){switch(e){case s.AnnotationEditorParamsType.INK_THICKNESS:Ne._defaultThickness=b;break;case s.AnnotationEditorParamsType.INK_COLOR:Ne._defaultColor=b;break;case s.AnnotationEditorParamsType.INK_OPACITY:Ne._defaultOpacity=b/100;break}}updateParams(e,b){switch(e){case s.AnnotationEditorParamsType.INK_THICKNESS:y(this,ge,Qr).call(this,b);break;case s.AnnotationEditorParamsType.INK_COLOR:y(this,Te,Zr).call(this,b);break;case s.AnnotationEditorParamsType.INK_OPACITY:y(this,He,ta).call(this,b);break}}static get defaultPropertiesToUpdate(){return[[s.AnnotationEditorParamsType.INK_THICKNESS,Ne._defaultThickness],[s.AnnotationEditorParamsType.INK_COLOR,Ne._defaultColor||H.AnnotationEditor._defaultLineColor],[s.AnnotationEditorParamsType.INK_OPACITY,Math.round(Ne._defaultOpacity*100)]]}get propertiesToUpdate(){return[[s.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ne._defaultThickness],[s.AnnotationEditorParamsType.INK_COLOR,this.color||Ne._defaultColor||H.AnnotationEditor._defaultLineColor],[s.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Ne._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(y(this,Vs,sn).call(this),y(this,$s,nn).call(this)),this.isAttachedToDOM||(this.parent.add(this),y(this,vs,ni).call(this)),y(this,ks,Ti).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,$t)&&(clearTimeout(t(this,$t)),T(this,$t,null)),t(this,_t).disconnect(),T(this,_t,null),super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,b]=this.parentDimensions,J=this.width*e,Q=this.height*b;this.setDimensions(J,Q)}enableEditMode(){t(this,Et)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,yt)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,yt)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,Et)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),T(this,Et,!0),this.div.classList.add("disabled"),y(this,ks,Ti).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||t(this,Et)||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),y(this,Ut,sa).call(this,e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),y(this,se,zn).call(this,e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),y(this,ri,Un).call(this,e)}canvasPointerleave(e){y(this,ri,Un).call(this,e)}get isResizable(){return!this.isEmpty()&&t(this,Et)}render(){if(this.div)return this.div;let e,b;this.width&&(e=this.x,b=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[J,Q,mt,Rt]=y(this,C,ea).call(this);if(this.setAt(J,Q,0,0),this.setDims(mt,Rt),y(this,Vs,sn).call(this),this.width){const[Dt,Ct]=this.parentDimensions;this.setAspectRatio(this.width*Dt,this.height*Ct),this.setAt(e*Dt,b*Ct,this.width*Dt,this.height*Ct),T(this,Bt,!0),y(this,vs,ni).call(this),this.setDims(this.width*Dt,this.height*Ct),y(this,cs,Ds).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return y(this,$s,nn).call(this),this.div}setDimensions(e,b){const J=Math.round(e),Q=Math.round(b);if(t(this,ne)===J&&t(this,Qt)===Q)return;T(this,ne,J),T(this,Qt,Q),this.canvas.style.visibility="hidden";const[mt,Rt]=this.parentDimensions;this.width=e/mt,this.height=b/Rt,this.fixAndSetPosition(),t(this,Et)&&y(this,ai,Gn).call(this,e,b),y(this,vs,ni).call(this),y(this,cs,Ds).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(e,b,J){var ze,Pe,$e;if(e instanceof X.InkAnnotationElement)return null;const Q=super.deserialize(e,b,J);Q.thickness=e.thickness,Q.color=s.Util.makeHexColor(...e.color),Q.opacity=e.opacity;const[mt,Rt]=Q.pageDimensions,Dt=Q.width*mt,Ct=Q.height*Rt,Gt=Q.parentScale,Yt=e.thickness/2;T(Q,Et,!0),T(Q,ne,Math.round(Dt)),T(Q,Qt,Math.round(Ct));const{paths:ve,rect:Ae,rotation:Ce}=e;for(let{bezier:Be}of ve){Be=y(ze=Ne,_i,ha).call(ze,Be,Ae,Ce);const hs=[];Q.paths.push(hs);let mi=Gt*(Be[0]-Yt),bi=Gt*(Be[1]-Yt);for(let rs=2,An=Be.length;rs<An;rs+=6){const yn=Gt*(Be[rs]-Yt),Ui=Gt*(Be[rs+1]-Yt),Gi=Gt*(Be[rs+2]-Yt),Xi=Gt*(Be[rs+3]-Yt),vi=Gt*(Be[rs+4]-Yt),Sr=Gt*(Be[rs+5]-Yt);hs.push([[mi,bi],[yn,Ui],[Gi,Xi],[vi,Sr]]),mi=vi,bi=Sr}const zi=y(this,Di,la).call(this,hs);Q.bezierPath2D.push(zi)}const ke=y(Pe=Q,li,Wn).call(Pe);return T(Q,Y,Math.max(H.AnnotationEditor.MIN_SIZE,ke[2]-ke[0])),T(Q,m,Math.max(H.AnnotationEditor.MIN_SIZE,ke[3]-ke[1])),y($e=Q,ai,Gn).call($e,Dt,Ct),Q}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),b=H.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:s.AnnotationEditorType.INK,color:b,thickness:this.thickness,opacity:this.opacity,paths:y(this,Oi,ca).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};m=new WeakMap,Y=new WeakMap,nt=new WeakMap,lt=new WeakMap,vt=new WeakMap,yt=new WeakMap,$t=new WeakMap,Ot=new WeakMap,Et=new WeakMap,It=new WeakMap,Bt=new WeakMap,_t=new WeakMap,ne=new WeakMap,Qt=new WeakMap,le=new WeakMap,ge=new WeakSet,Qr=function(e){const b=Q=>{this.thickness=Q,y(this,ks,Ti).call(this)},J=this.thickness;this.addCommands({cmd:b.bind(this,e),undo:b.bind(this,J),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:s.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Te=new WeakSet,Zr=function(e){const b=Q=>{this.color=Q,y(this,cs,Ds).call(this)},J=this.color;this.addCommands({cmd:b.bind(this,e),undo:b.bind(this,J),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:s.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},He=new WeakSet,ta=function(e){const b=Q=>{this.opacity=Q,y(this,cs,Ds).call(this)};e/=100;const J=this.opacity;this.addCommands({cmd:b.bind(this,e),undo:b.bind(this,J),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:s.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},C=new WeakSet,ea=function(){const{parentRotation:e,parentDimensions:[b,J]}=this;switch(e){case 90:return[0,J,J,b];case 180:return[b,J,b,J];case 270:return[b,0,J,b];default:return[0,0,b,J]}},Nt=new WeakSet,$n=function(){const{ctx:e,color:b,opacity:J,thickness:Q,parentScale:mt,scaleFactor:Rt}=this;e.lineWidth=Q*mt/Rt,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${b}${(0,w.opacityToHex)(J)}`},Ut=new WeakSet,sa=function(e,b){this.canvas.addEventListener("contextmenu",W.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,lt)),this.canvas.addEventListener("pointermove",t(this,nt)),this.canvas.addEventListener("pointerup",t(this,vt)),this.canvas.removeEventListener("pointerdown",t(this,yt)),this.isEditing=!0,t(this,Bt)||(T(this,Bt,!0),y(this,vs,ni).call(this),this.thickness||(this.thickness=Ne._defaultThickness),this.color||(this.color=Ne._defaultColor||H.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Ne._defaultOpacity)),this.currentPath.push([e,b]),T(this,It,!1),y(this,Nt,$n).call(this),T(this,le,()=>{y(this,Bs,ra).call(this),t(this,le)&&window.requestAnimationFrame(t(this,le))}),window.requestAnimationFrame(t(this,le))},se=new WeakSet,zn=function(e,b){const[J,Q]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===J&&b===Q)return;const mt=this.currentPath;let Rt=t(this,Ot);if(mt.push([e,b]),T(this,It,!0),mt.length<=2){Rt.moveTo(...mt[0]),Rt.lineTo(e,b);return}mt.length===3&&(T(this,Ot,Rt=new Path2D),Rt.moveTo(...mt[0])),y(this,Cs,aa).call(this,Rt,...mt.at(-3),...mt.at(-2),e,b)},we=new WeakSet,ia=function(){if(this.currentPath.length===0)return;const e=this.currentPath.at(-1);t(this,Ot).lineTo(...e)},Oe=new WeakSet,na=function(e,b){T(this,le,null),e=Math.min(Math.max(e,0),this.canvas.width),b=Math.min(Math.max(b,0),this.canvas.height),y(this,se,zn).call(this,e,b),y(this,we,ia).call(this);let J;if(this.currentPath.length!==1)J=y(this,Ni,oa).call(this);else{const Ct=[e,b];J=[[Ct,Ct.slice(),Ct.slice(),Ct]]}const Q=t(this,Ot),mt=this.currentPath;this.currentPath=[],T(this,Ot,new Path2D);const Rt=()=>{this.allRawPaths.push(mt),this.paths.push(J),this.bezierPath2D.push(Q),this._uiManager.rebuild(this)},Dt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(y(this,Vs,sn).call(this),y(this,$s,nn).call(this)),y(this,ks,Ti).call(this))};this.addCommands({cmd:Rt,undo:Dt,mustExec:!0})},Bs=new WeakSet,ra=function(){if(!t(this,It))return;T(this,It,!1);const e=Math.ceil(this.thickness*this.parentScale),b=this.currentPath.slice(-3),J=b.map(Rt=>Rt[0]),Q=b.map(Rt=>Rt[1]);Math.min(...J)-e,Math.max(...J)+e,Math.min(...Q)-e,Math.max(...Q)+e;const{ctx:mt}=this;mt.save(),mt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Rt of this.bezierPath2D)mt.stroke(Rt);mt.stroke(t(this,Ot)),mt.restore()},Cs=new WeakSet,aa=function(e,b,J,Q,mt,Rt,Dt){const Ct=(b+Q)/2,Gt=(J+mt)/2,Yt=(Q+Rt)/2,ve=(mt+Dt)/2;e.bezierCurveTo(Ct+2*(Q-Ct)/3,Gt+2*(mt-Gt)/3,Yt+2*(Q-Yt)/3,ve+2*(mt-ve)/3,Yt,ve)},Ni=new WeakSet,oa=function(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const b=[];let J,[Q,mt]=e[0];for(J=1;J<e.length-2;J++){const[Ae,Ce]=e[J],[ke,ze]=e[J+1],Pe=(Ae+ke)/2,$e=(Ce+ze)/2,Be=[Q+2*(Ae-Q)/3,mt+2*(Ce-mt)/3],hs=[Pe+2*(Ae-Pe)/3,$e+2*(Ce-$e)/3];b.push([[Q,mt],Be,hs,[Pe,$e]]),[Q,mt]=[Pe,$e]}const[Rt,Dt]=e[J],[Ct,Gt]=e[J+1],Yt=[Q+2*(Rt-Q)/3,mt+2*(Dt-mt)/3],ve=[Ct+2*(Rt-Ct)/3,Gt+2*(Dt-Gt)/3];return b.push([[Q,mt],Yt,ve,[Ct,Gt]]),b},cs=new WeakSet,Ds=function(){if(this.isEmpty()){y(this,zs,rn).call(this);return}y(this,Nt,$n).call(this);const{canvas:e,ctx:b}=this;b.setTransform(1,0,0,1,0,0),b.clearRect(0,0,e.width,e.height),y(this,zs,rn).call(this);for(const J of this.bezierPath2D)b.stroke(J)},ri=new WeakSet,Un=function(e){this.canvas.removeEventListener("pointerleave",t(this,lt)),this.canvas.removeEventListener("pointermove",t(this,nt)),this.canvas.removeEventListener("pointerup",t(this,vt)),this.canvas.addEventListener("pointerdown",t(this,yt)),t(this,$t)&&clearTimeout(t(this,$t)),T(this,$t,setTimeout(()=>{T(this,$t,null),this.canvas.removeEventListener("contextmenu",W.noContextMenu)},10)),y(this,Oe,na).call(this,e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Vs=new WeakSet,sn=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},$s=new WeakSet,nn=function(){T(this,_t,new ResizeObserver(e=>{const b=e[0].contentRect;b.width&&b.height&&this.setDimensions(b.width,b.height)})),t(this,_t).observe(this.div)},vs=new WeakSet,ni=function(){if(!t(this,Bt))return;const[e,b]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*b),y(this,zs,rn).call(this)},ai=new WeakSet,Gn=function(e,b){const J=y(this,Us,an).call(this),Q=(e-J)/t(this,Y),mt=(b-J)/t(this,m);this.scaleFactor=Math.min(Q,mt)},zs=new WeakSet,rn=function(){const e=y(this,Us,an).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)},Di=new WeakSet,la=function(e){const b=new Path2D;for(let J=0,Q=e.length;J<Q;J++){const[mt,Rt,Dt,Ct]=e[J];J===0&&b.moveTo(...mt),b.bezierCurveTo(Rt[0],Rt[1],Dt[0],Dt[1],Ct[0],Ct[1])}return b},oi=new WeakSet,Xn=function(e,b,J){const[Q,mt,Rt,Dt]=b;switch(J){case 0:for(let Ct=0,Gt=e.length;Ct<Gt;Ct+=2)e[Ct]+=Q,e[Ct+1]=Dt-e[Ct+1];break;case 90:for(let Ct=0,Gt=e.length;Ct<Gt;Ct+=2){const Yt=e[Ct];e[Ct]=e[Ct+1]+Q,e[Ct+1]=Yt+mt}break;case 180:for(let Ct=0,Gt=e.length;Ct<Gt;Ct+=2)e[Ct]=Rt-e[Ct],e[Ct+1]+=mt;break;case 270:for(let Ct=0,Gt=e.length;Ct<Gt;Ct+=2){const Yt=e[Ct];e[Ct]=Rt-e[Ct+1],e[Ct+1]=Dt-Yt}break;default:throw new Error("Invalid rotation")}return e},_i=new WeakSet,ha=function(e,b,J){const[Q,mt,Rt,Dt]=b;switch(J){case 0:for(let Ct=0,Gt=e.length;Ct<Gt;Ct+=2)e[Ct]-=Q,e[Ct+1]=Dt-e[Ct+1];break;case 90:for(let Ct=0,Gt=e.length;Ct<Gt;Ct+=2){const Yt=e[Ct];e[Ct]=e[Ct+1]-mt,e[Ct+1]=Yt-Q}break;case 180:for(let Ct=0,Gt=e.length;Ct<Gt;Ct+=2)e[Ct]=Rt-e[Ct],e[Ct+1]-=mt;break;case 270:for(let Ct=0,Gt=e.length;Ct<Gt;Ct+=2){const Yt=e[Ct];e[Ct]=Dt-e[Ct+1],e[Ct+1]=Rt-Yt}break;default:throw new Error("Invalid rotation")}return e},Oi=new WeakSet,ca=function(e,b,J,Q){var Gt,Yt;const mt=[],Rt=this.thickness/2,Dt=e*b+Rt,Ct=e*J+Rt;for(const ve of this.paths){const Ae=[],Ce=[];for(let ke=0,ze=ve.length;ke<ze;ke++){const[Pe,$e,Be,hs]=ve[ke];if(Pe[0]===hs[0]&&Pe[1]===hs[1]&&ze===1){const Xi=e*Pe[0]+Dt,vi=e*Pe[1]+Ct;Ae.push(Xi,vi),Ce.push(Xi,vi);break}const mi=e*Pe[0]+Dt,bi=e*Pe[1]+Ct,zi=e*$e[0]+Dt,rs=e*$e[1]+Ct,An=e*Be[0]+Dt,yn=e*Be[1]+Ct,Ui=e*hs[0]+Dt,Gi=e*hs[1]+Ct;ke===0&&(Ae.push(mi,bi),Ce.push(mi,bi)),Ae.push(zi,rs,An,yn,Ui,Gi),Ce.push(zi,rs),ke===ze-1&&Ce.push(Ui,Gi)}mt.push({bezier:y(Gt=Ne,oi,Xn).call(Gt,Ae,Q,this.rotation),points:y(Yt=Ne,oi,Xn).call(Yt,Ce,Q,this.rotation)})}return mt},li=new WeakSet,Wn=function(){let e=1/0,b=-1/0,J=1/0,Q=-1/0;for(const mt of this.paths)for(const[Rt,Dt,Ct,Gt]of mt){const Yt=s.Util.bezierBoundingBox(...Rt,...Dt,...Ct,...Gt);e=Math.min(e,Yt[0]),J=Math.min(J,Yt[1]),b=Math.max(b,Yt[2]),Q=Math.max(Q,Yt[3])}return[e,J,b,Q]},Us=new WeakSet,an=function(){return t(this,Et)?Math.ceil(this.thickness*this.parentScale):0},ks=new WeakSet,Ti=function(e=!1){if(this.isEmpty())return;if(!t(this,Et)){y(this,cs,Ds).call(this);return}const b=y(this,li,Wn).call(this),J=y(this,Us,an).call(this);T(this,Y,Math.max(H.AnnotationEditor.MIN_SIZE,b[2]-b[0])),T(this,m,Math.max(H.AnnotationEditor.MIN_SIZE,b[3]-b[1]));const Q=Math.ceil(J+t(this,Y)*this.scaleFactor),mt=Math.ceil(J+t(this,m)*this.scaleFactor),[Rt,Dt]=this.parentDimensions;this.width=Q/Rt,this.height=mt/Dt,this.setAspectRatio(Q,mt);const Ct=this.translationX,Gt=this.translationY;this.translationX=-b[0],this.translationY=-b[1],y(this,vs,ni).call(this),y(this,cs,Ds).call(this),T(this,ne,Q),T(this,Qt,mt),this.setDims(Q,mt);const Yt=e?J/this.scaleFactor/2:0;this.translate(Ct-this.translationX-Yt,Gt-this.translationY-Yt)},o(Ne,Di),o(Ne,oi),o(Ne,_i),be(Ne,"_defaultColor",null),be(Ne,"_defaultOpacity",1),be(Ne,"_defaultThickness",1),be(Ne,"_type","ink"),be(Ne,"_editorType",s.AnnotationEditorType.INK);let g=Ne;const ui=class ui extends H.AnnotationEditor{constructor(e){super({...e,name:"stampEditor"});o(this,Fs);o(this,Ls);o(this,Xs);o(this,ci);o(this,Hi);o(this,Bi);o(this,di);o(this,Ws);o(this,Vi);o(this,Ge,null);o(this,Xe,null);o(this,As,null);o(this,ds,null);o(this,ys,null);o(this,Gs,"");o(this,as,null);o(this,Rs,null);o(this,os,null);o(this,is,!1);o(this,hi,!1);T(this,ds,e.bitmapUrl),T(this,ys,e.bitmapFile)}static initialize(e,b){H.AnnotationEditor.initialize(e,b)}static get supportedTypes(){const e=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,s.shadow)(this,"supportedTypes",e.map(b=>`image/${b}`))}static get supportedTypesStr(){return(0,s.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,b){b.pasteEditor(s.AnnotationEditorType.STAMP,{bitmapFile:e.getAsFile()})}remove(){var e,b;t(this,Xe)&&(T(this,Ge,null),this._uiManager.imageManager.deleteId(t(this,Xe)),(e=t(this,as))==null||e.remove(),T(this,as,null),(b=t(this,Rs))==null||b.disconnect(),T(this,Rs,null),t(this,os)&&(clearTimeout(t(this,os)),T(this,os,null))),super.remove()}rebuild(){if(!this.parent){t(this,Xe)&&y(this,Xs,on).call(this);return}super.rebuild(),this.div!==null&&(t(this,Xe)&&t(this,as)===null&&y(this,Xs,on).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,As)||t(this,Ge)||t(this,ds)||t(this,ys)||t(this,Xe))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,b;if(this.width&&(e=this.x,b=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),t(this,Ge)?y(this,ci,Yn).call(this):y(this,Xs,on).call(this),this.width){const[J,Q]=this.parentDimensions;this.setAt(e*J,b*Q,this.width*J,this.height*Q)}return this.div}getImageForAltText(){return t(this,as)}static deserialize(e,b,J){if(e instanceof X.StampAnnotationElement)return null;const Q=super.deserialize(e,b,J),{rect:mt,bitmapUrl:Rt,bitmapId:Dt,isSvg:Ct,accessibilityData:Gt}=e;Dt&&J.imageManager.isValidId(Dt)?T(Q,Xe,Dt):T(Q,ds,Rt),T(Q,is,Ct);const[Yt,ve]=Q.pageDimensions;return Q.width=(mt[2]-mt[0])/Yt,Q.height=(mt[3]-mt[1])/ve,Gt&&(Q.altTextData=Gt),Q}serialize(e=!1,b=null){if(this.isEmpty())return null;const J={annotationType:s.AnnotationEditorType.STAMP,bitmapId:t(this,Xe),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,is),structTreeParentId:this._structTreeParentId};if(e)return J.bitmapUrl=y(this,Ws,ln).call(this,!0),J.accessibilityData=this.altTextData,J;const{decorative:Q,altText:mt}=this.altTextData;if(!Q&&mt&&(J.accessibilityData={type:"Figure",alt:mt}),b===null)return J;b.stamps||(b.stamps=new Map);const Rt=t(this,is)?(J.rect[2]-J.rect[0])*(J.rect[3]-J.rect[1]):null;if(!b.stamps.has(t(this,Xe)))b.stamps.set(t(this,Xe),{area:Rt,serialized:J}),J.bitmap=y(this,Ws,ln).call(this,!1);else if(t(this,is)){const Dt=b.stamps.get(t(this,Xe));Rt>Dt.area&&(Dt.area=Rt,Dt.serialized.bitmap.close(),Dt.serialized.bitmap=y(this,Ws,ln).call(this,!1))}return J}};Ge=new WeakMap,Xe=new WeakMap,As=new WeakMap,ds=new WeakMap,ys=new WeakMap,Gs=new WeakMap,as=new WeakMap,Rs=new WeakMap,os=new WeakMap,is=new WeakMap,hi=new WeakMap,Fs=new WeakSet,Ci=function(e,b=!1){if(!e){this.remove();return}T(this,Ge,e.bitmap),b||(T(this,Xe,e.id),T(this,is,e.isSvg)),e.file&&T(this,Gs,e.file.name),y(this,ci,Yn).call(this)},Ls=new WeakSet,ki=function(){T(this,As,null),this._uiManager.enableWaiting(!1),t(this,as)&&this.div.focus()},Xs=new WeakSet,on=function(){if(t(this,Xe)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,Xe)).then(b=>y(this,Fs,Ci).call(this,b,!0)).finally(()=>y(this,Ls,ki).call(this));return}if(t(this,ds)){const b=t(this,ds);T(this,ds,null),this._uiManager.enableWaiting(!0),T(this,As,this._uiManager.imageManager.getFromUrl(b).then(J=>y(this,Fs,Ci).call(this,J)).finally(()=>y(this,Ls,ki).call(this)));return}if(t(this,ys)){const b=t(this,ys);T(this,ys,null),this._uiManager.enableWaiting(!0),T(this,As,this._uiManager.imageManager.getFromFile(b).then(J=>y(this,Fs,Ci).call(this,J)).finally(()=>y(this,Ls,ki).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=ui.supportedTypesStr,T(this,As,new Promise(b=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const J=await this._uiManager.imageManager.getFromFile(e.files[0]);y(this,Fs,Ci).call(this,J)}b()}),e.addEventListener("cancel",()=>{this.remove(),b()})}).finally(()=>y(this,Ls,ki).call(this))),e.click()},ci=new WeakSet,Yn=function(){const{div:e}=this;let{width:b,height:J}=t(this,Ge);const[Q,mt]=this.pageDimensions,Rt=.75;if(this.width)b=this.width*Q,J=this.height*mt;else if(b>Rt*Q||J>Rt*mt){const Yt=Math.min(Rt*Q/b,Rt*mt/J);b*=Yt,J*=Yt}const[Dt,Ct]=this.parentDimensions;this.setDims(b*Dt/Q,J*Ct/mt),this._uiManager.enableWaiting(!1);const Gt=T(this,as,document.createElement("canvas"));e.append(Gt),e.hidden=!1,y(this,di,jn).call(this,b,J),y(this,Vi,fa).call(this),t(this,hi)||(this.parent.addUndoableEditor(this),T(this,hi,!0)),this._reportTelemetry({action:"inserted_image"}),t(this,Gs)&&Gt.setAttribute("aria-label",t(this,Gs))},Hi=new WeakSet,da=function(e,b){var Rt;const[J,Q]=this.parentDimensions;this.width=e/J,this.height=b/Q,this.setDims(e,b),(Rt=this._initialOptions)!=null&&Rt.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,os)!==null&&clearTimeout(t(this,os)),T(this,os,setTimeout(()=>{T(this,os,null),y(this,di,jn).call(this,e,b)},200))},Bi=new WeakSet,ua=function(e,b){const{width:J,height:Q}=t(this,Ge);let mt=J,Rt=Q,Dt=t(this,Ge);for(;mt>2*e||Rt>2*b;){const Ct=mt,Gt=Rt;mt>2*e&&(mt=mt>=16384?Math.floor(mt/2)-1:Math.ceil(mt/2)),Rt>2*b&&(Rt=Rt>=16384?Math.floor(Rt/2)-1:Math.ceil(Rt/2));const Yt=new OffscreenCanvas(mt,Rt);Yt.getContext("2d").drawImage(Dt,0,0,Ct,Gt,0,0,mt,Rt),Dt=Yt.transferToImageBitmap()}return Dt},di=new WeakSet,jn=function(e,b){e=Math.ceil(e),b=Math.ceil(b);const J=t(this,as);if(!J||J.width===e&&J.height===b)return;J.width=e,J.height=b;const Q=t(this,is)?t(this,Ge):y(this,Bi,ua).call(this,e,b);if(this._uiManager.hasMLManager&&!this.hasAltText()){const Rt=new OffscreenCanvas(e,b);Rt.getContext("2d").drawImage(Q,0,0,Q.width,Q.height,0,0,e,b),Rt.convertToBlob().then(Ct=>{const Gt=new FileReader;Gt.onload=()=>{const Yt=Gt.result;this._uiManager.mlGuess({service:"image-to-text",request:{imageData:Yt}}).then(ve=>{const Ae=(ve==null?void 0:ve.output)||"";this.parent&&Ae&&!this.hasAltText()&&(this.altTextData={altText:Ae,decorative:!1})})},Gt.readAsDataURL(Ct)})}const mt=J.getContext("2d");mt.filter=this._uiManager.hcmFilter,mt.drawImage(Q,0,0,Q.width,Q.height,0,0,e,b)},Ws=new WeakSet,ln=function(e){if(e){if(t(this,is)){const Q=this._uiManager.imageManager.getSvgUrl(t(this,Xe));if(Q)return Q}const b=document.createElement("canvas");return{width:b.width,height:b.height}=t(this,Ge),b.getContext("2d").drawImage(t(this,Ge),0,0),b.toDataURL()}if(t(this,is)){const[b,J]=this.pageDimensions,Q=Math.round(this.width*b*W.PixelsPerInch.PDF_TO_CSS_UNITS),mt=Math.round(this.height*J*W.PixelsPerInch.PDF_TO_CSS_UNITS),Rt=new OffscreenCanvas(Q,mt);return Rt.getContext("2d").drawImage(t(this,Ge),0,0,t(this,Ge).width,t(this,Ge).height,0,0,Q,mt),Rt.transferToImageBitmap()}return structuredClone(t(this,Ge))},Vi=new WeakSet,fa=function(){T(this,Rs,new ResizeObserver(e=>{const b=e[0].contentRect;b.width&&b.height&&y(this,Hi,da).call(this,b.width,b.height)})),t(this,Rs).observe(this.div)},be(ui,"_type","stamp"),be(ui,"_editorType",s.AnnotationEditorType.STAMP);let P=ui;const ns=class ns{constructor({uiManager:gt,pageIndex:e,div:b,accessibilityManager:J,annotationLayer:Q,drawLayer:mt,textLayer:Rt,viewport:Dt,l10n:Ct}){o(this,$i);o(this,fi);o(this,pi);o(this,gi);o(this,Ks);o(this,Ps,void 0);o(this,Ys,!1);o(this,ls,null);o(this,Ms,null);o(this,us,null);o(this,fs,null);o(this,ps,null);o(this,Ke,new Map);o(this,ws,!1);o(this,js,!1);o(this,qs,!1);o(this,Ye,null);o(this,ue,void 0);const Gt=[...t(ns,Ss).values()];if(!ns._initialized){ns._initialized=!0;for(const Yt of Gt)Yt.initialize(Ct,gt)}gt.registerEditorTypes(Gt),T(this,ue,gt),this.pageIndex=e,this.div=b,T(this,Ps,J),T(this,ls,Q),this.viewport=Dt,T(this,Ye,Rt),this.drawLayer=mt,t(this,ue).addLayer(this)}get isEmpty(){return t(this,Ke).size===0}get isInvisible(){return this.isEmpty&&t(this,ue).getMode()===s.AnnotationEditorType.NONE}updateToolbar(gt){t(this,ue).updateToolbar(gt)}updateMode(gt=t(this,ue).getMode()){switch(y(this,Ks,hn).call(this),gt){case s.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case s.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case s.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const b of t(ns,Ss).values())e.toggle(`${b._type}Editing`,gt===b._editorType);this.div.hidden=!1}hasTextLayer(gt){var e;return gt===((e=t(this,Ye))==null?void 0:e.div)}addInkEditorIfNeeded(gt){if(t(this,ue).getMode()!==s.AnnotationEditorType.INK)return;if(!gt){for(const b of t(this,Ke).values())if(b.isEmpty()){b.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(gt){t(this,ue).setEditingState(gt)}addCommands(gt){t(this,ue).addCommands(gt)}togglePointerEvents(gt=!1){this.div.classList.toggle("disabled",!gt)}toggleAnnotationLayerPointerEvents(gt=!1){var e;(e=t(this,ls))==null||e.div.classList.toggle("disabled",!gt)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const gt=new Set;for(const b of t(this,Ke).values())b.enableEditing(),b.show(!0),b.annotationElementId&&(t(this,ue).removeChangedExistingAnnotation(b),gt.add(b.annotationElementId));if(!t(this,ls))return;const e=t(this,ls).getEditableAnnotations();for(const b of e){if(b.hide(),t(this,ue).isDeletedAnnotationElement(b.data.id)||gt.has(b.data.id))continue;const J=this.deserialize(b);J&&(this.addOrRebuild(J),J.enableEditing())}}disable(){var J;T(this,qs,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const gt=new Map,e=new Map;for(const Q of t(this,Ke).values())if(Q.disableEditing(),!!Q.annotationElementId){if(Q.serialize()!==null){gt.set(Q.annotationElementId,Q);continue}else e.set(Q.annotationElementId,Q);(J=this.getEditableAnnotation(Q.annotationElementId))==null||J.show(),Q.remove()}if(t(this,ls)){const Q=t(this,ls).getEditableAnnotations();for(const mt of Q){const{id:Rt}=mt.data;if(t(this,ue).isDeletedAnnotationElement(Rt))continue;let Dt=e.get(Rt);if(Dt){Dt.resetAnnotationElement(mt),Dt.show(!1),mt.show();continue}Dt=gt.get(Rt),Dt&&(t(this,ue).addChangedExistingAnnotation(Dt),Dt.renderAnnotationElement(mt),Dt.show(!1)),mt.show()}}y(this,Ks,hn).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:b}=this.div;for(const Q of t(ns,Ss).values())b.remove(`${Q._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),T(this,qs,!1)}getEditableAnnotation(gt){var e;return((e=t(this,ls))==null?void 0:e.getEditableAnnotation(gt))||null}setActiveEditor(gt){t(this,ue).getActive()!==gt&&t(this,ue).setActiveEditor(gt)}enableTextSelection(){var gt;this.div.tabIndex=-1,(gt=t(this,Ye))!=null&&gt.div&&!t(this,fs)&&(T(this,fs,y(this,$i,pa).bind(this)),t(this,Ye).div.addEventListener("pointerdown",t(this,fs)),t(this,Ye).div.classList.add("highlighting"))}disableTextSelection(){var gt;this.div.tabIndex=0,(gt=t(this,Ye))!=null&&gt.div&&t(this,fs)&&(t(this,Ye).div.removeEventListener("pointerdown",t(this,fs)),T(this,fs,null),t(this,Ye).div.classList.remove("highlighting"))}enableClick(){t(this,us)||(T(this,us,this.pointerdown.bind(this)),T(this,Ms,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",t(this,us)),this.div.addEventListener("pointerup",t(this,Ms)))}disableClick(){t(this,us)&&(this.div.removeEventListener("pointerdown",t(this,us)),this.div.removeEventListener("pointerup",t(this,Ms)),T(this,us,null),T(this,Ms,null))}attach(gt){t(this,Ke).set(gt.id,gt);const{annotationElementId:e}=gt;e&&t(this,ue).isDeletedAnnotationElement(e)&&t(this,ue).removeDeletedAnnotationElement(gt)}detach(gt){var e;t(this,Ke).delete(gt.id),(e=t(this,Ps))==null||e.removePointerInTextLayer(gt.contentDiv),!t(this,qs)&&gt.annotationElementId&&t(this,ue).addDeletedAnnotationElement(gt)}remove(gt){this.detach(gt),t(this,ue).removeEditor(gt),gt.div.remove(),gt.isAttachedToDOM=!1,t(this,js)||this.addInkEditorIfNeeded(!1)}changeParent(gt){var e;gt.parent!==this&&(gt.parent&&gt.annotationElementId&&(t(this,ue).addDeletedAnnotationElement(gt.annotationElementId),H.AnnotationEditor.deleteAnnotationElement(gt),gt.annotationElementId=null),this.attach(gt),(e=gt.parent)==null||e.detach(gt),gt.setParent(this),gt.div&&gt.isAttachedToDOM&&(gt.div.remove(),this.div.append(gt.div)))}add(gt){if(!(gt.parent===this&&gt.isAttachedToDOM)){if(this.changeParent(gt),t(this,ue).addEditor(gt),this.attach(gt),!gt.isAttachedToDOM){const e=gt.render();this.div.append(e),gt.isAttachedToDOM=!0}gt.fixAndSetPosition(),gt.onceAdded(),t(this,ue).addToAnnotationStorage(gt),gt._reportTelemetry(gt.telemetryInitialData)}}moveEditorInDOM(gt){var b;if(!gt.isAttachedToDOM)return;const{activeElement:e}=document;gt.div.contains(e)&&!t(this,ps)&&(gt._focusEventsAllowed=!1,T(this,ps,setTimeout(()=>{T(this,ps,null),gt.div.contains(document.activeElement)?gt._focusEventsAllowed=!0:(gt.div.addEventListener("focusin",()=>{gt._focusEventsAllowed=!0},{once:!0}),e.focus())},0))),gt._structTreeParentId=(b=t(this,Ps))==null?void 0:b.moveElementInDOM(this.div,gt.div,gt.contentDiv,!0)}addOrRebuild(gt){gt.needsToBeRebuilt()?(gt.parent||(gt.parent=this),gt.rebuild(),gt.show()):this.add(gt)}addUndoableEditor(gt){const e=()=>gt._uiManager.rebuild(gt),b=()=>{gt.remove()};this.addCommands({cmd:e,undo:b,mustExec:!1})}getNextId(){return t(this,ue).getId()}canCreateNewEmptyEditor(){var gt;return(gt=t(this,fi,qn))==null?void 0:gt.canCreateNewEmptyEditor()}pasteEditor(gt,e){t(this,ue).updateToolbar(gt),t(this,ue).updateMode(gt);const{offsetX:b,offsetY:J}=y(this,gi,Jn).call(this),Q=this.getNextId(),mt=y(this,pi,Kn).call(this,{parent:this,id:Q,x:b,y:J,uiManager:t(this,ue),isCentered:!0,...e});mt&&this.add(mt)}deserialize(gt){var e;return((e=t(ns,Ss).get(gt.annotationType??gt.annotationEditorType))==null?void 0:e.deserialize(gt,this,t(this,ue)))||null}createAndAddNewEditor(gt,e,b={}){const J=this.getNextId(),Q=y(this,pi,Kn).call(this,{parent:this,id:J,x:gt.offsetX,y:gt.offsetY,uiManager:t(this,ue),isCentered:e,...b});return Q&&this.add(Q),Q}addNewEditor(){this.createAndAddNewEditor(y(this,gi,Jn).call(this),!0)}setSelected(gt){t(this,ue).setSelected(gt)}toggleSelected(gt){t(this,ue).toggleSelected(gt)}isSelected(gt){return t(this,ue).isSelected(gt)}unselect(gt){t(this,ue).unselect(gt)}pointerup(gt){const{isMac:e}=s.FeatureTest.platform;if(!(gt.button!==0||gt.ctrlKey&&e)&&gt.target===this.div&&t(this,ws)){if(T(this,ws,!1),!t(this,Ys)){T(this,Ys,!0);return}if(t(this,ue).getMode()===s.AnnotationEditorType.STAMP){t(this,ue).unselectAll();return}this.createAndAddNewEditor(gt,!1)}}pointerdown(gt){if(t(this,ue).getMode()===s.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),t(this,ws)){T(this,ws,!1);return}const{isMac:e}=s.FeatureTest.platform;if(gt.button!==0||gt.ctrlKey&&e||gt.target!==this.div)return;T(this,ws,!0);const b=t(this,ue).getActive();T(this,Ys,!b||b.isEmpty())}findNewParent(gt,e,b){const J=t(this,ue).findParent(e,b);return J===null||J===this?!1:(J.changeParent(gt),!0)}destroy(){var gt,e;((gt=t(this,ue).getActive())==null?void 0:gt.parent)===this&&(t(this,ue).commitOrRemove(),t(this,ue).setActiveEditor(null)),t(this,ps)&&(clearTimeout(t(this,ps)),T(this,ps,null));for(const b of t(this,Ke).values())(e=t(this,Ps))==null||e.removePointerInTextLayer(b.contentDiv),b.setParent(null),b.isAttachedToDOM=!1,b.div.remove();this.div=null,t(this,Ke).clear(),t(this,ue).removeLayer(this)}render({viewport:gt}){this.viewport=gt,(0,W.setLayerDimensions)(this.div,gt);for(const e of t(this,ue).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:gt}){t(this,ue).commitOrRemove(),y(this,Ks,hn).call(this);const e=this.viewport.rotation,b=gt.rotation;if(this.viewport=gt,(0,W.setLayerDimensions)(this.div,{rotation:b}),e!==b)for(const J of t(this,Ke).values())J.rotate(b);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:gt,pageHeight:e}=this.viewport.rawDims;return[gt,e]}get scale(){return t(this,ue).viewParameters.realScale}};Ps=new WeakMap,Ys=new WeakMap,ls=new WeakMap,Ms=new WeakMap,us=new WeakMap,fs=new WeakMap,ps=new WeakMap,Ke=new WeakMap,ws=new WeakMap,js=new WeakMap,qs=new WeakMap,Ye=new WeakMap,ue=new WeakMap,Ss=new WeakMap,$i=new WeakSet,pa=function(gt){if(t(this,ue).unselectAll(),gt.target===t(this,Ye).div){const{isMac:e}=s.FeatureTest.platform;if(gt.button!==0||gt.ctrlKey&&e)return;t(this,ue).showAllEditors("highlight",!0,!0),t(this,Ye).div.classList.add("free"),x.startHighlighting(this,t(this,ue).direction==="ltr",gt),t(this,Ye).div.addEventListener("pointerup",()=>{t(this,Ye).div.classList.remove("free")},{once:!0}),gt.preventDefault()}},fi=new WeakSet,qn=function(){return t(ns,Ss).get(t(this,ue).getMode())},pi=new WeakSet,Kn=function(gt){const e=t(this,fi,qn);return e?new e.prototype.constructor(gt):null},gi=new WeakSet,Jn=function(){const{x:gt,y:e,width:b,height:J}=this.div.getBoundingClientRect(),Q=Math.max(0,gt),mt=Math.max(0,e),Rt=Math.min(window.innerWidth,gt+b),Dt=Math.min(window.innerHeight,e+J),Ct=(Q+Rt)/2-gt,Gt=(mt+Dt)/2-e,[Yt,ve]=this.viewport.rotation%180===0?[Ct,Gt]:[Gt,Ct];return{offsetX:Yt,offsetY:ve}},Ks=new WeakSet,hn=function(){T(this,js,!0);for(const gt of t(this,Ke).values())gt.isEmpty()&&gt.remove();T(this,js,!1)},be(ns,"_initialized",!1),o(ns,Ss,new Map([V,g,P,x].map(gt=>[gt._editorType,gt])));let R=ns},259:(st,ot,k)=>{var rt,V,I,M,W,x,g,P,R,z,ct,tt,N,Qn,D,Zn,U,ga,pt,_s,Tt,ma,Pt,xs;k.d(ot,{ColorPicker:()=>X});var s=k(292),H=k(830),w=k(419);const Wt=class Wt{constructor({editor:at=null,uiManager:kt=null}){o(this,N);o(this,D);o(this,U);o(this,pt);o(this,Tt);o(this,Pt);o(this,rt,y(this,U,ga).bind(this));o(this,V,y(this,Tt,ma).bind(this));o(this,I,null);o(this,M,null);o(this,W,void 0);o(this,x,null);o(this,g,!1);o(this,P,!1);o(this,R,null);o(this,z,void 0);o(this,ct,null);o(this,tt,void 0);var Xt;at?(T(this,P,!1),T(this,tt,s.AnnotationEditorParamsType.HIGHLIGHT_COLOR),T(this,R,at)):(T(this,P,!0),T(this,tt,s.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR)),T(this,ct,(at==null?void 0:at._uiManager)||kt),T(this,z,t(this,ct)._eventBus),T(this,W,(at==null?void 0:at.color)||((Xt=t(this,ct))==null?void 0:Xt.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return(0,s.shadow)(this,"_keyboardManager",new H.KeyboardManager([[["Escape","mac+Escape"],Wt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Wt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Wt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Wt.prototype._moveToPrevious],[["Home","mac+Home"],Wt.prototype._moveToBeginning],[["End","mac+End"],Wt.prototype._moveToEnd]]))}renderButton(){const at=T(this,I,document.createElement("button"));at.className="colorPicker",at.tabIndex="0",at.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),at.setAttribute("aria-haspopup",!0),at.addEventListener("click",y(this,pt,_s).bind(this)),at.addEventListener("keydown",t(this,rt));const kt=T(this,M,document.createElement("span"));return kt.className="swatch",kt.setAttribute("aria-hidden",!0),kt.style.backgroundColor=t(this,W),at.append(kt),at}renderMainDropdown(){const at=T(this,x,y(this,N,Qn).call(this));return at.setAttribute("aria-orientation","horizontal"),at.setAttribute("aria-labelledby","highlightColorPickerLabel"),at}_colorSelectFromKeyboard(at){if(at.target===t(this,I)){y(this,pt,_s).call(this,at);return}const kt=at.target.getAttribute("data-color");kt&&y(this,D,Zn).call(this,kt,at)}_moveToNext(at){var kt,Xt;if(!t(this,Pt,xs)){y(this,pt,_s).call(this,at);return}if(at.target===t(this,I)){(kt=t(this,x).firstChild)==null||kt.focus();return}(Xt=at.target.nextSibling)==null||Xt.focus()}_moveToPrevious(at){var kt,Xt;if(at.target===((kt=t(this,x))==null?void 0:kt.firstChild)||at.target===t(this,I)){t(this,Pt,xs)&&this._hideDropdownFromKeyboard();return}t(this,Pt,xs)||y(this,pt,_s).call(this,at),(Xt=at.target.previousSibling)==null||Xt.focus()}_moveToBeginning(at){var kt;if(!t(this,Pt,xs)){y(this,pt,_s).call(this,at);return}(kt=t(this,x).firstChild)==null||kt.focus()}_moveToEnd(at){var kt;if(!t(this,Pt,xs)){y(this,pt,_s).call(this,at);return}(kt=t(this,x).lastChild)==null||kt.focus()}hideDropdown(){var at;(at=t(this,x))==null||at.classList.add("hidden"),window.removeEventListener("pointerdown",t(this,V))}_hideDropdownFromKeyboard(){var at;if(!t(this,P)){if(!t(this,Pt,xs)){(at=t(this,R))==null||at.unselect();return}this.hideDropdown(),t(this,I).focus({preventScroll:!0,focusVisible:t(this,g)})}}updateColor(at){if(t(this,M)&&(t(this,M).style.backgroundColor=at),!t(this,x))return;const kt=t(this,ct).highlightColors.values();for(const Xt of t(this,x).children)Xt.setAttribute("aria-selected",kt.next().value===at)}destroy(){var at,kt;(at=t(this,I))==null||at.remove(),T(this,I,null),T(this,M,null),(kt=t(this,x))==null||kt.remove(),T(this,x,null)}};rt=new WeakMap,V=new WeakMap,I=new WeakMap,M=new WeakMap,W=new WeakMap,x=new WeakMap,g=new WeakMap,P=new WeakMap,R=new WeakMap,z=new WeakMap,ct=new WeakMap,tt=new WeakMap,N=new WeakSet,Qn=function(){const at=document.createElement("div");at.addEventListener("contextmenu",w.noContextMenu),at.className="dropdown",at.role="listbox",at.setAttribute("aria-multiselectable",!1),at.setAttribute("aria-orientation","vertical"),at.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[kt,Xt]of t(this,ct).highlightColors){const zt=document.createElement("button");zt.tabIndex="0",zt.role="option",zt.setAttribute("data-color",Xt),zt.title=kt,zt.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${kt}`);const ie=document.createElement("span");zt.append(ie),ie.className="swatch",ie.style.backgroundColor=Xt,zt.setAttribute("aria-selected",Xt===t(this,W)),zt.addEventListener("click",y(this,D,Zn).bind(this,Xt)),at.append(zt)}return at.addEventListener("keydown",t(this,rt)),at},D=new WeakSet,Zn=function(at,kt){kt.stopPropagation(),t(this,z).dispatch("switchannotationeditorparams",{source:this,type:t(this,tt),value:at})},U=new WeakSet,ga=function(at){Wt._keyboardManager.exec(this,at)},pt=new WeakSet,_s=function(at){if(t(this,Pt,xs)){this.hideDropdown();return}if(T(this,g,at.detail===0),window.addEventListener("pointerdown",t(this,V)),t(this,x)){t(this,x).classList.remove("hidden");return}const kt=T(this,x,y(this,N,Qn).call(this));t(this,I).append(kt)},Tt=new WeakSet,ma=function(at){var kt;(kt=t(this,x))!=null&&kt.contains(at.target)||this.hideDropdown()},Pt=new WeakSet,xs=function(){return t(this,x)&&!t(this,x).classList.contains("hidden")};let X=Wt},310:(st,ot,k)=>{var M,W,x,g,P,R,z,ct,tr,B,D,_,U,G,pt,Mt,Tt,Ft,Pt,Vt,Wt,qt,at,kt,Xt,zt,ie,oe,he,xe,Me,er,pe,sr,ae,ir,Zt,ba,ee,va,i,nr,r,rr,l,ar,f,Aa,A,ya,a,wa,F,Sa,it,or,ut,Ri;k.d(ot,{AnnotationEditor:()=>V});var s=k(830),H=k(292),w=k(419);const N=class N{constructor(E){o(this,ct);o(this,M,"");o(this,W,!1);o(this,x,null);o(this,g,null);o(this,P,null);o(this,R,!1);o(this,z,null);T(this,z,E)}static initialize(E){N._l10nPromise||(N._l10nPromise=E)}async render(){const E=T(this,x,document.createElement("button"));E.className="altText";const O=await N._l10nPromise.get("pdfjs-editor-alt-text-button-label");E.textContent=O,E.setAttribute("aria-label",O),E.tabIndex="0",E.addEventListener("contextmenu",w.noContextMenu),E.addEventListener("pointerdown",q=>q.stopPropagation());const Z=q=>{q.preventDefault(),t(this,z)._uiManager.editAltText(t(this,z))};return E.addEventListener("click",Z,{capture:!0}),E.addEventListener("keydown",q=>{q.target===E&&q.key==="Enter"&&(T(this,R,!0),Z(q))}),await y(this,ct,tr).call(this),E}finish(){t(this,x)&&(t(this,x).focus({focusVisible:t(this,R)}),T(this,R,!1))}isEmpty(){return!t(this,M)&&!t(this,W)}get data(){return{altText:t(this,M),decorative:t(this,W)}}set data({altText:E,decorative:O}){t(this,M)===E&&t(this,W)===O||(T(this,M,E),T(this,W,O),y(this,ct,tr).call(this))}toggle(E=!1){t(this,x)&&(!E&&t(this,P)&&(clearTimeout(t(this,P)),T(this,P,null)),t(this,x).disabled=!E)}destroy(){var E;(E=t(this,x))==null||E.remove(),T(this,x,null),T(this,g,null)}};M=new WeakMap,W=new WeakMap,x=new WeakMap,g=new WeakMap,P=new WeakMap,R=new WeakMap,z=new WeakMap,ct=new WeakSet,tr=async function(){var q;const E=t(this,x);if(!E)return;if(!t(this,M)&&!t(this,W)){E.classList.remove("done"),(q=t(this,g))==null||q.remove();return}E.classList.add("done"),N._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(St=>{E.setAttribute("aria-label",St)});let O=t(this,g);if(!O){T(this,g,O=document.createElement("span")),O.className="tooltip",O.setAttribute("role","tooltip");const St=O.id=`alt-text-tooltip-${t(this,z).id}`;E.setAttribute("aria-describedby",St);const et=100;E.addEventListener("mouseenter",()=>{T(this,P,setTimeout(()=>{T(this,P,null),t(this,g).classList.add("show"),t(this,z)._reportTelemetry({action:"alt_text_tooltip"})},et))}),E.addEventListener("mouseleave",()=>{var S;t(this,P)&&(clearTimeout(t(this,P)),T(this,P,null)),(S=t(this,g))==null||S.classList.remove("show")})}O.innerText=t(this,W)?await N._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):t(this,M),O.parentNode||E.append(O);const Z=t(this,z).getImageForAltText();Z==null||Z.setAttribute("aria-describedby",O.id)},be(N,"_l10nPromise",null);let X=N;var rt=k(362);const bt=class bt{constructor(E){o(this,Me);o(this,ae);o(this,Zt);o(this,ee);o(this,i);o(this,r);o(this,l);o(this,f);o(this,A);o(this,a);o(this,F);o(this,it);o(this,ut);o(this,B,null);o(this,D,null);o(this,_,!1);o(this,U,!1);o(this,G,null);o(this,pt,null);o(this,Mt,this.focusin.bind(this));o(this,Tt,this.focusout.bind(this));o(this,Ft,null);o(this,Pt,"");o(this,Vt,!1);o(this,Wt,null);o(this,qt,!1);o(this,at,!1);o(this,kt,!1);o(this,Xt,null);o(this,zt,0);o(this,ie,0);o(this,oe,null);be(this,"_initialOptions",Object.create(null));be(this,"_isVisible",!0);be(this,"_uiManager",null);be(this,"_focusEventsAllowed",!0);be(this,"_l10nPromise",null);o(this,he,!1);o(this,xe,bt._zIndex++);this.constructor===bt&&(0,H.unreachable)("Cannot initialize AnnotationEditor."),this.parent=E.parent,this.id=E.id,this.width=this.height=null,this.pageIndex=E.parent.pageIndex,this.name=E.name,this.div=null,this._uiManager=E.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=E.isCentered,this._structTreeParentId=null;const{rotation:O,rawDims:{pageWidth:Z,pageHeight:q,pageX:St,pageY:et}}=this.parent.viewport;this.rotation=O,this.pageRotation=(360+O-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Z,q],this.pageTranslation=[St,et];const[S,$]=this.parentDimensions;this.x=E.x/S,this.y=E.y/$,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const E=bt.prototype._resizeWithKeyboard,O=s.AnnotationEditorUIManager.TRANSLATE_SMALL,Z=s.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,H.shadow)(this,"_resizerKeyboardManager",new s.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],E,{args:[-O,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],E,{args:[-Z,0]}],[["ArrowRight","mac+ArrowRight"],E,{args:[O,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],E,{args:[Z,0]}],[["ArrowUp","mac+ArrowUp"],E,{args:[0,-O]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],E,{args:[0,-Z]}],[["ArrowDown","mac+ArrowDown"],E,{args:[0,O]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],E,{args:[0,Z]}],[["Escape","mac+Escape"],bt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,H.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(E){const O=new I({id:E.parent.getNextId(),parent:E.parent,uiManager:E._uiManager});O.annotationElementId=E.annotationElementId,O.deleted=!0,O._uiManager.addToAnnotationStorage(O)}static initialize(E,O,Z){if(bt._l10nPromise||(bt._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(St=>[St,E.get(St.replaceAll(/([A-Z])/g,et=>`-${et.toLowerCase()}`))]))),Z!=null&&Z.strings)for(const St of Z.strings)bt._l10nPromise.set(St,E.get(St));if(bt._borderLineWidth!==-1)return;const q=getComputedStyle(document.documentElement);bt._borderLineWidth=parseFloat(q.getPropertyValue("--outline-width"))||0}static updateDefaultParams(E,O){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(E){return!1}static paste(E,O){(0,H.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,he)}set _isDraggable(E){var O;T(this,he,E),(O=this.div)==null||O.classList.toggle("draggable",E)}get isEnterHandled(){return!0}center(){const[E,O]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*O/(E*2),this.y+=this.width*E/(O*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*O/(E*2),this.y-=this.width*E/(O*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(E){this._uiManager.addCommands(E)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,xe)}setParent(E){E!==null?(this.pageIndex=E.pageIndex,this.pageDimensions=E.pageDimensions):y(this,ut,Ri).call(this),this.parent=E}focusin(E){this._focusEventsAllowed&&(t(this,Vt)?T(this,Vt,!1):this.parent.setSelected(this))}focusout(E){var Z;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const O=E.relatedTarget;O!=null&&O.closest(`#${this.id}`)||(E.preventDefault(),(Z=this.parent)!=null&&Z.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(E,O,Z,q){const[St,et]=this.parentDimensions;[Z,q]=this.screenToPageTranslation(Z,q),this.x=(E+Z)/St,this.y=(O+q)/et,this.fixAndSetPosition()}translate(E,O){y(this,Me,er).call(this,this.parentDimensions,E,O)}translateInPage(E,O){t(this,Wt)||T(this,Wt,[this.x,this.y]),y(this,Me,er).call(this,this.pageDimensions,E,O),this.div.scrollIntoView({block:"nearest"})}drag(E,O){t(this,Wt)||T(this,Wt,[this.x,this.y]);const[Z,q]=this.parentDimensions;if(this.x+=E/Z,this.y+=O/q,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:j,y:ht}=this.div.getBoundingClientRect();this.parent.findNewParent(this,j,ht)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:St,y:et}=this;const[S,$]=this.getBaseTranslation();St+=S,et+=$,this.div.style.left=`${(100*St).toFixed(2)}%`,this.div.style.top=`${(100*et).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!t(this,Wt)&&(t(this,Wt)[0]!==this.x||t(this,Wt)[1]!==this.y)}getBaseTranslation(){const[E,O]=this.parentDimensions,{_borderLineWidth:Z}=bt,q=Z/E,St=Z/O;switch(this.rotation){case 90:return[-q,St];case 180:return[q,St];case 270:return[q,-St];default:return[-q,-St]}}get _mustFixPosition(){return!0}fixAndSetPosition(E=this.rotation){const[O,Z]=this.pageDimensions;let{x:q,y:St,width:et,height:S}=this;if(et*=O,S*=Z,q*=O,St*=Z,this._mustFixPosition)switch(E){case 0:q=Math.max(0,Math.min(O-et,q)),St=Math.max(0,Math.min(Z-S,St));break;case 90:q=Math.max(0,Math.min(O-S,q)),St=Math.min(Z,Math.max(et,St));break;case 180:q=Math.min(O,Math.max(et,q)),St=Math.min(Z,Math.max(S,St));break;case 270:q=Math.min(O,Math.max(S,q)),St=Math.max(0,Math.min(Z-et,St));break}this.x=q/=O,this.y=St/=Z;const[$,j]=this.getBaseTranslation();q+=$,St+=j;const{style:ht}=this.div;ht.left=`${(100*q).toFixed(2)}%`,ht.top=`${(100*St).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(E,O){var Z;return y(Z=bt,pe,sr).call(Z,E,O,this.parentRotation)}pageTranslationToScreen(E,O){var Z;return y(Z=bt,pe,sr).call(Z,E,O,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:E,pageDimensions:[O,Z]}=this,q=O*E,St=Z*E;return H.FeatureTest.isCSSRoundSupported?[Math.round(q),Math.round(St)]:[q,St]}setDims(E,O){const[Z,q]=this.parentDimensions;this.div.style.width=`${(100*E/Z).toFixed(2)}%`,t(this,U)||(this.div.style.height=`${(100*O/q).toFixed(2)}%`)}fixDims(){const{style:E}=this.div,{height:O,width:Z}=E,q=Z.endsWith("%"),St=!t(this,U)&&O.endsWith("%");if(q&&St)return;const[et,S]=this.parentDimensions;q||(E.width=`${(100*parseFloat(Z)/et).toFixed(2)}%`),!t(this,U)&&!St&&(E.height=`${(100*parseFloat(O)/S).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var E;(E=t(this,D))==null||E.finish()}async addEditToolbar(){return t(this,Ft)||t(this,at)?t(this,Ft):(T(this,Ft,new rt.EditorToolbar(this)),this.div.append(t(this,Ft).render()),t(this,D)&&t(this,Ft).addAltTextButton(await t(this,D).render()),t(this,Ft))}removeEditToolbar(){var E;t(this,Ft)&&(t(this,Ft).remove(),T(this,Ft,null),(E=t(this,D))==null||E.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){t(this,D)||(X.initialize(bt._l10nPromise),T(this,D,new X(this)),await this.addEditToolbar())}get altTextData(){var E;return(E=t(this,D))==null?void 0:E.data}set altTextData(E){t(this,D)&&(t(this,D).data=E)}hasAltText(){var E;return!((E=t(this,D))!=null&&E.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=t(this,_)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",t(this,Mt)),this.div.addEventListener("focusout",t(this,Tt));const[E,O]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*O/E).toFixed(2)}%`,this.div.style.maxHeight=`${(100*E/O).toFixed(2)}%`);const[Z,q]=this.getInitialTranslation();return this.translate(Z,q),(0,s.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(E){const{isMac:O}=H.FeatureTest.platform;if(E.button!==0||E.ctrlKey&&O){E.preventDefault();return}if(T(this,Vt,!0),this._isDraggable){y(this,f,Aa).call(this,E);return}y(this,l,ar).call(this,E)}moveInDOM(){t(this,Xt)&&clearTimeout(t(this,Xt)),T(this,Xt,setTimeout(()=>{var E;T(this,Xt,null),(E=this.parent)==null||E.moveEditorInDOM(this)},0))}_setParentAndPosition(E,O,Z){E.changeParent(this),this.x=O,this.y=Z,this.fixAndSetPosition()}getRect(E,O,Z=this.rotation){const q=this.parentScale,[St,et]=this.pageDimensions,[S,$]=this.pageTranslation,j=E/q,ht=O/q,xt=this.x*St,Lt=this.y*et,jt=this.width*St,Kt=this.height*et;switch(Z){case 0:return[xt+j+S,et-Lt-ht-Kt+$,xt+j+jt+S,et-Lt-ht+$];case 90:return[xt+ht+S,et-Lt+j+$,xt+ht+Kt+S,et-Lt+j+jt+$];case 180:return[xt-j-jt+S,et-Lt+ht+$,xt-j+S,et-Lt+ht+Kt+$];case 270:return[xt-ht-Kt+S,et-Lt-j-jt+$,xt-ht+S,et-Lt-j+$];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(E,O){const[Z,q,St,et]=E,S=St-Z,$=et-q;switch(this.rotation){case 0:return[Z,O-et,S,$];case 90:return[Z,O-q,$,S];case 180:return[St,O-q,S,$];case 270:return[St,O-et,$,S];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){T(this,at,!0)}disableEditMode(){T(this,at,!1)}isInEditMode(){return t(this,at)}shouldGetKeyboardEvents(){return t(this,kt)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var E,O;(E=this.div)==null||E.addEventListener("focusin",t(this,Mt)),(O=this.div)==null||O.addEventListener("focusout",t(this,Tt))}rotate(E){}serialize(E=!1,O=null){(0,H.unreachable)("An editor must be serializable")}static deserialize(E,O,Z){const q=new this.prototype.constructor({parent:O,id:O.getNextId(),uiManager:Z});q.rotation=E.rotation;const[St,et]=q.pageDimensions,[S,$,j,ht]=q.getRectInCurrentCoords(E.rect,et);return q.x=S/St,q.y=$/et,q.width=j/St,q.height=ht/et,q}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.div.removeEventListener("focusin",t(this,Mt)),this.div.removeEventListener("focusout",t(this,Tt)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),t(this,Xt)&&(clearTimeout(t(this,Xt)),T(this,Xt,null)),y(this,ut,Ri).call(this),this.removeEditToolbar(),t(this,oe)){for(const E of t(this,oe).values())clearTimeout(E);T(this,oe,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(y(this,Zt,ba).call(this),t(this,G).classList.remove("hidden"),(0,s.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(E){if(!this.isResizable||E.target!==this.div||E.key!=="Enter")return;this._uiManager.setSelected(this),T(this,pt,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const O=t(this,G).children;if(!t(this,B)){T(this,B,Array.from(O));const et=y(this,A,ya).bind(this),S=y(this,a,wa).bind(this);for(const $ of t(this,B)){const j=$.getAttribute("data-resizer-name");$.setAttribute("role","spinbutton"),$.addEventListener("keydown",et),$.addEventListener("blur",S),$.addEventListener("focus",y(this,F,Sa).bind(this,j)),bt._l10nPromise.get(`pdfjs-editor-resizer-label-${j}`).then(ht=>$.setAttribute("aria-label",ht))}}const Z=t(this,B)[0];let q=0;for(const et of O){if(et===Z)break;q++}const St=(360-this.rotation+this.parentRotation)%360/90*(t(this,B).length/4);if(St!==q){if(St<q)for(let S=0;S<q-St;S++)t(this,G).append(t(this,G).firstChild);else if(St>q)for(let S=0;S<St-q;S++)t(this,G).firstChild.before(t(this,G).lastChild);let et=0;for(const S of O){const j=t(this,B)[et++].getAttribute("data-resizer-name");bt._l10nPromise.get(`pdfjs-editor-resizer-label-${j}`).then(ht=>S.setAttribute("aria-label",ht))}}y(this,it,or).call(this,0),T(this,kt,!0),t(this,G).firstChild.focus({focusVisible:!0}),E.preventDefault(),E.stopImmediatePropagation()}_resizeWithKeyboard(E,O){t(this,kt)&&y(this,r,rr).call(this,t(this,Pt),{movementX:E,movementY:O})}_stopResizingWithKeyboard(){y(this,ut,Ri).call(this),this.div.focus()}select(){var E,O;if(this.makeResizable(),(E=this.div)==null||E.classList.add("selectedEditor"),!t(this,Ft)){this.addEditToolbar().then(()=>{var Z,q;(Z=this.div)!=null&&Z.classList.contains("selectedEditor")&&((q=t(this,Ft))==null||q.show())});return}(O=t(this,Ft))==null||O.show()}unselect(){var E,O,Z,q;(E=t(this,G))==null||E.classList.add("hidden"),(O=this.div)==null||O.classList.remove("selectedEditor"),(Z=this.div)!=null&&Z.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(q=t(this,Ft))==null||q.hide()}updateParams(E,O){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return t(this,qt)}set isEditing(E){T(this,qt,E),this.parent&&(E?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(E,O){T(this,U,!0);const Z=E/O,{style:q}=this.div;q.aspectRatio=Z,q.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(E,O=!1){if(O){t(this,oe)||T(this,oe,new Map);const{action:Z}=E;let q=t(this,oe).get(Z);q&&clearTimeout(q),q=setTimeout(()=>{this._reportTelemetry(E),t(this,oe).delete(Z),t(this,oe).size===0&&T(this,oe,null)},bt._telemetryTimeout),t(this,oe).set(Z,q);return}E.type||(E.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:E}})}show(E=this._isVisible){this.div.classList.toggle("hidden",!E),this._isVisible=E}enable(){this.div&&(this.div.tabIndex=0),T(this,_,!1)}disable(){this.div&&(this.div.tabIndex=-1),T(this,_,!0)}renderAnnotationElement(E){let O=E.container.querySelector(".annotationContent");if(!O)O=document.createElement("div"),O.classList.add("annotationContent",this.editorType),E.container.prepend(O);else if(O.nodeName==="CANVAS"){const Z=O;O=document.createElement("div"),O.classList.add("annotationContent",this.editorType),Z.before(O)}return O}resetAnnotationElement(E){const{firstChild:O}=E.container;O.nodeName==="DIV"&&O.classList.contains("annotationContent")&&O.remove()}};B=new WeakMap,D=new WeakMap,_=new WeakMap,U=new WeakMap,G=new WeakMap,pt=new WeakMap,Mt=new WeakMap,Tt=new WeakMap,Ft=new WeakMap,Pt=new WeakMap,Vt=new WeakMap,Wt=new WeakMap,qt=new WeakMap,at=new WeakMap,kt=new WeakMap,Xt=new WeakMap,zt=new WeakMap,ie=new WeakMap,oe=new WeakMap,he=new WeakMap,xe=new WeakMap,Me=new WeakSet,er=function([E,O],Z,q){[Z,q]=this.screenToPageTranslation(Z,q),this.x+=Z/E,this.y+=q/O,this.fixAndSetPosition()},pe=new WeakSet,sr=function(E,O,Z){switch(Z){case 90:return[O,-E];case 180:return[-E,-O];case 270:return[-O,E];default:return[E,O]}},ae=new WeakSet,ir=function(E){switch(E){case 90:{const[O,Z]=this.pageDimensions;return[0,-O/Z,Z/O,0]}case 180:return[-1,0,0,-1];case 270:{const[O,Z]=this.pageDimensions;return[0,O/Z,-Z/O,0]}default:return[1,0,0,1]}},Zt=new WeakSet,ba=function(){if(t(this,G))return;T(this,G,document.createElement("div")),t(this,G).classList.add("resizers");const E=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const O of E){const Z=document.createElement("div");t(this,G).append(Z),Z.classList.add("resizer",O),Z.setAttribute("data-resizer-name",O),Z.addEventListener("pointerdown",y(this,ee,va).bind(this,O)),Z.addEventListener("contextmenu",w.noContextMenu),Z.tabIndex=-1}this.div.prepend(t(this,G))},ee=new WeakSet,va=function(E,O){var Kt;O.preventDefault();const{isMac:Z}=H.FeatureTest.platform;if(O.button!==0||O.ctrlKey&&Z)return;(Kt=t(this,D))==null||Kt.toggle(!1);const q=y(this,r,rr).bind(this,E),St=this._isDraggable;this._isDraggable=!1;const et={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",q,et),window.addEventListener("contextmenu",w.noContextMenu);const S=this.x,$=this.y,j=this.width,ht=this.height,xt=this.parent.div.style.cursor,Lt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(O.target).cursor;const jt=()=>{var De;this.parent.togglePointerEvents(!0),(De=t(this,D))==null||De.toggle(!0),this._isDraggable=St,window.removeEventListener("pointerup",jt),window.removeEventListener("blur",jt),window.removeEventListener("pointermove",q,et),window.removeEventListener("contextmenu",w.noContextMenu),this.parent.div.style.cursor=xt,this.div.style.cursor=Lt,y(this,i,nr).call(this,S,$,j,ht)};window.addEventListener("pointerup",jt),window.addEventListener("blur",jt)},i=new WeakSet,nr=function(E,O,Z,q){const St=this.x,et=this.y,S=this.width,$=this.height;St===E&&et===O&&S===Z&&$===q||this.addCommands({cmd:()=>{this.width=S,this.height=$,this.x=St,this.y=et;const[j,ht]=this.parentDimensions;this.setDims(j*S,ht*$),this.fixAndSetPosition()},undo:()=>{this.width=Z,this.height=q,this.x=E,this.y=O;const[j,ht]=this.parentDimensions;this.setDims(j*Z,ht*q),this.fixAndSetPosition()},mustExec:!0})},r=new WeakSet,rr=function(E,O){const[Z,q]=this.parentDimensions,St=this.x,et=this.y,S=this.width,$=this.height,j=bt.MIN_SIZE/Z,ht=bt.MIN_SIZE/q,xt=Et=>Math.round(Et*1e4)/1e4,Lt=y(this,ae,ir).call(this,this.rotation),jt=(Et,It)=>[Lt[0]*Et+Lt[2]*It,Lt[1]*Et+Lt[3]*It],Kt=y(this,ae,ir).call(this,360-this.rotation),De=(Et,It)=>[Kt[0]*Et+Kt[2]*It,Kt[1]*Et+Kt[3]*It];let fe,ye,de=!1,Re=!1;switch(E){case"topLeft":de=!0,fe=(Et,It)=>[0,0],ye=(Et,It)=>[Et,It];break;case"topMiddle":fe=(Et,It)=>[Et/2,0],ye=(Et,It)=>[Et/2,It];break;case"topRight":de=!0,fe=(Et,It)=>[Et,0],ye=(Et,It)=>[0,It];break;case"middleRight":Re=!0,fe=(Et,It)=>[Et,It/2],ye=(Et,It)=>[0,It/2];break;case"bottomRight":de=!0,fe=(Et,It)=>[Et,It],ye=(Et,It)=>[0,0];break;case"bottomMiddle":fe=(Et,It)=>[Et/2,It],ye=(Et,It)=>[Et/2,0];break;case"bottomLeft":de=!0,fe=(Et,It)=>[0,It],ye=(Et,It)=>[Et,0];break;case"middleLeft":Re=!0,fe=(Et,It)=>[0,It/2],ye=(Et,It)=>[Et,It/2];break}const Ee=fe(S,$),Ve=ye(S,$);let Le=jt(...Ve);const te=xt(St+Le[0]),v=xt(et+Le[1]);let m=1,Y=1,[nt,lt]=this.screenToPageTranslation(O.movementX,O.movementY);if([nt,lt]=De(nt/Z,lt/q),de){const Et=Math.hypot(S,$);m=Y=Math.max(Math.min(Math.hypot(Ve[0]-Ee[0]-nt,Ve[1]-Ee[1]-lt)/Et,1/S,1/$),j/S,ht/$)}else Re?m=Math.max(j,Math.min(1,Math.abs(Ve[0]-Ee[0]-nt)))/S:Y=Math.max(ht,Math.min(1,Math.abs(Ve[1]-Ee[1]-lt)))/$;const vt=xt(S*m),yt=xt($*Y);Le=jt(...ye(vt,yt));const $t=te-Le[0],Ot=v-Le[1];this.width=vt,this.height=yt,this.x=$t,this.y=Ot,this.setDims(Z*vt,q*yt),this.fixAndSetPosition()},l=new WeakSet,ar=function(E){const{isMac:O}=H.FeatureTest.platform;E.ctrlKey&&!O||E.shiftKey||E.metaKey&&O?this.parent.toggleSelected(this):this.parent.setSelected(this)},f=new WeakSet,Aa=function(E){const O=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Z,q;O&&(this.div.classList.add("moving"),Z={passive:!0,capture:!0},T(this,zt,E.clientX),T(this,ie,E.clientY),q=et=>{const{clientX:S,clientY:$}=et,[j,ht]=this.screenToPageTranslation(S-t(this,zt),$-t(this,ie));T(this,zt,S),T(this,ie,$),this._uiManager.dragSelectedEditors(j,ht)},window.addEventListener("pointermove",q,Z));const St=()=>{window.removeEventListener("pointerup",St),window.removeEventListener("blur",St),O&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",q,Z)),T(this,Vt,!1),this._uiManager.endDragSession()||y(this,l,ar).call(this,E)};window.addEventListener("pointerup",St),window.addEventListener("blur",St)},A=new WeakSet,ya=function(E){bt._resizerKeyboardManager.exec(this,E)},a=new WeakSet,wa=function(E){var O;t(this,kt)&&((O=E.relatedTarget)==null?void 0:O.parentNode)!==t(this,G)&&y(this,ut,Ri).call(this)},F=new WeakSet,Sa=function(E){T(this,Pt,t(this,kt)?E:"")},it=new WeakSet,or=function(E){if(t(this,B))for(const O of t(this,B))O.tabIndex=E},ut=new WeakSet,Ri=function(){if(T(this,kt,!1),y(this,it,or).call(this,-1),t(this,pt)){const{savedX:E,savedY:O,savedWidth:Z,savedHeight:q}=t(this,pt);y(this,i,nr).call(this,E,O,Z,q),T(this,pt,null)}},o(bt,pe),be(bt,"_borderLineWidth",-1),be(bt,"_colorManager",new s.ColorManager),be(bt,"_zIndex",1),be(bt,"_telemetryTimeout",1e3);let V=bt;class I extends V{constructor(E){super(E),this.annotationElementId=E.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},61:(st,ot,k)=>{var I,M,W,x,xa,P,cn,z,Ea,tt,Ta,B,lr,_,U,G,pt,Mt,Tt,Ft,Pt,Vt,Wt,qt,at,kt,Xt,zt,ie,oe,he,xe,hr,pe,re,ae,Fe,Zt,Ie,ee,K,Fi,n,Li,c,Ca;k.d(ot,{FreeOutliner:()=>rt,Outliner:()=>H});var s=k(292);class H{constructor(f,d=0,A=0,u=!0){o(this,x);o(this,P);o(this,z);o(this,tt);o(this,B);o(this,I,void 0);o(this,M,[]);o(this,W,[]);let a=1/0,h=-1/0,F=1/0,L=-1/0;const dt=10**-4;for(const{x:Z,y:q,width:St,height:et}of f){const S=Math.floor((Z-d)/dt)*dt,$=Math.ceil((Z+St+d)/dt)*dt,j=Math.floor((q-d)/dt)*dt,ht=Math.ceil((q+et+d)/dt)*dt,xt=[S,j,ht,!0],Lt=[$,j,ht,!1];t(this,M).push(xt,Lt),a=Math.min(a,S),h=Math.max(h,$),F=Math.min(F,j),L=Math.max(L,ht)}const ut=h-a+2*A,wt=L-F+2*A,bt=a-A,At=F-A,E=t(this,M).at(u?-1:-2),O=[E[0],E[2]];for(const Z of t(this,M)){const[q,St,et]=Z;Z[0]=(q-bt)/ut,Z[1]=(St-At)/wt,Z[2]=(et-At)/wt}T(this,I,{x:bt,y:At,width:ut,height:wt,lastPoint:O})}getOutlines(){t(this,M).sort((d,A)=>d[0]-A[0]||d[1]-A[1]||d[2]-A[2]);const f=[];for(const d of t(this,M))d[3]?(f.push(...y(this,B,lr).call(this,d)),y(this,z,Ea).call(this,d)):(y(this,tt,Ta).call(this,d),f.push(...y(this,B,lr).call(this,d)));return y(this,x,xa).call(this,f)}}I=new WeakMap,M=new WeakMap,W=new WeakMap,x=new WeakSet,xa=function(f){const d=[],A=new Set;for(const h of f){const[F,L,it]=h;d.push([F,L,h],[F,it,h])}d.sort((h,F)=>h[1]-F[1]||h[0]-F[0]);for(let h=0,F=d.length;h<F;h+=2){const L=d[h][2],it=d[h+1][2];L.push(it),it.push(L),A.add(L),A.add(it)}const u=[];let a;for(;A.size>0;){const h=A.values().next().value;let[F,L,it,dt,ut]=h;A.delete(h);let wt=F,bt=L;for(a=[F,it],u.push(a);;){let At;if(A.has(dt))At=dt;else if(A.has(ut))At=ut;else break;A.delete(At),[F,L,it,dt,ut]=At,wt!==F&&(a.push(wt,bt,F,bt===L?L:it),wt=F),bt=bt===L?it:L}a.push(wt,bt)}return new X(u,t(this,I))},P=new WeakSet,cn=function(f){const d=t(this,W);let A=0,u=d.length-1;for(;A<=u;){const a=A+u>>1,h=d[a][0];if(h===f)return a;h<f?A=a+1:u=a-1}return u+1},z=new WeakSet,Ea=function([,f,d]){const A=y(this,P,cn).call(this,f);t(this,W).splice(A,0,[f,d])},tt=new WeakSet,Ta=function([,f,d]){const A=y(this,P,cn).call(this,f);for(let u=A;u<t(this,W).length;u++){const[a,h]=t(this,W)[u];if(a!==f)break;if(a===f&&h===d){t(this,W).splice(u,1);return}}for(let u=A-1;u>=0;u--){const[a,h]=t(this,W)[u];if(a!==f)break;if(a===f&&h===d){t(this,W).splice(u,1);return}}},B=new WeakSet,lr=function(f){const[d,A,u]=f,a=[[d,A,u]],h=y(this,P,cn).call(this,u);for(let F=0;F<h;F++){const[L,it]=t(this,W)[F];for(let dt=0,ut=a.length;dt<ut;dt++){const[,wt,bt]=a[dt];if(!(it<=wt||bt<=L)){if(wt>=L){if(bt>it)a[dt][1]=it;else{if(ut===1)return[];a.splice(dt,1),dt--,ut--}continue}a[dt][2]=L,bt>it&&a.push([d,it,bt])}}}return a};class w{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(f,d){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof V}}class X extends w{constructor(d,A){super();o(this,_,void 0);o(this,U,void 0);T(this,U,d),T(this,_,A)}toSVGPath(){const d=[];for(const A of t(this,U)){let[u,a]=A;d.push(`M${u} ${a}`);for(let h=2;h<A.length;h+=2){const F=A[h],L=A[h+1];F===u?(d.push(`V${L}`),a=L):L===a&&(d.push(`H${F}`),u=F)}d.push("Z")}return d.join(" ")}serialize([d,A,u,a],h){const F=[],L=u-d,it=a-A;for(const dt of t(this,U)){const ut=new Array(dt.length);for(let wt=0;wt<dt.length;wt+=2)ut[wt]=d+dt[wt]*L,ut[wt+1]=a-dt[wt+1]*it;F.push(ut)}return F}get box(){return t(this,_)}}_=new WeakMap,U=new WeakMap;const ce=class ce{constructor({x:f,y:d},A,u,a,h,F=0){o(this,xe);o(this,G,void 0);o(this,pt,[]);o(this,Mt,void 0);o(this,Tt,void 0);o(this,Ft,[]);o(this,Pt,new Float64Array(18));o(this,Vt,void 0);o(this,Wt,void 0);o(this,qt,void 0);o(this,at,void 0);o(this,kt,void 0);o(this,Xt,void 0);o(this,zt,[]);T(this,G,A),T(this,Xt,a*u),T(this,Tt,h),t(this,Pt).set([NaN,NaN,NaN,NaN,f,d],6),T(this,Mt,F),T(this,at,t(ce,ie)*u),T(this,qt,t(ce,he)*u),T(this,kt,u),t(this,zt).push(f,d)}get free(){return!0}isEmpty(){return isNaN(t(this,Pt)[8])}add({x:f,y:d}){var xt;T(this,Vt,f),T(this,Wt,d);const[A,u,a,h]=t(this,G);let[F,L,it,dt]=t(this,Pt).subarray(8,12);const ut=f-it,wt=d-dt,bt=Math.hypot(ut,wt);if(bt<t(this,qt))return!1;const At=bt-t(this,at),E=At/bt,O=E*ut,Z=E*wt;let q=F,St=L;F=it,L=dt,it+=O,dt+=Z,(xt=t(this,zt))==null||xt.push(f,d);const et=-Z/At,S=O/At,$=et*t(this,Xt),j=S*t(this,Xt);return t(this,Pt).set(t(this,Pt).subarray(2,8),0),t(this,Pt).set([it+$,dt+j],4),t(this,Pt).set(t(this,Pt).subarray(14,18),12),t(this,Pt).set([it-$,dt-j],16),isNaN(t(this,Pt)[6])?(t(this,Ft).length===0&&(t(this,Pt).set([F+$,L+j],2),t(this,Ft).push(NaN,NaN,NaN,NaN,(F+$-A)/a,(L+j-u)/h),t(this,Pt).set([F-$,L-j],14),t(this,pt).push(NaN,NaN,NaN,NaN,(F-$-A)/a,(L-j-u)/h)),t(this,Pt).set([q,St,F,L,it,dt],6),!this.isEmpty()):(t(this,Pt).set([q,St,F,L,it,dt],6),Math.abs(Math.atan2(St-L,q-F)-Math.atan2(Z,O))<Math.PI/2?([F,L,it,dt]=t(this,Pt).subarray(2,6),t(this,Ft).push(NaN,NaN,NaN,NaN,((F+it)/2-A)/a,((L+dt)/2-u)/h),[F,L,q,St]=t(this,Pt).subarray(14,18),t(this,pt).push(NaN,NaN,NaN,NaN,((q+F)/2-A)/a,((St+L)/2-u)/h),!0):([q,St,F,L,it,dt]=t(this,Pt).subarray(0,6),t(this,Ft).push(((q+5*F)/6-A)/a,((St+5*L)/6-u)/h,((5*F+it)/6-A)/a,((5*L+dt)/6-u)/h,((F+it)/2-A)/a,((L+dt)/2-u)/h),[it,dt,F,L,q,St]=t(this,Pt).subarray(12,18),t(this,pt).push(((q+5*F)/6-A)/a,((St+5*L)/6-u)/h,((5*F+it)/6-A)/a,((5*L+dt)/6-u)/h,((F+it)/2-A)/a,((L+dt)/2-u)/h),!0))}toSVGPath(){if(this.isEmpty())return"";const f=t(this,Ft),d=t(this,pt),A=t(this,Pt).subarray(4,6),u=t(this,Pt).subarray(16,18),[a,h,F,L]=t(this,G),[it,dt,ut,wt]=y(this,xe,hr).call(this);if(isNaN(t(this,Pt)[6])&&!this.isEmpty())return`M${(t(this,Pt)[2]-a)/F} ${(t(this,Pt)[3]-h)/L} L${(t(this,Pt)[4]-a)/F} ${(t(this,Pt)[5]-h)/L} L${it} ${dt} L${ut} ${wt} L${(t(this,Pt)[16]-a)/F} ${(t(this,Pt)[17]-h)/L} L${(t(this,Pt)[14]-a)/F} ${(t(this,Pt)[15]-h)/L} Z`;const bt=[];bt.push(`M${f[4]} ${f[5]}`);for(let At=6;At<f.length;At+=6)isNaN(f[At])?bt.push(`L${f[At+4]} ${f[At+5]}`):bt.push(`C${f[At]} ${f[At+1]} ${f[At+2]} ${f[At+3]} ${f[At+4]} ${f[At+5]}`);bt.push(`L${(A[0]-a)/F} ${(A[1]-h)/L} L${it} ${dt} L${ut} ${wt} L${(u[0]-a)/F} ${(u[1]-h)/L}`);for(let At=d.length-6;At>=6;At-=6)isNaN(d[At])?bt.push(`L${d[At+4]} ${d[At+5]}`):bt.push(`C${d[At]} ${d[At+1]} ${d[At+2]} ${d[At+3]} ${d[At+4]} ${d[At+5]}`);return bt.push(`L${d[4]} ${d[5]} Z`),bt.join(" ")}getOutlines(){var Z;const f=t(this,Ft),d=t(this,pt),A=t(this,Pt),u=A.subarray(4,6),a=A.subarray(16,18),[h,F,L,it]=t(this,G),dt=new Float64Array((((Z=t(this,zt))==null?void 0:Z.length)??0)+2);for(let q=0,St=dt.length-2;q<St;q+=2)dt[q]=(t(this,zt)[q]-h)/L,dt[q+1]=(t(this,zt)[q+1]-F)/it;dt[dt.length-2]=(t(this,Vt)-h)/L,dt[dt.length-1]=(t(this,Wt)-F)/it;const[ut,wt,bt,At]=y(this,xe,hr).call(this);if(isNaN(A[6])&&!this.isEmpty()){const q=new Float64Array(36);return q.set([NaN,NaN,NaN,NaN,(A[2]-h)/L,(A[3]-F)/it,NaN,NaN,NaN,NaN,(A[4]-h)/L,(A[5]-F)/it,NaN,NaN,NaN,NaN,ut,wt,NaN,NaN,NaN,NaN,bt,At,NaN,NaN,NaN,NaN,(A[16]-h)/L,(A[17]-F)/it,NaN,NaN,NaN,NaN,(A[14]-h)/L,(A[15]-F)/it],0),new V(q,dt,t(this,G),t(this,kt),t(this,Mt),t(this,Tt))}const E=new Float64Array(t(this,Ft).length+24+t(this,pt).length);let O=f.length;for(let q=0;q<O;q+=2){if(isNaN(f[q])){E[q]=E[q+1]=NaN;continue}E[q]=f[q],E[q+1]=f[q+1]}E.set([NaN,NaN,NaN,NaN,(u[0]-h)/L,(u[1]-F)/it,NaN,NaN,NaN,NaN,ut,wt,NaN,NaN,NaN,NaN,bt,At,NaN,NaN,NaN,NaN,(a[0]-h)/L,(a[1]-F)/it],O),O+=24;for(let q=d.length-6;q>=6;q-=6)for(let St=0;St<6;St+=2){if(isNaN(d[q+St])){E[O]=E[O+1]=NaN,O+=2;continue}E[O]=d[q+St],E[O+1]=d[q+St+1],O+=2}return E.set([NaN,NaN,NaN,NaN,d[4],d[5]],O),new V(E,dt,t(this,G),t(this,kt),t(this,Mt),t(this,Tt))}};G=new WeakMap,pt=new WeakMap,Mt=new WeakMap,Tt=new WeakMap,Ft=new WeakMap,Pt=new WeakMap,Vt=new WeakMap,Wt=new WeakMap,qt=new WeakMap,at=new WeakMap,kt=new WeakMap,Xt=new WeakMap,zt=new WeakMap,ie=new WeakMap,oe=new WeakMap,he=new WeakMap,xe=new WeakSet,hr=function(){const f=t(this,Pt).subarray(4,6),d=t(this,Pt).subarray(16,18),[A,u,a,h]=t(this,G);return[(t(this,Vt)+(f[0]-d[0])/2-A)/a,(t(this,Wt)+(f[1]-d[1])/2-u)/h,(t(this,Vt)+(d[0]-f[0])/2-A)/a,(t(this,Wt)+(d[1]-f[1])/2-u)/h]},o(ce,ie,8),o(ce,oe,2),o(ce,he,t(ce,ie)+t(ce,oe));let rt=ce;class V extends w{constructor(d,A,u,a,h,F){super();o(this,K);o(this,n);o(this,c);o(this,pe,void 0);o(this,re,null);o(this,ae,void 0);o(this,Fe,void 0);o(this,Zt,void 0);o(this,Ie,void 0);o(this,ee,void 0);T(this,ee,d),T(this,Zt,A),T(this,pe,u),T(this,Ie,a),T(this,ae,h),T(this,Fe,F),y(this,c,Ca).call(this,F);const{x:L,y:it,width:dt,height:ut}=t(this,re);for(let wt=0,bt=d.length;wt<bt;wt+=2)d[wt]=(d[wt]-L)/dt,d[wt+1]=(d[wt+1]-it)/ut;for(let wt=0,bt=A.length;wt<bt;wt+=2)A[wt]=(A[wt]-L)/dt,A[wt+1]=(A[wt+1]-it)/ut}toSVGPath(){const d=[`M${t(this,ee)[4]} ${t(this,ee)[5]}`];for(let A=6,u=t(this,ee).length;A<u;A+=6){if(isNaN(t(this,ee)[A])){d.push(`L${t(this,ee)[A+4]} ${t(this,ee)[A+5]}`);continue}d.push(`C${t(this,ee)[A]} ${t(this,ee)[A+1]} ${t(this,ee)[A+2]} ${t(this,ee)[A+3]} ${t(this,ee)[A+4]} ${t(this,ee)[A+5]}`)}return d.push("Z"),d.join(" ")}serialize([d,A,u,a],h){const F=u-d,L=a-A;let it,dt;switch(h){case 0:it=y(this,K,Fi).call(this,t(this,ee),d,a,F,-L),dt=y(this,K,Fi).call(this,t(this,Zt),d,a,F,-L);break;case 90:it=y(this,n,Li).call(this,t(this,ee),d,A,F,L),dt=y(this,n,Li).call(this,t(this,Zt),d,A,F,L);break;case 180:it=y(this,K,Fi).call(this,t(this,ee),u,A,-F,L),dt=y(this,K,Fi).call(this,t(this,Zt),u,A,-F,L);break;case 270:it=y(this,n,Li).call(this,t(this,ee),u,a,-F,-L),dt=y(this,n,Li).call(this,t(this,Zt),u,a,-F,-L);break}return{outline:Array.from(it),points:[Array.from(dt)]}}get box(){return t(this,re)}getNewOutline(d,A){const{x:u,y:a,width:h,height:F}=t(this,re),[L,it,dt,ut]=t(this,pe),wt=h*dt,bt=F*ut,At=u*dt+L,E=a*ut+it,O=new rt({x:t(this,Zt)[0]*wt+At,y:t(this,Zt)[1]*bt+E},t(this,pe),t(this,Ie),d,t(this,Fe),A??t(this,ae));for(let Z=2;Z<t(this,Zt).length;Z+=2)O.add({x:t(this,Zt)[Z]*wt+At,y:t(this,Zt)[Z+1]*bt+E});return O.getOutlines()}}pe=new WeakMap,re=new WeakMap,ae=new WeakMap,Fe=new WeakMap,Zt=new WeakMap,Ie=new WeakMap,ee=new WeakMap,K=new WeakSet,Fi=function(d,A,u,a,h){const F=new Float64Array(d.length);for(let L=0,it=d.length;L<it;L+=2)F[L]=A+d[L]*a,F[L+1]=u+d[L+1]*h;return F},n=new WeakSet,Li=function(d,A,u,a,h){const F=new Float64Array(d.length);for(let L=0,it=d.length;L<it;L+=2)F[L]=A+d[L+1]*a,F[L+1]=u+d[L]*h;return F},c=new WeakSet,Ca=function(d){const A=t(this,ee);let u=A[4],a=A[5],h=u,F=a,L=u,it=a,dt=u,ut=a;const wt=d?Math.max:Math.min;for(let Z=6,q=A.length;Z<q;Z+=6){if(isNaN(A[Z]))h=Math.min(h,A[Z+4]),F=Math.min(F,A[Z+5]),L=Math.max(L,A[Z+4]),it=Math.max(it,A[Z+5]),ut<A[Z+5]?(dt=A[Z+4],ut=A[Z+5]):ut===A[Z+5]&&(dt=wt(dt,A[Z+4]));else{const St=s.Util.bezierBoundingBox(u,a,...A.slice(Z,Z+6));h=Math.min(h,St[0]),F=Math.min(F,St[1]),L=Math.max(L,St[2]),it=Math.max(it,St[3]),ut<St[3]?(dt=St[2],ut=St[3]):ut===St[3]&&(dt=wt(dt,St[2]))}u=A[Z+4],a=A[Z+5]}const bt=h-t(this,ae),At=F-t(this,ae),E=L-h+2*t(this,ae),O=it-F+2*t(this,ae);T(this,re,{x:bt,y:At,width:E,height:O,lastPoint:[dt,ut]})}},362:(st,ot,k)=>{var X,rt,V,I,M,ka,x,Ra,P,Fa,z,dn,tt,La,B,cr,U,G,pt,Mt,Pa,Ft,Ma,Vt,Ia;k.d(ot,{EditorToolbar:()=>H,HighlightToolbar:()=>w});var s=k(419);const _=class _{constructor(at){o(this,x);o(this,P);o(this,z);o(this,tt);o(this,B);o(this,X,null);o(this,rt,null);o(this,V,void 0);o(this,I,null);T(this,V,at)}render(){const at=T(this,X,document.createElement("div"));at.className="editToolbar",at.setAttribute("role","toolbar"),at.addEventListener("contextmenu",s.noContextMenu),at.addEventListener("pointerdown",y(_,M,ka));const kt=T(this,I,document.createElement("div"));kt.className="buttons",at.append(kt);const Xt=t(this,V).toolbarPosition;if(Xt){const{style:zt}=at,ie=t(this,V)._uiManager.direction==="ltr"?1-Xt[0]:Xt[0];zt.insetInlineEnd=`${100*ie}%`,zt.top=`calc(${100*Xt[1]}% + var(--editor-toolbar-vert-offset))`}return y(this,tt,La).call(this),at}hide(){var at;t(this,X).classList.add("hidden"),(at=t(this,rt))==null||at.hideDropdown()}show(){t(this,X).classList.remove("hidden")}addAltTextButton(at){y(this,z,dn).call(this,at),t(this,I).prepend(at,t(this,B,cr))}addColorPicker(at){T(this,rt,at);const kt=at.renderButton();y(this,z,dn).call(this,kt),t(this,I).prepend(kt,t(this,B,cr))}remove(){var at;t(this,X).remove(),(at=t(this,rt))==null||at.destroy(),T(this,rt,null)}};X=new WeakMap,rt=new WeakMap,V=new WeakMap,I=new WeakMap,M=new WeakSet,ka=function(at){at.stopPropagation()},x=new WeakSet,Ra=function(at){t(this,V)._focusEventsAllowed=!1,at.preventDefault(),at.stopPropagation()},P=new WeakSet,Fa=function(at){t(this,V)._focusEventsAllowed=!0,at.preventDefault(),at.stopPropagation()},z=new WeakSet,dn=function(at){at.addEventListener("focusin",y(this,x,Ra).bind(this),{capture:!0}),at.addEventListener("focusout",y(this,P,Fa).bind(this),{capture:!0}),at.addEventListener("contextmenu",s.noContextMenu)},tt=new WeakSet,La=function(){const at=document.createElement("button");at.className="delete",at.tabIndex=0,at.setAttribute("data-l10n-id",`pdfjs-editor-remove-${t(this,V).editorType}-button`),y(this,z,dn).call(this,at),at.addEventListener("click",kt=>{t(this,V)._uiManager.delete()}),t(this,I).append(at)},B=new WeakSet,cr=function(){const at=document.createElement("div");return at.className="divider",at},o(_,M);let H=_;class w{constructor(at){o(this,Mt);o(this,Ft);o(this,Vt);o(this,U,null);o(this,G,null);o(this,pt,void 0);T(this,pt,at)}show(at,kt,Xt){const[zt,ie]=y(this,Ft,Ma).call(this,kt,Xt),{style:oe}=t(this,G)||T(this,G,y(this,Mt,Pa).call(this));at.append(t(this,G)),oe.insetInlineEnd=`${100*zt}%`,oe.top=`calc(${100*ie}% + var(--editor-toolbar-vert-offset))`}hide(){t(this,G).remove()}}U=new WeakMap,G=new WeakMap,pt=new WeakMap,Mt=new WeakSet,Pa=function(){const at=T(this,G,document.createElement("div"));at.className="editToolbar",at.setAttribute("role","toolbar"),at.addEventListener("contextmenu",s.noContextMenu);const kt=T(this,U,document.createElement("div"));return kt.className="buttons",at.append(kt),y(this,Vt,Ia).call(this),at},Ft=new WeakSet,Ma=function(at,kt){let Xt=0,zt=0;for(const ie of at){const oe=ie.y+ie.height;if(oe<Xt)continue;const he=ie.x+(kt?ie.width:0);if(oe>Xt){zt=he,Xt=oe;continue}kt?he>zt&&(zt=he):he<zt&&(zt=he)}return[kt?1-zt:zt,Xt]},Vt=new WeakSet,Ia=function(){const at=document.createElement("button");at.className="highlightButton",at.tabIndex=0,at.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const kt=document.createElement("span");at.append(kt),kt.className="visuallyHidden",kt.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),at.addEventListener("contextmenu",s.noContextMenu),at.addEventListener("click",()=>{t(this,pt).highlightSelection("floating_button")}),t(this,U).append(at)}},830:(st,ot,k)=>{var P,R,z,ct,tt,dr,D,_,U,G,pt,Na,Ft,Pt,Vt,Wt,qt,at,kt,Xt,zt,ie,oe,he,xe,Me,ce,pe,re,ae,Fe,Zt,Ie,ee,K,i,n,r,c,l,p,f,d,A,u,a,h,F,L,it,dt,ut,wt,bt,At,E,O,Z,q,un,et,Da,$,_a,ht,fn,Lt,Oa,Kt,Ha,fe,Ba,de,ur,Ee,fr,Le,pr,v,gr,Y,mr,lt,je,yt,Es,Ot,Va,It,$a,_t,br,Qt,za,ge,Pi,Te,vr;k.d(ot,{AnnotationEditorUIManager:()=>g,ColorManager:()=>x,KeyboardManager:()=>W,bindEvents:()=>X,opacityToHex:()=>rt});var s=k(292),H=k(419),w=k(362);function X(Ue,C,ft){for(const Nt of ft)C.addEventListener(Nt,Ue[Nt].bind(Ue))}function rt(Ue){return Math.round(Math.min(255,Math.max(1,255*Ue))).toString(16).padStart(2,"0")}class V{constructor(){o(this,P,0)}get id(){return`${s.AnnotationEditorPrefix}${gs(this,P)._++}`}}P=new WeakMap;const B=class B{constructor(){o(this,tt);o(this,R,(0,s.getUuid)());o(this,z,0);o(this,ct,null)}static get _isSVGFittingCanvas(){const C='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Nt=new OffscreenCanvas(1,3).getContext("2d"),Ht=new Image;Ht.src=C;const Ut=Ht.decode().then(()=>(Nt.drawImage(Ht,0,0,1,1,0,0,1,3),new Uint32Array(Nt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,s.shadow)(this,"_isSVGFittingCanvas",Ut)}async getFromFile(C){const{lastModified:ft,name:Nt,size:Ht,type:Ut}=C;return y(this,tt,dr).call(this,`${ft}_${Nt}_${Ht}_${Ut}`,C)}async getFromUrl(C){return y(this,tt,dr).call(this,C,C)}async getFromId(C){t(this,ct)||T(this,ct,new Map);const ft=t(this,ct).get(C);return ft?ft.bitmap?(ft.refCounter+=1,ft):ft.file?this.getFromFile(ft.file):this.getFromUrl(ft.url):null}getSvgUrl(C){const ft=t(this,ct).get(C);return ft!=null&&ft.isSvg?ft.svgUrl:null}deleteId(C){t(this,ct)||T(this,ct,new Map);const ft=t(this,ct).get(C);ft&&(ft.refCounter-=1,ft.refCounter===0&&(ft.bitmap=null))}isValidId(C){return C.startsWith(`image_${t(this,R)}_`)}};R=new WeakMap,z=new WeakMap,ct=new WeakMap,tt=new WeakSet,dr=async function(C,ft){t(this,ct)||T(this,ct,new Map);let Nt=t(this,ct).get(C);if(Nt===null)return null;if(Nt!=null&&Nt.bitmap)return Nt.refCounter+=1,Nt;try{Nt||(Nt={bitmap:null,id:`image_${t(this,R)}_${gs(this,z)._++}`,refCounter:0,isSvg:!1});let Ht;if(typeof ft=="string"?(Nt.url=ft,Ht=await(0,H.fetchData)(ft,"blob")):Ht=Nt.file=ft,Ht.type==="image/svg+xml"){const Ut=B._isSVGFittingCanvas,Jt=new FileReader,se=new Image,Se=new Promise((we,We)=>{se.onload=()=>{Nt.bitmap=se,Nt.isSvg=!0,we()},Jt.onload=async()=>{const Oe=Nt.svgUrl=Jt.result;se.src=await Ut?`${Oe}#svgView(preserveAspectRatio(none))`:Oe},se.onerror=Jt.onerror=We});Jt.readAsDataURL(Ht),await Se}else Nt.bitmap=await createImageBitmap(Ht);Nt.refCounter=1}catch(Ht){console.error(Ht),Nt=null}return t(this,ct).set(C,Nt),Nt&&t(this,ct).set(Nt.id,Nt),Nt};let I=B;class M{constructor(C=128){o(this,D,[]);o(this,_,!1);o(this,U,void 0);o(this,G,-1);T(this,U,C)}add({cmd:C,undo:ft,post:Nt,mustExec:Ht,type:Ut=NaN,overwriteIfSameType:Jt=!1,keepUndo:se=!1}){if(Ht&&C(),t(this,_))return;const Se={cmd:C,undo:ft,post:Nt,type:Ut};if(t(this,G)===-1){t(this,D).length>0&&(t(this,D).length=0),T(this,G,0),t(this,D).push(Se);return}if(Jt&&t(this,D)[t(this,G)].type===Ut){se&&(Se.undo=t(this,D)[t(this,G)].undo),t(this,D)[t(this,G)]=Se;return}const we=t(this,G)+1;we===t(this,U)?t(this,D).splice(0,1):(T(this,G,we),we<t(this,D).length&&t(this,D).splice(we)),t(this,D).push(Se)}undo(){if(t(this,G)===-1)return;T(this,_,!0);const{undo:C,post:ft}=t(this,D)[t(this,G)];C(),ft==null||ft(),T(this,_,!1),T(this,G,t(this,G)-1)}redo(){if(t(this,G)<t(this,D).length-1){T(this,G,t(this,G)+1),T(this,_,!0);const{cmd:C,post:ft}=t(this,D)[t(this,G)];C(),ft==null||ft(),T(this,_,!1)}}hasSomethingToUndo(){return t(this,G)!==-1}hasSomethingToRedo(){return t(this,G)<t(this,D).length-1}destroy(){T(this,D,null)}}D=new WeakMap,_=new WeakMap,U=new WeakMap,G=new WeakMap;class W{constructor(C){o(this,pt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:ft}=s.FeatureTest.platform;for(const[Nt,Ht,Ut={}]of C)for(const Jt of Nt){const se=Jt.startsWith("mac+");ft&&se?(this.callbacks.set(Jt.slice(4),{callback:Ht,options:Ut}),this.allKeys.add(Jt.split("+").at(-1))):!ft&&!se&&(this.callbacks.set(Jt,{callback:Ht,options:Ut}),this.allKeys.add(Jt.split("+").at(-1)))}}exec(C,ft){if(!this.allKeys.has(ft.key))return;const Nt=this.callbacks.get(y(this,pt,Na).call(this,ft));if(!Nt)return;const{callback:Ht,options:{bubbles:Ut=!1,args:Jt=[],checker:se=null}}=Nt;se&&!se(C,ft)||(Ht.bind(C,...Jt,ft)(),Ut||(ft.stopPropagation(),ft.preventDefault()))}}pt=new WeakSet,Na=function(C){C.altKey&&this.buffer.push("alt"),C.ctrlKey&&this.buffer.push("ctrl"),C.metaKey&&this.buffer.push("meta"),C.shiftKey&&this.buffer.push("shift"),this.buffer.push(C.key);const ft=this.buffer.join("+");return this.buffer.length=0,ft};const Tt=class Tt{get _colors(){const C=new Map([["CanvasText",null],["Canvas",null]]);return(0,H.getColorValues)(C),(0,s.shadow)(this,"_colors",C)}convert(C){const ft=(0,H.getRGB)(C);if(!window.matchMedia("(forced-colors: active)").matches)return ft;for(const[Nt,Ht]of this._colors)if(Ht.every((Ut,Jt)=>Ut===ft[Jt]))return Tt._colorsMapping.get(Nt);return ft}getHexCode(C){const ft=this._colors.get(C);return ft?s.Util.makeHexColor(...ft):C}};be(Tt,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let x=Tt;const He=class He{constructor(C,ft,Nt,Ht,Ut,Jt,se,Se,we){o(this,q);o(this,et);o(this,$);o(this,ht);o(this,Lt);o(this,Kt);o(this,fe);o(this,de);o(this,Ee);o(this,Le);o(this,v);o(this,Y);o(this,lt);o(this,yt);o(this,Ot);o(this,It);o(this,_t);o(this,Qt);o(this,ge);o(this,Te);o(this,Ft,null);o(this,Pt,new Map);o(this,Vt,new Map);o(this,Wt,null);o(this,qt,null);o(this,at,null);o(this,kt,new M);o(this,Xt,0);o(this,zt,new Set);o(this,ie,null);o(this,oe,null);o(this,he,new Set);o(this,xe,!1);o(this,Me,null);o(this,ce,null);o(this,pe,null);o(this,re,!1);o(this,ae,null);o(this,Fe,new V);o(this,Zt,!1);o(this,Ie,!1);o(this,ee,null);o(this,K,null);o(this,i,null);o(this,n,s.AnnotationEditorType.NONE);o(this,r,new Set);o(this,c,null);o(this,l,null);o(this,p,null);o(this,f,this.blur.bind(this));o(this,d,this.focus.bind(this));o(this,A,this.copy.bind(this));o(this,u,this.cut.bind(this));o(this,a,this.paste.bind(this));o(this,h,this.keydown.bind(this));o(this,F,this.keyup.bind(this));o(this,L,this.onEditingAction.bind(this));o(this,it,this.onPageChanging.bind(this));o(this,dt,this.onScaleChanging.bind(this));o(this,ut,y(this,$,_a).bind(this));o(this,wt,this.onRotationChanging.bind(this));o(this,bt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});o(this,At,[0,0]);o(this,E,null);o(this,O,null);o(this,Z,null);T(this,O,C),T(this,Z,ft),T(this,Wt,Nt),this._eventBus=Ht,this._eventBus._on("editingaction",t(this,L)),this._eventBus._on("pagechanging",t(this,it)),this._eventBus._on("scalechanging",t(this,dt)),this._eventBus._on("rotationchanging",t(this,wt)),y(this,Lt,Oa).call(this),y(this,Ee,fr).call(this),T(this,qt,Ut.annotationStorage),T(this,Me,Ut.filterFactory),T(this,l,Jt),T(this,pe,se||null),T(this,xe,Se),T(this,i,we||null),this.viewParameters={realScale:H.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const C=He.prototype,ft=Jt=>t(Jt,O).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&Jt.hasSomethingToControl(),Nt=(Jt,{target:se})=>{if(se instanceof HTMLInputElement){const{type:Se}=se;return Se!=="text"&&Se!=="number"}return!0},Ht=this.TRANSLATE_SMALL,Ut=this.TRANSLATE_BIG;return(0,s.shadow)(this,"_keyboardManager",new W([[["ctrl+a","mac+meta+a"],C.selectAll,{checker:Nt}],[["ctrl+z","mac+meta+z"],C.undo,{checker:Nt}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],C.redo,{checker:Nt}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],C.delete,{checker:Nt}],[["Enter","mac+Enter"],C.addNewEditorFromKeyboard,{checker:(Jt,{target:se})=>!(se instanceof HTMLButtonElement)&&t(Jt,O).contains(se)&&!Jt.isEnterHandled}],[[" ","mac+ "],C.addNewEditorFromKeyboard,{checker:(Jt,{target:se})=>!(se instanceof HTMLButtonElement)&&t(Jt,O).contains(document.activeElement)}],[["Escape","mac+Escape"],C.unselectAll],[["ArrowLeft","mac+ArrowLeft"],C.translateSelectedEditors,{args:[-Ht,0],checker:ft}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],C.translateSelectedEditors,{args:[-Ut,0],checker:ft}],[["ArrowRight","mac+ArrowRight"],C.translateSelectedEditors,{args:[Ht,0],checker:ft}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],C.translateSelectedEditors,{args:[Ut,0],checker:ft}],[["ArrowUp","mac+ArrowUp"],C.translateSelectedEditors,{args:[0,-Ht],checker:ft}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],C.translateSelectedEditors,{args:[0,-Ut],checker:ft}],[["ArrowDown","mac+ArrowDown"],C.translateSelectedEditors,{args:[0,Ht],checker:ft}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],C.translateSelectedEditors,{args:[0,Ut],checker:ft}]]))}destroy(){var C,ft;y(this,Le,pr).call(this),y(this,de,ur).call(this),this._eventBus._off("editingaction",t(this,L)),this._eventBus._off("pagechanging",t(this,it)),this._eventBus._off("scalechanging",t(this,dt)),this._eventBus._off("rotationchanging",t(this,wt));for(const Nt of t(this,Vt).values())Nt.destroy();t(this,Vt).clear(),t(this,Pt).clear(),t(this,he).clear(),T(this,Ft,null),t(this,r).clear(),t(this,kt).destroy(),(C=t(this,Wt))==null||C.destroy(),(ft=t(this,ae))==null||ft.hide(),T(this,ae,null),t(this,ce)&&(clearTimeout(t(this,ce)),T(this,ce,null)),t(this,E)&&(clearTimeout(t(this,E)),T(this,E,null)),y(this,Kt,Ha).call(this)}async mlGuess(C){var ft;return((ft=t(this,i))==null?void 0:ft.guess(C))||null}get hasMLManager(){return!!t(this,i)}get hcmFilter(){return(0,s.shadow)(this,"hcmFilter",t(this,l)?t(this,Me).addHCMFilter(t(this,l).foreground,t(this,l).background):"none")}get direction(){return(0,s.shadow)(this,"direction",getComputedStyle(t(this,O)).direction)}get highlightColors(){return(0,s.shadow)(this,"highlightColors",t(this,pe)?new Map(t(this,pe).split(",").map(C=>C.split("=").map(ft=>ft.trim()))):null)}get highlightColorNames(){return(0,s.shadow)(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,C=>C.reverse())):null)}setMainHighlightColorPicker(C){T(this,K,C)}editAltText(C){var ft;(ft=t(this,Wt))==null||ft.editAltText(this,C)}onPageChanging({pageNumber:C}){T(this,Xt,C-1)}focusMainContainer(){t(this,O).focus()}findParent(C,ft){for(const Nt of t(this,Vt).values()){const{x:Ht,y:Ut,width:Jt,height:se}=Nt.div.getBoundingClientRect();if(C>=Ht&&C<=Ht+Jt&&ft>=Ut&&ft<=Ut+se)return Nt}return null}disableUserSelect(C=!1){t(this,Z).classList.toggle("noUserSelect",C)}addShouldRescale(C){t(this,he).add(C)}removeShouldRescale(C){t(this,he).delete(C)}onScaleChanging({scale:C}){this.commitOrRemove(),this.viewParameters.realScale=C*H.PixelsPerInch.PDF_TO_CSS_UNITS;for(const ft of t(this,he))ft.onScaleChanging()}onRotationChanging({pagesRotation:C}){this.commitOrRemove(),this.viewParameters.rotation=C}highlightSelection(C=""){const ft=document.getSelection();if(!ft||ft.isCollapsed)return;const{anchorNode:Nt,anchorOffset:Ht,focusNode:Ut,focusOffset:Jt}=ft,se=ft.toString(),we=y(this,q,un).call(this,ft).closest(".textLayer"),We=this.getSelectionBoxes(we);if(We){ft.empty(),t(this,n)===s.AnnotationEditorType.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:s.AnnotationEditorType.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const Oe of t(this,Vt).values())if(Oe.hasTextLayer(we)){Oe.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:C,boxes:We,anchorNode:Nt,anchorOffset:Ht,focusNode:Ut,focusOffset:Jt,text:se});break}}}addToAnnotationStorage(C){!C.isEmpty()&&t(this,qt)&&!t(this,qt).has(C.id)&&t(this,qt).setValue(C.id,C)}blur(){if(this.isShiftKeyDown=!1,t(this,re)&&(T(this,re,!1),y(this,ht,fn).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:C}=document;for(const ft of t(this,r))if(ft.div.contains(C)){T(this,ee,[ft,C]),ft._focusEventsAllowed=!1;break}}focus(){if(!t(this,ee))return;const[C,ft]=t(this,ee);T(this,ee,null),ft.addEventListener("focusin",()=>{C._focusEventsAllowed=!0},{once:!0}),ft.focus()}addEditListeners(){y(this,Ee,fr).call(this),y(this,v,gr).call(this)}removeEditListeners(){y(this,Le,pr).call(this),y(this,Y,mr).call(this)}copy(C){var Nt;if(C.preventDefault(),(Nt=t(this,Ft))==null||Nt.commitOrRemove(),!this.hasSelection)return;const ft=[];for(const Ht of t(this,r)){const Ut=Ht.serialize(!0);Ut&&ft.push(Ut)}ft.length!==0&&C.clipboardData.setData("application/pdfjs",JSON.stringify(ft))}cut(C){this.copy(C),this.delete()}paste(C){C.preventDefault();const{clipboardData:ft}=C;for(const Ut of ft.items)for(const Jt of t(this,oe))if(Jt.isHandlingMimeForPasting(Ut.type)){Jt.paste(Ut,this.currentLayer);return}let Nt=ft.getData("application/pdfjs");if(!Nt)return;try{Nt=JSON.parse(Nt)}catch(Ut){(0,s.warn)(`paste: "${Ut.message}".`);return}if(!Array.isArray(Nt))return;this.unselectAll();const Ht=this.currentLayer;try{const Ut=[];for(const Se of Nt){const we=Ht.deserialize(Se);if(!we)return;Ut.push(we)}const Jt=()=>{for(const Se of Ut)y(this,_t,br).call(this,Se);y(this,Te,vr).call(this,Ut)},se=()=>{for(const Se of Ut)Se.remove()};this.addCommands({cmd:Jt,undo:se,mustExec:!0})}catch(Ut){(0,s.warn)(`paste: "${Ut.message}".`)}}keydown(C){!this.isShiftKeyDown&&C.key==="Shift"&&(this.isShiftKeyDown=!0),t(this,n)!==s.AnnotationEditorType.NONE&&!this.isEditorHandlingKeyboard&&He._keyboardManager.exec(this,C)}keyup(C){this.isShiftKeyDown&&C.key==="Shift"&&(this.isShiftKeyDown=!1,t(this,re)&&(T(this,re,!1),y(this,ht,fn).call(this,"main_toolbar")))}onEditingAction({name:C}){switch(C){case"undo":case"redo":case"delete":case"selectAll":this[C]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(C){C?(y(this,fe,Ba).call(this),y(this,v,gr).call(this),y(this,lt,je).call(this,{isEditing:t(this,n)!==s.AnnotationEditorType.NONE,isEmpty:y(this,ge,Pi).call(this),hasSomethingToUndo:t(this,kt).hasSomethingToUndo(),hasSomethingToRedo:t(this,kt).hasSomethingToRedo(),hasSelectedEditor:!1})):(y(this,de,ur).call(this),y(this,Y,mr).call(this),y(this,lt,je).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(C){if(!t(this,oe)){T(this,oe,C);for(const ft of t(this,oe))y(this,yt,Es).call(this,ft.defaultPropertiesToUpdate)}}getId(){return t(this,Fe).id}get currentLayer(){return t(this,Vt).get(t(this,Xt))}getLayer(C){return t(this,Vt).get(C)}get currentPageIndex(){return t(this,Xt)}addLayer(C){t(this,Vt).set(C.pageIndex,C),t(this,Zt)?C.enable():C.disable()}removeLayer(C){t(this,Vt).delete(C.pageIndex)}updateMode(C,ft=null,Nt=!1){if(t(this,n)!==C){if(T(this,n,C),C===s.AnnotationEditorType.NONE){this.setEditingState(!1),y(this,It,$a).call(this);return}this.setEditingState(!0),y(this,Ot,Va).call(this),this.unselectAll();for(const Ht of t(this,Vt).values())Ht.updateMode(C);if(!ft&&Nt){this.addNewEditorFromKeyboard();return}if(ft){for(const Ht of t(this,Pt).values())if(Ht.annotationElementId===ft){this.setSelected(Ht),Ht.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(C){C!==t(this,n)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:C})}updateParams(C,ft){var Nt;if(t(this,oe)){switch(C){case s.AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor();return;case s.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:(Nt=t(this,K))==null||Nt.updateColor(ft);break;case s.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(t(this,p)||T(this,p,new Map)).set(C,ft),this.showAllEditors("highlight",ft);break}for(const Ht of t(this,r))Ht.updateParams(C,ft);for(const Ht of t(this,oe))Ht.updateDefaultParams(C,ft)}}showAllEditors(C,ft,Nt=!1){var Ut;for(const Jt of t(this,Pt).values())Jt.editorType===C&&Jt.show(ft);(((Ut=t(this,p))==null?void 0:Ut.get(s.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL))??!0)!==ft&&y(this,yt,Es).call(this,[[s.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL,ft]])}enableWaiting(C=!1){if(t(this,Ie)!==C){T(this,Ie,C);for(const ft of t(this,Vt).values())C?ft.disableClick():ft.enableClick(),ft.div.classList.toggle("waiting",C)}}getEditors(C){const ft=[];for(const Nt of t(this,Pt).values())Nt.pageIndex===C&&ft.push(Nt);return ft}getEditor(C){return t(this,Pt).get(C)}addEditor(C){t(this,Pt).set(C.id,C)}removeEditor(C){var ft;C.div.contains(document.activeElement)&&(t(this,ce)&&clearTimeout(t(this,ce)),T(this,ce,setTimeout(()=>{this.focusMainContainer(),T(this,ce,null)},0))),t(this,Pt).delete(C.id),this.unselect(C),(!C.annotationElementId||!t(this,zt).has(C.annotationElementId))&&((ft=t(this,qt))==null||ft.remove(C.id))}addDeletedAnnotationElement(C){t(this,zt).add(C.annotationElementId),this.addChangedExistingAnnotation(C),C.deleted=!0}isDeletedAnnotationElement(C){return t(this,zt).has(C)}removeDeletedAnnotationElement(C){t(this,zt).delete(C.annotationElementId),this.removeChangedExistingAnnotation(C),C.deleted=!1}setActiveEditor(C){t(this,Ft)!==C&&(T(this,Ft,C),C&&y(this,yt,Es).call(this,C.propertiesToUpdate))}updateUI(C){t(this,Qt,za)===C&&y(this,yt,Es).call(this,C.propertiesToUpdate)}toggleSelected(C){if(t(this,r).has(C)){t(this,r).delete(C),C.unselect(),y(this,lt,je).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,r).add(C),C.select(),y(this,yt,Es).call(this,C.propertiesToUpdate),y(this,lt,je).call(this,{hasSelectedEditor:!0})}setSelected(C){for(const ft of t(this,r))ft!==C&&ft.unselect();t(this,r).clear(),t(this,r).add(C),C.select(),y(this,yt,Es).call(this,C.propertiesToUpdate),y(this,lt,je).call(this,{hasSelectedEditor:!0})}isSelected(C){return t(this,r).has(C)}get firstSelectedEditor(){return t(this,r).values().next().value}unselect(C){C.unselect(),t(this,r).delete(C),y(this,lt,je).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,r).size!==0}get isEnterHandled(){return t(this,r).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){t(this,kt).undo(),y(this,lt,je).call(this,{hasSomethingToUndo:t(this,kt).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:y(this,ge,Pi).call(this)})}redo(){t(this,kt).redo(),y(this,lt,je).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,kt).hasSomethingToRedo(),isEmpty:y(this,ge,Pi).call(this)})}addCommands(C){t(this,kt).add(C),y(this,lt,je).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:y(this,ge,Pi).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const C=[...t(this,r)],ft=()=>{for(const Ht of C)Ht.remove()},Nt=()=>{for(const Ht of C)y(this,_t,br).call(this,Ht)};this.addCommands({cmd:ft,undo:Nt,mustExec:!0})}commitOrRemove(){var C;(C=t(this,Ft))==null||C.commitOrRemove()}hasSomethingToControl(){return t(this,Ft)||this.hasSelection}selectAll(){for(const C of t(this,r))C.commit();y(this,Te,vr).call(this,t(this,Pt).values())}unselectAll(){if(!(t(this,Ft)&&(t(this,Ft).commitOrRemove(),t(this,n)!==s.AnnotationEditorType.NONE))&&this.hasSelection){for(const C of t(this,r))C.unselect();t(this,r).clear(),y(this,lt,je).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(C,ft,Nt=!1){if(Nt||this.commitOrRemove(),!this.hasSelection)return;t(this,At)[0]+=C,t(this,At)[1]+=ft;const[Ht,Ut]=t(this,At),Jt=[...t(this,r)],se=1e3;t(this,E)&&clearTimeout(t(this,E)),T(this,E,setTimeout(()=>{T(this,E,null),t(this,At)[0]=t(this,At)[1]=0,this.addCommands({cmd:()=>{for(const Se of Jt)t(this,Pt).has(Se.id)&&Se.translateInPage(Ht,Ut)},undo:()=>{for(const Se of Jt)t(this,Pt).has(Se.id)&&Se.translateInPage(-Ht,-Ut)},mustExec:!1})},se));for(const Se of Jt)Se.translateInPage(C,ft)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),T(this,ie,new Map);for(const C of t(this,r))t(this,ie).set(C,{savedX:C.x,savedY:C.y,savedPageIndex:C.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,ie))return!1;this.disableUserSelect(!1);const C=t(this,ie);T(this,ie,null);let ft=!1;for(const[{x:Ht,y:Ut,pageIndex:Jt},se]of C)se.newX=Ht,se.newY=Ut,se.newPageIndex=Jt,ft||(ft=Ht!==se.savedX||Ut!==se.savedY||Jt!==se.savedPageIndex);if(!ft)return!1;const Nt=(Ht,Ut,Jt,se)=>{if(t(this,Pt).has(Ht.id)){const Se=t(this,Vt).get(se);Se?Ht._setParentAndPosition(Se,Ut,Jt):(Ht.pageIndex=se,Ht.x=Ut,Ht.y=Jt)}};return this.addCommands({cmd:()=>{for(const[Ht,{newX:Ut,newY:Jt,newPageIndex:se}]of C)Nt(Ht,Ut,Jt,se)},undo:()=>{for(const[Ht,{savedX:Ut,savedY:Jt,savedPageIndex:se}]of C)Nt(Ht,Ut,Jt,se)},mustExec:!0}),!0}dragSelectedEditors(C,ft){if(t(this,ie))for(const Nt of t(this,ie).keys())Nt.drag(C,ft)}rebuild(C){if(C.parent===null){const ft=this.getLayer(C.pageIndex);ft?(ft.changeParent(C),ft.addOrRebuild(C)):(this.addEditor(C),this.addToAnnotationStorage(C),C.rebuild())}else C.parent.addOrRebuild(C)}get isEditorHandlingKeyboard(){var C;return((C=this.getActive())==null?void 0:C.shouldGetKeyboardEvents())||t(this,r).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(C){return t(this,Ft)===C}getActive(){return t(this,Ft)}getMode(){return t(this,n)}get imageManager(){return(0,s.shadow)(this,"imageManager",new I)}getSelectionBoxes(C){if(!C)return null;const ft=document.getSelection();for(let we=0,We=ft.rangeCount;we<We;we++)if(!C.contains(ft.getRangeAt(we).commonAncestorContainer))return null;const{x:Nt,y:Ht,width:Ut,height:Jt}=C.getBoundingClientRect();let se;switch(C.getAttribute("data-main-rotation")){case"90":se=(we,We,Oe,ss)=>({x:(We-Ht)/Jt,y:1-(we+Oe-Nt)/Ut,width:ss/Jt,height:Oe/Ut});break;case"180":se=(we,We,Oe,ss)=>({x:1-(we+Oe-Nt)/Ut,y:1-(We+ss-Ht)/Jt,width:Oe/Ut,height:ss/Jt});break;case"270":se=(we,We,Oe,ss)=>({x:1-(We+ss-Ht)/Jt,y:(we-Nt)/Ut,width:ss/Jt,height:Oe/Ut});break;default:se=(we,We,Oe,ss)=>({x:(we-Nt)/Ut,y:(We-Ht)/Jt,width:Oe/Ut,height:ss/Jt});break}const Se=[];for(let we=0,We=ft.rangeCount;we<We;we++){const Oe=ft.getRangeAt(we);if(!Oe.collapsed)for(const{x:ss,y:Bs,width:wr,height:Cs}of Oe.getClientRects())wr===0||Cs===0||Se.push(se(ss,Bs,wr,Cs))}return Se.length===0?null:Se}addChangedExistingAnnotation({annotationElementId:C,id:ft}){(t(this,at)||T(this,at,new Map)).set(C,ft)}removeChangedExistingAnnotation({annotationElementId:C}){var ft;(ft=t(this,at))==null||ft.delete(C)}renderAnnotationElement(C){var Ht;const ft=(Ht=t(this,at))==null?void 0:Ht.get(C.data.id);if(!ft)return;const Nt=t(this,qt).getRawValue(ft);Nt&&(t(this,n)===s.AnnotationEditorType.NONE&&!Nt.hasBeenModified||Nt.renderAnnotationElement(C))}};Ft=new WeakMap,Pt=new WeakMap,Vt=new WeakMap,Wt=new WeakMap,qt=new WeakMap,at=new WeakMap,kt=new WeakMap,Xt=new WeakMap,zt=new WeakMap,ie=new WeakMap,oe=new WeakMap,he=new WeakMap,xe=new WeakMap,Me=new WeakMap,ce=new WeakMap,pe=new WeakMap,re=new WeakMap,ae=new WeakMap,Fe=new WeakMap,Zt=new WeakMap,Ie=new WeakMap,ee=new WeakMap,K=new WeakMap,i=new WeakMap,n=new WeakMap,r=new WeakMap,c=new WeakMap,l=new WeakMap,p=new WeakMap,f=new WeakMap,d=new WeakMap,A=new WeakMap,u=new WeakMap,a=new WeakMap,h=new WeakMap,F=new WeakMap,L=new WeakMap,it=new WeakMap,dt=new WeakMap,ut=new WeakMap,wt=new WeakMap,bt=new WeakMap,At=new WeakMap,E=new WeakMap,O=new WeakMap,Z=new WeakMap,q=new WeakSet,un=function({anchorNode:C}){return C.nodeType===Node.TEXT_NODE?C.parentElement:C},et=new WeakSet,Da=function(){const C=document.getSelection();if(!C||C.isCollapsed)return;const Nt=y(this,q,un).call(this,C).closest(".textLayer"),Ht=this.getSelectionBoxes(Nt);Ht&&(t(this,ae)||T(this,ae,new w.HighlightToolbar(this)),t(this,ae).show(Nt,Ht,this.direction==="ltr"))},$=new WeakSet,_a=function(){var Ut,Jt,se;const C=document.getSelection();if(!C||C.isCollapsed){t(this,c)&&((Ut=t(this,ae))==null||Ut.hide(),T(this,c,null),y(this,lt,je).call(this,{hasSelectedText:!1}));return}const{anchorNode:ft}=C;if(ft===t(this,c))return;if(!y(this,q,un).call(this,C).closest(".textLayer")){t(this,c)&&((Jt=t(this,ae))==null||Jt.hide(),T(this,c,null),y(this,lt,je).call(this,{hasSelectedText:!1}));return}if((se=t(this,ae))==null||se.hide(),T(this,c,ft),y(this,lt,je).call(this,{hasSelectedText:!0}),!(t(this,n)!==s.AnnotationEditorType.HIGHLIGHT&&t(this,n)!==s.AnnotationEditorType.NONE)&&(t(this,n)===s.AnnotationEditorType.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),T(this,re,this.isShiftKeyDown),!this.isShiftKeyDown)){const Se=we=>{we.type==="pointerup"&&we.button!==0||(window.removeEventListener("pointerup",Se),window.removeEventListener("blur",Se),we.type==="pointerup"&&y(this,ht,fn).call(this,"main_toolbar"))};window.addEventListener("pointerup",Se),window.addEventListener("blur",Se)}},ht=new WeakSet,fn=function(C=""){t(this,n)===s.AnnotationEditorType.HIGHLIGHT?this.highlightSelection(C):t(this,xe)&&y(this,et,Da).call(this)},Lt=new WeakSet,Oa=function(){document.addEventListener("selectionchange",t(this,ut))},Kt=new WeakSet,Ha=function(){document.removeEventListener("selectionchange",t(this,ut))},fe=new WeakSet,Ba=function(){window.addEventListener("focus",t(this,d)),window.addEventListener("blur",t(this,f))},de=new WeakSet,ur=function(){window.removeEventListener("focus",t(this,d)),window.removeEventListener("blur",t(this,f))},Ee=new WeakSet,fr=function(){window.addEventListener("keydown",t(this,h)),window.addEventListener("keyup",t(this,F))},Le=new WeakSet,pr=function(){window.removeEventListener("keydown",t(this,h)),window.removeEventListener("keyup",t(this,F))},v=new WeakSet,gr=function(){document.addEventListener("copy",t(this,A)),document.addEventListener("cut",t(this,u)),document.addEventListener("paste",t(this,a))},Y=new WeakSet,mr=function(){document.removeEventListener("copy",t(this,A)),document.removeEventListener("cut",t(this,u)),document.removeEventListener("paste",t(this,a))},lt=new WeakSet,je=function(C){Object.entries(C).some(([Nt,Ht])=>t(this,bt)[Nt]!==Ht)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,bt),C)}),t(this,n)===s.AnnotationEditorType.HIGHLIGHT&&C.hasSelectedEditor===!1&&y(this,yt,Es).call(this,[[s.AnnotationEditorParamsType.HIGHLIGHT_FREE,!0]]))},yt=new WeakSet,Es=function(C){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:C})},Ot=new WeakSet,Va=function(){if(!t(this,Zt)){T(this,Zt,!0);for(const C of t(this,Vt).values())C.enable();for(const C of t(this,Pt).values())C.enable()}},It=new WeakSet,$a=function(){if(this.unselectAll(),t(this,Zt)){T(this,Zt,!1);for(const C of t(this,Vt).values())C.disable();for(const C of t(this,Pt).values())C.disable()}},_t=new WeakSet,br=function(C){const ft=t(this,Vt).get(C.pageIndex);ft?ft.addOrRebuild(C):(this.addEditor(C),this.addToAnnotationStorage(C))},Qt=new WeakSet,za=function(){let C=null;for(C of t(this,r));return C},ge=new WeakSet,Pi=function(){if(t(this,Pt).size===0)return!0;if(t(this,Pt).size===1)for(const C of t(this,Pt).values())return C.isEmpty();return!1},Te=new WeakSet,vr=function(C){for(const ft of t(this,r))ft.unselect();t(this,r).clear();for(const ft of C)ft.isEmpty()||(t(this,r).add(ft),ft.select());y(this,lt,je).call(this,{hasSelectedEditor:this.hasSelection})},be(He,"TRANSLATE_SMALL",1),be(He,"TRANSLATE_BIG",10);let g=He},94:(st,ot,k)=>{k.d(ot,{PDFFetchStream:()=>V});var s=k(292),H=k(490);function w(W,x,g){return{method:"GET",headers:W,signal:g.signal,mode:"cors",credentials:x?"include":"same-origin",redirect:"follow"}}function X(W){const x=new Headers;for(const g in W){const P=W[g];P!==void 0&&x.append(g,P)}return x}function rt(W){return W instanceof Uint8Array?W.buffer:W instanceof ArrayBuffer?W:((0,s.warn)(`getArrayBuffer - unexpected data format: ${W}`),new Uint8Array(W).buffer)}class V{constructor(x){this.source=x,this.isHttp=/^https?:/i.test(x.url),this.httpHeaders=this.isHttp&&x.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var x;return((x=this._fullRequestReader)==null?void 0:x._loaded)??0}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new I(this),this._fullRequestReader}getRangeReader(x,g){if(g<=this._progressiveDataLength)return null;const P=new M(this,x,g);return this._rangeRequestReaders.push(P),P}cancelAllRequests(x){var g;(g=this._fullRequestReader)==null||g.cancel(x);for(const P of this._rangeRequestReaders.slice(0))P.cancel(x)}}class I{constructor(x){this._stream=x,this._reader=null,this._loaded=0,this._filename=null;const g=x.source;this._withCredentials=g.withCredentials||!1,this._contentLength=g.length,this._headersCapability=Promise.withResolvers(),this._disableRange=g.disableRange||!1,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!g.disableStream,this._isRangeSupported=!g.disableRange,this._headers=X(this._stream.httpHeaders);const P=g.url;fetch(P,w(this._headers,this._withCredentials,this._abortController)).then(R=>{if(!(0,H.validateResponseStatus)(R.status))throw(0,H.createResponseStatusError)(R.status,P);this._reader=R.body.getReader(),this._headersCapability.resolve();const z=N=>R.headers.get(N),{allowRangeRequests:ct,suggestedLength:tt}=(0,H.validateRangeRequestCapabilities)({getResponseHeader:z,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=ct,this._contentLength=tt||this._contentLength,this._filename=(0,H.extractFilenameFromHeader)(z),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new s.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var P;await this._headersCapability.promise;const{value:x,done:g}=await this._reader.read();return g?{value:x,done:g}:(this._loaded+=x.byteLength,(P=this.onProgress)==null||P.call(this,{loaded:this._loaded,total:this._contentLength}),{value:rt(x),done:!1})}cancel(x){var g;(g=this._reader)==null||g.cancel(x),this._abortController.abort()}}class M{constructor(x,g,P){this._stream=x,this._reader=null,this._loaded=0;const R=x.source;this._withCredentials=R.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!R.disableStream,this._abortController=new AbortController,this._headers=X(this._stream.httpHeaders),this._headers.append("Range",`bytes=${g}-${P-1}`);const z=R.url;fetch(z,w(this._headers,this._withCredentials,this._abortController)).then(ct=>{if(!(0,H.validateResponseStatus)(ct.status))throw(0,H.createResponseStatusError)(ct.status,z);this._readCapability.resolve(),this._reader=ct.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var P;await this._readCapability.promise;const{value:x,done:g}=await this._reader.read();return g?{value:x,done:g}:(this._loaded+=x.byteLength,(P=this.onProgress)==null||P.call(this,{loaded:this._loaded}),{value:rt(x),done:!1})}cancel(x){var g;(g=this._reader)==null||g.cancel(x),this._abortController.abort()}}},10:(st,ot,k)=>{var X;k.d(ot,{FontFaceObject:()=>w,FontLoader:()=>H});var s=k(292);class H{constructor({ownerDocument:V=globalThis.document,styleElement:I=null}){o(this,X,new Set);this._document=V,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(V){this.nativeFontFaces.add(V),this._document.fonts.add(V)}removeNativeFontFace(V){this.nativeFontFaces.delete(V),this._document.fonts.delete(V)}insertRule(V){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const I=this.styleElement.sheet;I.insertRule(V,I.cssRules.length)}clear(){for(const V of this.nativeFontFaces)this._document.fonts.delete(V);this.nativeFontFaces.clear(),t(this,X).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:V,_inspectFont:I}){if(!(!V||t(this,X).has(V.loadedName))){if((0,s.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:M,src:W,style:x}=V,g=new FontFace(M,W,x);this.addNativeFontFace(g);try{await g.load(),t(this,X).add(M),I==null||I(V)}catch{(0,s.warn)(`Cannot load system font: ${V.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(g)}return}(0,s.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(V){if(V.attached||V.missingFile&&!V.systemFontInfo)return;if(V.attached=!0,V.systemFontInfo){await this.loadSystemFont(V);return}if(this.isFontLoadingAPISupported){const M=V.createNativeFontFace();if(M){this.addNativeFontFace(M);try{await M.loaded}catch(W){throw(0,s.warn)(`Failed to load font '${M.family}': '${W}'.`),V.disableFontFace=!0,W}}return}const I=V.createFontFaceRule();if(I){if(this.insertRule(I),this.isSyncFontLoadingSupported)return;await new Promise(M=>{const W=this._queueLoadingCallback(M);this._prepareFontLoadEvent(V,W)})}}get isFontLoadingAPISupported(){var I;const V=!!((I=this._document)!=null&&I.fonts);return(0,s.shadow)(this,"isFontLoadingAPISupported",V)}get isSyncFontLoadingSupported(){let V=!1;return(s.isNodeJS||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(V=!0),(0,s.shadow)(this,"isSyncFontLoadingSupported",V)}_queueLoadingCallback(V){function I(){for((0,s.assert)(!W.done,"completeRequest() cannot be called twice."),W.done=!0;M.length>0&&M[0].done;){const x=M.shift();setTimeout(x.callback,0)}}const{loadingRequests:M}=this,W={done:!1,complete:I,callback:V};return M.push(W),W}get _loadTestFont(){const V=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,s.shadow)(this,"_loadTestFont",V)}_prepareFontLoadEvent(V,I){function M(Tt,Ft){return Tt.charCodeAt(Ft)<<24|Tt.charCodeAt(Ft+1)<<16|Tt.charCodeAt(Ft+2)<<8|Tt.charCodeAt(Ft+3)&255}function W(Tt,Ft,Pt,Vt){const Wt=Tt.substring(0,Ft),qt=Tt.substring(Ft+Pt);return Wt+Vt+qt}let x,g;const P=this._document.createElement("canvas");P.width=1,P.height=1;const R=P.getContext("2d");let z=0;function ct(Tt,Ft){if(++z>30){(0,s.warn)("Load test font never loaded."),Ft();return}if(R.font="30px "+Tt,R.fillText(".",0,20),R.getImageData(0,0,1,1).data[3]>0){Ft();return}setTimeout(ct.bind(null,Tt,Ft))}const tt=`lt${Date.now()}${this.loadTestFontId++}`;let N=this._loadTestFont;N=W(N,976,tt.length,tt);const D=16,_=1482184792;let U=M(N,D);for(x=0,g=tt.length-3;x<g;x+=4)U=U-_+M(tt,x)|0;x<tt.length&&(U=U-_+M(tt+"XXX",x)|0),N=W(N,D,4,(0,s.string32)(U));const G=`url(data:font/opentype;base64,${btoa(N)});`,pt=`@font-face {font-family:"${tt}";src:${G}}`;this.insertRule(pt);const Mt=this._document.createElement("div");Mt.style.visibility="hidden",Mt.style.width=Mt.style.height="10px",Mt.style.position="absolute",Mt.style.top=Mt.style.left="0px";for(const Tt of[V.loadedName,tt]){const Ft=this._document.createElement("span");Ft.textContent="Hi",Ft.style.fontFamily=Tt,Mt.append(Ft)}this._document.body.append(Mt),ct(tt,()=>{Mt.remove(),I.complete()})}}X=new WeakMap;class w{constructor(V,{disableFontFace:I=!1,ignoreErrors:M=!1,inspectFont:W=null}){this.compiledGlyphs=Object.create(null);for(const x in V)this[x]=V[x];this.disableFontFace=I===!0,this.ignoreErrors=M===!0,this._inspectFont=W}createNativeFontFace(){var I;if(!this.data||this.disableFontFace)return null;let V;if(!this.cssFontInfo)V=new FontFace(this.loadedName,this.data,{});else{const M={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(M.style=`oblique ${this.cssFontInfo.italicAngle}deg`),V=new FontFace(this.cssFontInfo.fontFamily,this.data,M)}return(I=this._inspectFont)==null||I.call(this,this),V}createFontFaceRule(){var W;if(!this.data||this.disableFontFace)return null;const V=(0,s.bytesToString)(this.data),I=`url(data:${this.mimetype};base64,${btoa(V)});`;let M;if(!this.cssFontInfo)M=`@font-face {font-family:"${this.loadedName}";src:${I}}`;else{let x=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(x+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),M=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${x}src:${I}}`}return(W=this._inspectFont)==null||W.call(this,this,I),M}getPathGenerator(V,I){if(this.compiledGlyphs[I]!==void 0)return this.compiledGlyphs[I];let M;try{M=V.get(this.loadedName+"_path_"+I)}catch(x){if(!this.ignoreErrors)throw x;(0,s.warn)(`getPathGenerator - ignoring character: "${x}".`)}if(!Array.isArray(M)||M.length===0)return this.compiledGlyphs[I]=function(x,g){};const W=[];for(let x=0,g=M.length;x<g;)switch(M[x++]){case s.FontRenderOps.BEZIER_CURVE_TO:{const[P,R,z,ct,tt,N]=M.slice(x,x+6);W.push(B=>B.bezierCurveTo(P,R,z,ct,tt,N)),x+=6}break;case s.FontRenderOps.MOVE_TO:{const[P,R]=M.slice(x,x+2);W.push(z=>z.moveTo(P,R)),x+=2}break;case s.FontRenderOps.LINE_TO:{const[P,R]=M.slice(x,x+2);W.push(z=>z.lineTo(P,R)),x+=2}break;case s.FontRenderOps.QUADRATIC_CURVE_TO:{const[P,R,z,ct]=M.slice(x,x+4);W.push(tt=>tt.quadraticCurveTo(P,R,z,ct)),x+=4}break;case s.FontRenderOps.RESTORE:W.push(P=>P.restore());break;case s.FontRenderOps.SAVE:W.push(P=>P.save());break;case s.FontRenderOps.SCALE:(0,s.assert)(W.length===2,"Scale command is only valid at the third position.");break;case s.FontRenderOps.TRANSFORM:{const[P,R,z,ct,tt,N]=M.slice(x,x+6);W.push(B=>B.transform(P,R,z,ct,tt,N)),x+=6}break;case s.FontRenderOps.TRANSLATE:{const[P,R]=M.slice(x,x+2);W.push(z=>z.translate(P,R)),x+=2}break}return this.compiledGlyphs[I]=function(g,P){W[0](g),W[1](g),g.scale(P,-P);for(let R=2,z=W.length;R<z;R++)W[R](g)}}}},62:(st,ot,k)=>{var w,X;k.d(ot,{Metadata:()=>H});var s=k(292);class H{constructor({parsedData:V,rawData:I}){o(this,w,void 0);o(this,X,void 0);T(this,w,V),T(this,X,I)}getRaw(){return t(this,X)}get(V){return t(this,w).get(V)??null}getAll(){return(0,s.objectFromMap)(t(this,w))}has(V){return t(this,w).has(V)}}w=new WeakMap,X=new WeakMap},457:(st,ot,k)=>{k.d(ot,{PDFNetworkStream:()=>I});var s=k(292),H=k(490);const w=200,X=206;function rt(x){const g=x.response;return typeof g!="string"?g:(0,s.stringToBytes)(g).buffer}class V{constructor(g,P={}){this.url=g,this.isHttp=/^https?:/i.test(g),this.httpHeaders=this.isHttp&&P.httpHeaders||Object.create(null),this.withCredentials=P.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(g,P,R){const z={begin:g,end:P};for(const ct in R)z[ct]=R[ct];return this.request(z)}requestFull(g){return this.request(g)}request(g){const P=new XMLHttpRequest,R=this.currXhrId++,z=this.pendingRequests[R]={xhr:P};P.open("GET",this.url),P.withCredentials=this.withCredentials;for(const ct in this.httpHeaders){const tt=this.httpHeaders[ct];tt!==void 0&&P.setRequestHeader(ct,tt)}return this.isHttp&&"begin"in g&&"end"in g?(P.setRequestHeader("Range",`bytes=${g.begin}-${g.end-1}`),z.expectedStatus=X):z.expectedStatus=w,P.responseType="arraybuffer",g.onError&&(P.onerror=function(ct){g.onError(P.status)}),P.onreadystatechange=this.onStateChange.bind(this,R),P.onprogress=this.onProgress.bind(this,R),z.onHeadersReceived=g.onHeadersReceived,z.onDone=g.onDone,z.onError=g.onError,z.onProgress=g.onProgress,P.send(null),R}onProgress(g,P){var z;const R=this.pendingRequests[g];R&&((z=R.onProgress)==null||z.call(R,P))}onStateChange(g,P){var B,D,_;const R=this.pendingRequests[g];if(!R)return;const z=R.xhr;if(z.readyState>=2&&R.onHeadersReceived&&(R.onHeadersReceived(),delete R.onHeadersReceived),z.readyState!==4||!(g in this.pendingRequests))return;if(delete this.pendingRequests[g],z.status===0&&this.isHttp){(B=R.onError)==null||B.call(R,z.status);return}const ct=z.status||w;if(!(ct===w&&R.expectedStatus===X)&&ct!==R.expectedStatus){(D=R.onError)==null||D.call(R,z.status);return}const N=rt(z);if(ct===X){const U=z.getResponseHeader("Content-Range"),G=/bytes (\d+)-(\d+)\/(\d+)/.exec(U);R.onDone({begin:parseInt(G[1],10),chunk:N})}else N?R.onDone({begin:0,chunk:N}):(_=R.onError)==null||_.call(R,z.status)}getRequestXhr(g){return this.pendingRequests[g].xhr}isPendingRequest(g){return g in this.pendingRequests}abortRequest(g){const P=this.pendingRequests[g].xhr;delete this.pendingRequests[g],P.abort()}}class I{constructor(g){this._source=g,this._manager=new V(g.url,{httpHeaders:g.httpHeaders,withCredentials:g.withCredentials}),this._rangeChunkSize=g.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(g){const P=this._rangeRequestReaders.indexOf(g);P>=0&&this._rangeRequestReaders.splice(P,1)}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new M(this._manager,this._source),this._fullRequestReader}getRangeReader(g,P){const R=new W(this._manager,g,P);return R.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(R),R}cancelAllRequests(g){var P;(P=this._fullRequestReader)==null||P.cancel(g);for(const R of this._rangeRequestReaders.slice(0))R.cancel(g)}}class M{constructor(g,P){this._manager=g;const R={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=P.url,this._fullRequestId=g.requestFull(R),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=P.disableRange||!1,this._contentLength=P.length,this._rangeChunkSize=P.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const g=this._fullRequestId,P=this._manager.getRequestXhr(g),R=tt=>P.getResponseHeader(tt),{allowRangeRequests:z,suggestedLength:ct}=(0,H.validateRangeRequestCapabilities)({getResponseHeader:R,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});z&&(this._isRangeSupported=!0),this._contentLength=ct||this._contentLength,this._filename=(0,H.extractFilenameFromHeader)(R),this._isRangeSupported&&this._manager.abortRequest(g),this._headersReceivedCapability.resolve()}_onDone(g){if(g&&(this._requests.length>0?this._requests.shift().resolve({value:g.chunk,done:!1}):this._cachedChunks.push(g.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const P of this._requests)P.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(g){this._storedError=(0,H.createResponseStatusError)(g,this._url),this._headersReceivedCapability.reject(this._storedError);for(const P of this._requests)P.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(g){var P;(P=this.onProgress)==null||P.call(this,{loaded:g.loaded,total:g.lengthComputable?g.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const g=Promise.withResolvers();return this._requests.push(g),g.promise}cancel(g){this._done=!0,this._headersReceivedCapability.reject(g);for(const P of this._requests)P.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class W{constructor(g,P,R){this._manager=g;const z={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._requestId=g.requestRange(P,R,z),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var g;(g=this.onClosed)==null||g.call(this,this)}_onDone(g){const P=g.chunk;this._requests.length>0?this._requests.shift().resolve({value:P,done:!1}):this._queuedChunk=P,this._done=!0;for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(g){this._storedError=(0,H.createResponseStatusError)(g,this._url);for(const P of this._requests)P.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(g){var P;this.isStreamingSupported||(P=this.onProgress)==null||P.call(this,{loaded:g.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const P=this._queuedChunk;return this._queuedChunk=null,{value:P,done:!1}}if(this._done)return{value:void 0,done:!0};const g=Promise.withResolvers();return this._requests.push(g),g.promise}cancel(g){this._done=!0;for(const P of this._requests)P.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},490:(st,ot,k)=>{k.d(ot,{createResponseStatusError:()=>V,extractFilenameFromHeader:()=>rt,validateRangeRequestCapabilities:()=>X,validateResponseStatus:()=>I});var s=k(292);function H(M){let W=!0,x=g("filename\\*","i").exec(M);if(x){x=x[1];let B=ct(x);return B=unescape(B),B=tt(B),B=N(B),R(B)}if(x=z(M),x){const B=N(x);return R(B)}if(x=g("filename","i").exec(M),x){x=x[1];let B=ct(x);return B=N(B),R(B)}function g(B,D){return new RegExp("(?:^|;)\\s*"+B+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',D)}function P(B,D){if(B){if(!/^[\x00-\xFF]+$/.test(D))return D;try{const _=new TextDecoder(B,{fatal:!0}),U=(0,s.stringToBytes)(D);D=_.decode(U),W=!1}catch{}}return D}function R(B){return W&&/[\x80-\xff]/.test(B)&&(B=P("utf-8",B),W&&(B=P("iso-8859-1",B))),B}function z(B){const D=[];let _;const U=g("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(_=U.exec(B))!==null;){let[,pt,Mt,Tt]=_;if(pt=parseInt(pt,10),pt in D){if(pt===0)break;continue}D[pt]=[Mt,Tt]}const G=[];for(let pt=0;pt<D.length&&pt in D;++pt){let[Mt,Tt]=D[pt];Tt=ct(Tt),Mt&&(Tt=unescape(Tt),pt===0&&(Tt=tt(Tt))),G.push(Tt)}return G.join("")}function ct(B){if(B.startsWith('"')){const D=B.slice(1).split('\\"');for(let _=0;_<D.length;++_){const U=D[_].indexOf('"');U!==-1&&(D[_]=D[_].slice(0,U),D.length=_+1),D[_]=D[_].replaceAll(/\\(.)/g,"$1")}B=D.join('"')}return B}function tt(B){const D=B.indexOf("'");if(D===-1)return B;const _=B.slice(0,D),G=B.slice(D+1).replace(/^[^']*'/,"");return P(_,G)}function N(B){return!B.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(B)?B:B.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(D,_,U,G){if(U==="q"||U==="Q")return G=G.replaceAll("_"," "),G=G.replaceAll(/=([0-9a-fA-F]{2})/g,function(pt,Mt){return String.fromCharCode(parseInt(Mt,16))}),P(_,G);try{G=atob(G)}catch{}return P(_,G)})}return""}var w=k(419);function X({getResponseHeader:M,isHttp:W,rangeChunkSize:x,disableRange:g}){const P={allowRangeRequests:!1,suggestedLength:void 0},R=parseInt(M("Content-Length"),10);return!Number.isInteger(R)||(P.suggestedLength=R,R<=2*x)||g||!W||M("Accept-Ranges")!=="bytes"||(M("Content-Encoding")||"identity")!=="identity"||(P.allowRangeRequests=!0),P}function rt(M){const W=M("Content-Disposition");if(W){let x=H(W);if(x.includes("%"))try{x=decodeURIComponent(x)}catch{}if((0,w.isPdfFile)(x))return x}return null}function V(M,W){return M===404||M===0&&W.startsWith("file:")?new s.MissingPDFException('Missing PDF "'+W+'".'):new s.UnexpectedResponseException(`Unexpected server response (${M}) while retrieving PDF "${W}".`,M)}function I(M){return M===200||M===206}},786:(st,ot,k)=>{k.a(st,async(s,H)=>{try{let x=function(D){const _=M.parse(D);return _.protocol==="file:"||_.host?_:/^[a-z]:[/\\]/i.test(D)?M.parse(`file:///${D}`):(_.host||(_.protocol="file:"),_)},z=function(D,_){return{protocol:D.protocol,auth:D.auth,host:D.hostname,port:D.port,path:D.path,method:"GET",headers:_}};k.d(ot,{PDFNodeStream:()=>g});var w=k(292),X=k(490);let rt,V,I,M;w.isNodeJS&&(rt=await Is(()=>import("./BqUeLwWf.js"),[],import.meta.url),V=await Is(()=>import("./BqUeLwWf.js"),[],import.meta.url),I=await Is(()=>import("./BqUeLwWf.js"),[],import.meta.url),M=await Is(()=>import("./BqUeLwWf.js"),[],import.meta.url));const W=/^file:\/\/\/[a-zA-Z]:\//;class g{constructor(_){this.source=_,this.url=x(_.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&_.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var _;return((_=this._fullRequestReader)==null?void 0:_._loaded)??0}getFullReader(){return(0,w.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new N(this):new ct(this),this._fullRequestReader}getRangeReader(_,U){if(U<=this._progressiveDataLength)return null;const G=this.isFsUrl?new B(this,_,U):new tt(this,_,U);return this._rangeRequestReaders.push(G),G}cancelAllRequests(_){var U;(U=this._fullRequestReader)==null||U.cancel(_);for(const G of this._rangeRequestReaders.slice(0))G.cancel(_)}}class P{constructor(_){this._url=_.url,this._done=!1,this._storedError=null,this.onProgress=null;const U=_.source;this._contentLength=U.length,this._loaded=0,this._filename=null,this._disableRange=U.disableRange||!1,this._rangeChunkSize=U.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!U.disableStream,this._isRangeSupported=!U.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var G;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const _=this._readableStream.read();return _===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=_.length,(G=this.onProgress)==null||G.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(_).buffer,done:!1})}cancel(_){if(!this._readableStream){this._error(_);return}this._readableStream.destroy(_)}_error(_){this._storedError=_,this._readCapability.resolve()}_setReadableStream(_){this._readableStream=_,_.on("readable",()=>{this._readCapability.resolve()}),_.on("end",()=>{_.destroy(),this._done=!0,this._readCapability.resolve()}),_.on("error",U=>{this._error(U)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new w.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class R{constructor(_){this._url=_.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const U=_.source;this._isStreamingSupported=!U.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var G;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const _=this._readableStream.read();return _===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=_.length,(G=this.onProgress)==null||G.call(this,{loaded:this._loaded}),{value:new Uint8Array(_).buffer,done:!1})}cancel(_){if(!this._readableStream){this._error(_);return}this._readableStream.destroy(_)}_error(_){this._storedError=_,this._readCapability.resolve()}_setReadableStream(_){this._readableStream=_,_.on("readable",()=>{this._readCapability.resolve()}),_.on("end",()=>{_.destroy(),this._done=!0,this._readCapability.resolve()}),_.on("error",U=>{this._error(U)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class ct extends P{constructor(_){super(_);const U=G=>{if(G.statusCode===404){const Ft=new w.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Ft,this._headersCapability.reject(Ft);return}this._headersCapability.resolve(),this._setReadableStream(G);const pt=Ft=>this._readableStream.headers[Ft.toLowerCase()],{allowRangeRequests:Mt,suggestedLength:Tt}=(0,X.validateRangeRequestCapabilities)({getResponseHeader:pt,isHttp:_.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Mt,this._contentLength=Tt||this._contentLength,this._filename=(0,X.extractFilenameFromHeader)(pt)};this._request=null,this._url.protocol==="http:"?this._request=V.request(z(this._url,_.httpHeaders),U):this._request=I.request(z(this._url,_.httpHeaders),U),this._request.on("error",G=>{this._storedError=G,this._headersCapability.reject(G)}),this._request.end()}}class tt extends R{constructor(_,U,G){super(_),this._httpHeaders={};for(const Mt in _.httpHeaders){const Tt=_.httpHeaders[Mt];Tt!==void 0&&(this._httpHeaders[Mt]=Tt)}this._httpHeaders.Range=`bytes=${U}-${G-1}`;const pt=Mt=>{if(Mt.statusCode===404){const Tt=new w.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Tt;return}this._setReadableStream(Mt)};this._request=null,this._url.protocol==="http:"?this._request=V.request(z(this._url,this._httpHeaders),pt):this._request=I.request(z(this._url,this._httpHeaders),pt),this._request.on("error",Mt=>{this._storedError=Mt}),this._request.end()}}class N extends P{constructor(_){super(_);let U=decodeURIComponent(this._url.path);W.test(this._url.href)&&(U=U.replace(/^\//,"")),rt.promises.lstat(U).then(G=>{this._contentLength=G.size,this._setReadableStream(rt.createReadStream(U)),this._headersCapability.resolve()},G=>{G.code==="ENOENT"&&(G=new w.MissingPDFException(`Missing PDF "${U}".`)),this._storedError=G,this._headersCapability.reject(G)})}}class B extends R{constructor(_,U,G){super(_);let pt=decodeURIComponent(this._url.path);W.test(this._url.href)&&(pt=pt.replace(/^\//,"")),this._setReadableStream(rt.createReadStream(pt,{start:U,end:G-1}))}}H()}catch(rt){H(rt)}},1)},573:(st,ot,k)=>{k.a(st,async(s,H)=>{try{k.d(ot,{NodeCMapReaderFactory:()=>g,NodeCanvasFactory:()=>x,NodeFilterFactory:()=>W,NodeStandardFontDataFactory:()=>P});var w=k(583),X=k(292);let rt,V,I;if(X.isNodeJS){rt=await Is(()=>import("./BqUeLwWf.js"),[],import.meta.url);try{V=await Is(()=>import("./BqUeLwWf.js"),[],import.meta.url)}catch{}try{I=await Is(()=>import("./-EVKqUhF.js"),[],import.meta.url)}catch{}}const M=function(R){return rt.promises.readFile(R).then(z=>new Uint8Array(z))};class W extends w.BaseFilterFactory{}class x extends w.BaseCanvasFactory{_createCanvas(z,ct){return V.createCanvas(z,ct)}}class g extends w.BaseCMapReaderFactory{_fetchData(z,ct){return M(z).then(tt=>({cMapData:tt,compressionType:ct}))}}class P extends w.BaseStandardFontDataFactory{_fetchData(z){return M(z)}}H()}catch(rt){H(rt)}},1)},626:(st,ot,k)=>{var V,I,M,W,x,g,P,R,z,Ar;k.d(ot,{OptionalContentConfig:()=>rt});var s=k(292),H=k(651);const w=Symbol("INTERNAL");class X{constructor(N,{name:B,intent:D,usage:_}){o(this,V,!1);o(this,I,!1);o(this,M,!1);o(this,W,!0);T(this,V,!!(N&s.RenderingIntentFlag.DISPLAY)),T(this,I,!!(N&s.RenderingIntentFlag.PRINT)),this.name=B,this.intent=D,this.usage=_}get visible(){if(t(this,M))return t(this,W);if(!t(this,W))return!1;const{print:N,view:B}=this.usage;return t(this,V)?(B==null?void 0:B.viewState)!=="OFF":t(this,I)?(N==null?void 0:N.printState)!=="OFF":!0}_setVisible(N,B,D=!1){N!==w&&(0,s.unreachable)("Internal method `_setVisible` called."),T(this,M,D),T(this,W,B)}}V=new WeakMap,I=new WeakMap,M=new WeakMap,W=new WeakMap;class rt{constructor(N,B=s.RenderingIntentFlag.DISPLAY){o(this,z);o(this,x,null);o(this,g,new Map);o(this,P,null);o(this,R,null);if(this.renderingIntent=B,this.name=null,this.creator=null,N!==null){this.name=N.name,this.creator=N.creator,T(this,R,N.order);for(const D of N.groups)t(this,g).set(D.id,new X(B,D));if(N.baseState==="OFF")for(const D of t(this,g).values())D._setVisible(w,!1);for(const D of N.on)t(this,g).get(D)._setVisible(w,!0);for(const D of N.off)t(this,g).get(D)._setVisible(w,!1);T(this,P,this.getHash())}}isVisible(N){if(t(this,g).size===0)return!0;if(!N)return(0,s.info)("Optional content group not defined."),!0;if(N.type==="OCG")return t(this,g).has(N.id)?t(this,g).get(N.id).visible:((0,s.warn)(`Optional content group not found: ${N.id}`),!0);if(N.type==="OCMD"){if(N.expression)return y(this,z,Ar).call(this,N.expression);if(!N.policy||N.policy==="AnyOn"){for(const B of N.ids){if(!t(this,g).has(B))return(0,s.warn)(`Optional content group not found: ${B}`),!0;if(t(this,g).get(B).visible)return!0}return!1}else if(N.policy==="AllOn"){for(const B of N.ids){if(!t(this,g).has(B))return(0,s.warn)(`Optional content group not found: ${B}`),!0;if(!t(this,g).get(B).visible)return!1}return!0}else if(N.policy==="AnyOff"){for(const B of N.ids){if(!t(this,g).has(B))return(0,s.warn)(`Optional content group not found: ${B}`),!0;if(!t(this,g).get(B).visible)return!0}return!1}else if(N.policy==="AllOff"){for(const B of N.ids){if(!t(this,g).has(B))return(0,s.warn)(`Optional content group not found: ${B}`),!0;if(t(this,g).get(B).visible)return!1}return!0}return(0,s.warn)(`Unknown optional content policy ${N.policy}.`),!0}return(0,s.warn)(`Unknown group type ${N.type}.`),!0}setVisibility(N,B=!0){const D=t(this,g).get(N);if(!D){(0,s.warn)(`Optional content group not found: ${N}`);return}D._setVisible(w,!!B,!0),T(this,x,null)}setOCGState({state:N,preserveRB:B}){let D;for(const _ of N){switch(_){case"ON":case"OFF":case"Toggle":D=_;continue}const U=t(this,g).get(_);if(U)switch(D){case"ON":U._setVisible(w,!0);break;case"OFF":U._setVisible(w,!1);break;case"Toggle":U._setVisible(w,!U.visible);break}}T(this,x,null)}get hasInitialVisibility(){return t(this,P)===null||this.getHash()===t(this,P)}getOrder(){return t(this,g).size?t(this,R)?t(this,R).slice():[...t(this,g).keys()]:null}getGroups(){return t(this,g).size>0?(0,s.objectFromMap)(t(this,g)):null}getGroup(N){return t(this,g).get(N)||null}getHash(){if(t(this,x)!==null)return t(this,x);const N=new H.MurmurHash3_64;for(const[B,D]of t(this,g))N.update(`${B}:${D.visible}`);return T(this,x,N.hexdigest())}}x=new WeakMap,g=new WeakMap,P=new WeakMap,R=new WeakMap,z=new WeakSet,Ar=function(N){const B=N.length;if(B<2)return!0;const D=N[0];for(let _=1;_<B;_++){const U=N[_];let G;if(Array.isArray(U))G=y(this,z,Ar).call(this,U);else if(t(this,g).has(U))G=t(this,g).get(U).visible;else return(0,s.warn)(`Optional content group not found: ${U}`),!0;switch(D){case"And":if(!G)return!1;break;case"Or":if(G)return!0;break;case"Not":return!G;default:return!0}}return D==="And"}},814:(st,ot,k)=>{k.d(ot,{cleanupTextLayer:()=>W,renderTextLayer:()=>ct,updateTextLayer:()=>tt});var s=k(292),H=k(419);const w=1e5,X=30,rt=.8,V=new Map;let I=null;function M(){if(!I){const N=document.createElement("canvas");N.className="hiddenCanvasElement",document.body.append(N),I=N.getContext("2d",{alpha:!1})}return I}function W(){I==null||I.canvas.remove(),I=null}function x(N){const B=V.get(N);if(B)return B;const D=M(),_=D.font;D.canvas.width=D.canvas.height=X,D.font=`${X}px ${N}`;const U=D.measureText("");let G=U.fontBoundingBoxAscent,pt=Math.abs(U.fontBoundingBoxDescent);if(G){const Tt=G/(G+pt);return V.set(N,Tt),D.canvas.width=D.canvas.height=0,D.font=_,Tt}D.strokeStyle="red",D.clearRect(0,0,X,X),D.strokeText("g",0,0);let Mt=D.getImageData(0,0,X,X).data;pt=0;for(let Tt=Mt.length-1-3;Tt>=0;Tt-=4)if(Mt[Tt]>0){pt=Math.ceil(Tt/4/X);break}D.clearRect(0,0,X,X),D.strokeText("A",0,X),Mt=D.getImageData(0,0,X,X).data,G=0;for(let Tt=0,Ft=Mt.length;Tt<Ft;Tt+=4)if(Mt[Tt]>0){G=X-Math.floor(Tt/4/X);break}if(D.canvas.width=D.canvas.height=0,D.font=_,G){const Tt=G/(G+pt);return V.set(N,Tt),Tt}return V.set(N,rt),rt}function g(N,B,D){const _=document.createElement("span"),U={angle:0,canvasWidth:0,hasText:B.str!=="",hasEOL:B.hasEOL,fontSize:0};N._textDivs.push(_);const G=s.Util.transform(N._transform,B.transform);let pt=Math.atan2(G[1],G[0]);const Mt=D[B.fontName];Mt.vertical&&(pt+=Math.PI/2);const Tt=N._fontInspectorEnabled&&Mt.fontSubstitution||Mt.fontFamily,Ft=Math.hypot(G[2],G[3]),Pt=Ft*x(Tt);let Vt,Wt;pt===0?(Vt=G[4],Wt=G[5]-Pt):(Vt=G[4]+Pt*Math.sin(pt),Wt=G[5]-Pt*Math.cos(pt));const qt="calc(var(--scale-factor)*",at=_.style;N._container===N._rootContainer?(at.left=`${(100*Vt/N._pageWidth).toFixed(2)}%`,at.top=`${(100*Wt/N._pageHeight).toFixed(2)}%`):(at.left=`${qt}${Vt.toFixed(2)}px)`,at.top=`${qt}${Wt.toFixed(2)}px)`),at.fontSize=`${qt}${Ft.toFixed(2)}px)`,at.fontFamily=Tt,U.fontSize=Ft,_.setAttribute("role","presentation"),_.textContent=B.str,_.dir=B.dir,N._fontInspectorEnabled&&(_.dataset.fontName=Mt.fontSubstitutionLoadedName||B.fontName),pt!==0&&(U.angle=pt*(180/Math.PI));let kt=!1;if(B.str.length>1)kt=!0;else if(B.str!==" "&&B.transform[0]!==B.transform[3]){const Xt=Math.abs(B.transform[0]),zt=Math.abs(B.transform[3]);Xt!==zt&&Math.max(Xt,zt)/Math.min(Xt,zt)>1.5&&(kt=!0)}kt&&(U.canvasWidth=Mt.vertical?B.height:B.width),N._textDivProperties.set(_,U),N._isReadableStream&&N._layoutText(_)}function P(N){const{div:B,scale:D,properties:_,ctx:U,prevFontSize:G,prevFontFamily:pt}=N,{style:Mt}=B;let Tt="";if(_.canvasWidth!==0&&_.hasText){const{fontFamily:Ft}=Mt,{canvasWidth:Pt,fontSize:Vt}=_;(G!==Vt||pt!==Ft)&&(U.font=`${Vt*D}px ${Ft}`,N.prevFontSize=Vt,N.prevFontFamily=Ft);const{width:Wt}=U.measureText(B.textContent);Wt>0&&(Tt=`scaleX(${Pt*D/Wt})`)}_.angle!==0&&(Tt=`rotate(${_.angle}deg) ${Tt}`),Tt.length>0&&(Mt.transform=Tt)}function R(N){if(N._canceled)return;const B=N._textDivs,D=N._capability;if(B.length>w){D.resolve();return}if(!N._isReadableStream)for(const U of B)N._layoutText(U);D.resolve()}class z{constructor({textContentSource:B,container:D,viewport:_,textDivs:U,textDivProperties:G,textContentItemsStr:pt}){var Vt;this._textContentSource=B,this._isReadableStream=B instanceof ReadableStream,this._container=this._rootContainer=D,this._textDivs=U||[],this._textContentItemsStr=pt||[],this._fontInspectorEnabled=!!((Vt=globalThis.FontInspector)!=null&&Vt.enabled),this._reader=null,this._textDivProperties=G||new WeakMap,this._canceled=!1,this._capability=Promise.withResolvers(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:_.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:M()};const{pageWidth:Mt,pageHeight:Tt,pageX:Ft,pageY:Pt}=_.rawDims;this._transform=[1,0,0,-1,-Ft,Pt+Tt],this._pageWidth=Mt,this._pageHeight=Tt,(0,H.setLayerDimensions)(D,_),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new s.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new s.AbortException("TextLayer task cancelled."))}_processItems(B,D){for(const _ of B){if(_.str===void 0){if(_.type==="beginMarkedContentProps"||_.type==="beginMarkedContent"){const U=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),_.id!==null&&this._container.setAttribute("id",`${_.id}`),U.append(this._container)}else _.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(_.str),g(this,_,D)}}_layoutText(B){const D=this._layoutTextParams.properties=this._textDivProperties.get(B);if(this._layoutTextParams.div=B,P(this._layoutTextParams),D.hasText&&this._container.append(B),D.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this._container.append(_)}}_render(){const{promise:B,resolve:D,reject:_}=Promise.withResolvers();let U=Object.create(null);if(this._isReadableStream){const G=()=>{this._reader.read().then(({value:pt,done:Mt})=>{if(Mt){D();return}Object.assign(U,pt.styles),this._processItems(pt.items,U),G()},_)};this._reader=this._textContentSource.getReader(),G()}else if(this._textContentSource){const{items:G,styles:pt}=this._textContentSource;this._processItems(G,pt),D()}else throw new Error('No "textContentSource" parameter specified.');B.then(()=>{U=null,R(this)},this._capability.reject)}}function ct(N){const B=new z(N);return B._render(),B}function tt({container:N,viewport:B,textDivs:D,textDivProperties:_,mustRotate:U=!0,mustRescale:G=!0}){if(U&&(0,H.setLayerDimensions)(N,{rotation:B.rotation}),G){const pt=M(),Tt={prevFontSize:null,prevFontFamily:null,div:null,scale:B.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:pt};for(const Ft of D)Tt.properties=_.get(Ft),Tt.div=Ft,P(Tt)}}},585:(st,ot,k)=>{k.d(ot,{PDFDataTransportStream:()=>w});var s=k(292),H=k(419);class w{constructor(I,{disableRange:M=!1,disableStream:W=!1}){(0,s.assert)(I,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:x,initialData:g,progressiveDone:P,contentDispositionFilename:R}=I;if(this._queuedChunks=[],this._progressiveDone=P,this._contentDispositionFilename=R,(g==null?void 0:g.length)>0){const z=g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength?g.buffer:new Uint8Array(g).buffer;this._queuedChunks.push(z)}this._pdfDataRangeTransport=I,this._isStreamingSupported=!W,this._isRangeSupported=!M,this._contentLength=x,this._fullRequestReader=null,this._rangeReaders=[],I.addRangeListener((z,ct)=>{this._onReceiveData({begin:z,chunk:ct})}),I.addProgressListener((z,ct)=>{this._onProgress({loaded:z,total:ct})}),I.addProgressiveReadListener(z=>{this._onReceiveData({chunk:z})}),I.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),I.transportReady()}_onReceiveData({begin:I,chunk:M}){const W=M instanceof Uint8Array&&M.byteLength===M.buffer.byteLength?M.buffer:new Uint8Array(M).buffer;if(I===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(W):this._queuedChunks.push(W);else{const x=this._rangeReaders.some(function(g){return g._begin!==I?!1:(g._enqueue(W),!0)});(0,s.assert)(x,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var I;return((I=this._fullRequestReader)==null?void 0:I._loaded)??0}_onProgress(I){var M,W,x,g;I.total===void 0?(W=(M=this._rangeReaders[0])==null?void 0:M.onProgress)==null||W.call(M,{loaded:I.loaded}):(g=(x=this._fullRequestReader)==null?void 0:x.onProgress)==null||g.call(x,{loaded:I.loaded,total:I.total})}_onProgressiveDone(){var I;(I=this._fullRequestReader)==null||I.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(I){const M=this._rangeReaders.indexOf(I);M>=0&&this._rangeReaders.splice(M,1)}getFullReader(){(0,s.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const I=this._queuedChunks;return this._queuedChunks=null,new X(this,I,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(I,M){if(M<=this._progressiveDataLength)return null;const W=new rt(this,I,M);return this._pdfDataRangeTransport.requestDataRange(I,M),this._rangeReaders.push(W),W}cancelAllRequests(I){var M;(M=this._fullRequestReader)==null||M.cancel(I);for(const W of this._rangeReaders.slice(0))W.cancel(I);this._pdfDataRangeTransport.abort()}}class X{constructor(I,M,W=!1,x=null){this._stream=I,this._done=W||!1,this._filename=(0,H.isPdfFile)(x)?x:null,this._queuedChunks=M||[],this._loaded=0;for(const g of this._queuedChunks)this._loaded+=g.byteLength;this._requests=[],this._headersReady=Promise.resolve(),I._fullRequestReader=this,this.onProgress=null}_enqueue(I){this._done||(this._requests.length>0?this._requests.shift().resolve({value:I,done:!1}):this._queuedChunks.push(I),this._loaded+=I.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const I=Promise.withResolvers();return this._requests.push(I),I.promise}cancel(I){this._done=!0;for(const M of this._requests)M.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class rt{constructor(I,M,W){this._stream=I,this._begin=M,this._end=W,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(I){if(!this._done){if(this._requests.length===0)this._queuedChunk=I;else{this._requests.shift().resolve({value:I,done:!1});for(const W of this._requests)W.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const M=this._queuedChunk;return this._queuedChunk=null,{value:M,done:!1}}if(this._done)return{value:void 0,done:!0};const I=Promise.withResolvers();return this._requests.push(I),I.promise}cancel(I){this._done=!0;for(const M of this._requests)M.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},164:(st,ot,k)=>{var H,w;k.d(ot,{GlobalWorkerOptions:()=>s});class s{static get workerPort(){return t(this,H)}static set workerPort(rt){if(!(typeof Worker<"u"&&rt instanceof Worker)&&rt!==null)throw new Error("Invalid `workerPort` type.");T(this,H,rt)}static get workerSrc(){return t(this,w)}static set workerSrc(rt){if(typeof rt!="string")throw new Error("Invalid `workerSrc` type.");T(this,w,rt)}}H=new WeakMap,w=new WeakMap,o(s,H,null),o(s,w,"")},284:(st,ot,k)=>{k.d(ot,{XfaLayer:()=>H});var s=k(50);class H{static setupStorage(X,rt,V,I,M){const W=I.getValue(rt,{value:null});switch(V.name){case"textarea":if(W.value!==null&&(X.textContent=W.value),M==="print")break;X.addEventListener("input",x=>{I.setValue(rt,{value:x.target.value})});break;case"input":if(V.attributes.type==="radio"||V.attributes.type==="checkbox"){if(W.value===V.attributes.xfaOn?X.setAttribute("checked",!0):W.value===V.attributes.xfaOff&&X.removeAttribute("checked"),M==="print")break;X.addEventListener("change",x=>{I.setValue(rt,{value:x.target.checked?x.target.getAttribute("xfaOn"):x.target.getAttribute("xfaOff")})})}else{if(W.value!==null&&X.setAttribute("value",W.value),M==="print")break;X.addEventListener("input",x=>{I.setValue(rt,{value:x.target.value})})}break;case"select":if(W.value!==null){X.setAttribute("value",W.value);for(const x of V.children)x.attributes.value===W.value?x.attributes.selected=!0:x.attributes.hasOwnProperty("selected")&&delete x.attributes.selected}X.addEventListener("input",x=>{const g=x.target.options,P=g.selectedIndex===-1?"":g[g.selectedIndex].value;I.setValue(rt,{value:P})});break}}static setAttributes({html:X,element:rt,storage:V=null,intent:I,linkService:M}){const{attributes:W}=rt,x=X instanceof HTMLAnchorElement;W.type==="radio"&&(W.name=`${W.name}-${I}`);for(const[g,P]of Object.entries(W))if(P!=null)switch(g){case"class":P.length&&X.setAttribute(g,P.join(" "));break;case"dataId":break;case"id":X.setAttribute("data-element-id",P);break;case"style":Object.assign(X.style,P);break;case"textContent":X.textContent=P;break;default:(!x||g!=="href"&&g!=="newWindow")&&X.setAttribute(g,P)}x&&M.addLinkAttributes(X,W.href,W.newWindow),V&&W.dataId&&this.setupStorage(X,W.dataId,rt,V)}static render(X){var z,ct;const rt=X.annotationStorage,V=X.linkService,I=X.xfaHtml,M=X.intent||"display",W=document.createElement(I.name);I.attributes&&this.setAttributes({html:W,element:I,intent:M,linkService:V});const x=M!=="richText",g=X.div;if(g.append(W),X.viewport){const tt=`matrix(${X.viewport.transform.join(",")})`;g.style.transform=tt}x&&g.setAttribute("class","xfaLayer xfaFont");const P=[];if(I.children.length===0){if(I.value){const tt=document.createTextNode(I.value);W.append(tt),x&&s.XfaText.shouldBuildText(I.name)&&P.push(tt)}return{textDivs:P}}const R=[[I,-1,W]];for(;R.length>0;){const[tt,N,B]=R.at(-1);if(N+1===tt.children.length){R.pop();continue}const D=tt.children[++R.at(-1)[1]];if(D===null)continue;const{name:_}=D;if(_==="#text"){const G=document.createTextNode(D.value);P.push(G),B.append(G);continue}const U=(z=D==null?void 0:D.attributes)!=null&&z.xmlns?document.createElementNS(D.attributes.xmlns,_):document.createElement(_);if(B.append(U),D.attributes&&this.setAttributes({html:U,element:D,storage:rt,intent:M,linkService:V}),((ct=D.children)==null?void 0:ct.length)>0)R.push([D,-1,U]);else if(D.value){const G=document.createTextNode(D.value);x&&s.XfaText.shouldBuildText(_)&&P.push(G),U.append(G)}}for(const tt of g.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))tt.setAttribute("readOnly",!0);return{textDivs:P}}static update(X){const rt=`matrix(${X.viewport.transform.join(",")})`;X.div.style.transform=rt,X.div.hidden=!1}}},50:(st,ot,k)=>{k.d(ot,{XfaText:()=>s});class s{static textContent(w){const X=[],rt={items:X,styles:Object.create(null)};function V(I){var x;if(!I)return;let M=null;const W=I.name;if(W==="#text")M=I.value;else if(s.shouldBuildText(W))(x=I==null?void 0:I.attributes)!=null&&x.textContent?M=I.attributes.textContent:I.value&&(M=I.value);else return;if(M!==null&&X.push({str:M}),!!I.children)for(const g of I.children)V(g)}return V(w),rt}static shouldBuildText(w){return!(w==="textarea"||w==="input"||w==="option"||w==="select")}}},228:(st,ot,k)=>{k.a(st,async(s,H)=>{try{k.d(ot,{AbortException:()=>w.AbortException,AnnotationEditorLayer:()=>I.AnnotationEditorLayer,AnnotationEditorParamsType:()=>w.AnnotationEditorParamsType,AnnotationEditorType:()=>w.AnnotationEditorType,AnnotationEditorUIManager:()=>M.AnnotationEditorUIManager,AnnotationLayer:()=>W.AnnotationLayer,AnnotationMode:()=>w.AnnotationMode,CMapCompressionType:()=>w.CMapCompressionType,ColorPicker:()=>x.ColorPicker,DOMSVGFactory:()=>rt.DOMSVGFactory,DrawLayer:()=>g.DrawLayer,FeatureTest:()=>w.FeatureTest,GlobalWorkerOptions:()=>P.GlobalWorkerOptions,ImageKind:()=>w.ImageKind,InvalidPDFException:()=>w.InvalidPDFException,MissingPDFException:()=>w.MissingPDFException,OPS:()=>w.OPS,Outliner:()=>R.Outliner,PDFDataRangeTransport:()=>X.PDFDataRangeTransport,PDFDateString:()=>rt.PDFDateString,PDFWorker:()=>X.PDFWorker,PasswordResponses:()=>w.PasswordResponses,PermissionFlag:()=>w.PermissionFlag,PixelsPerInch:()=>rt.PixelsPerInch,RenderingCancelledException:()=>rt.RenderingCancelledException,UnexpectedResponseException:()=>w.UnexpectedResponseException,Util:()=>w.Util,VerbosityLevel:()=>w.VerbosityLevel,XfaLayer:()=>z.XfaLayer,build:()=>X.build,createValidAbsoluteUrl:()=>w.createValidAbsoluteUrl,fetchData:()=>rt.fetchData,getDocument:()=>X.getDocument,getFilenameFromUrl:()=>rt.getFilenameFromUrl,getPdfFilenameFromUrl:()=>rt.getPdfFilenameFromUrl,getXfaPageViewport:()=>rt.getXfaPageViewport,isDataScheme:()=>rt.isDataScheme,isPdfFile:()=>rt.isPdfFile,noContextMenu:()=>rt.noContextMenu,normalizeUnicode:()=>w.normalizeUnicode,renderTextLayer:()=>V.renderTextLayer,setLayerDimensions:()=>rt.setLayerDimensions,shadow:()=>w.shadow,updateTextLayer:()=>V.updateTextLayer,version:()=>X.version});var w=k(292),X=k(831),rt=k(419),V=k(814),I=k(731),M=k(830),W=k(976),x=k(259),g=k(47),P=k(164),R=k(61),z=k(284),ct=s([X]);X=(ct.then?(await ct)():ct)[0];const tt="4.2.67",N="49b388101";H()}catch(tt){H(tt)}})},178:(st,ot,k)=>{var V,Ua,M,Ga,x,pn;k.d(ot,{MessageHandler:()=>rt});var s=k(292);const H={UNKNOWN:0,DATA:1,ERROR:2},w={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function X(P){switch(P instanceof Error||typeof P=="object"&&P!==null||(0,s.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),P.name){case"AbortException":return new s.AbortException(P.message);case"MissingPDFException":return new s.MissingPDFException(P.message);case"PasswordException":return new s.PasswordException(P.message,P.code);case"UnexpectedResponseException":return new s.UnexpectedResponseException(P.message,P.status);case"UnknownErrorException":return new s.UnknownErrorException(P.message,P.details);default:return new s.UnknownErrorException(P.message,P.toString())}}class rt{constructor(R,z,ct){o(this,V);o(this,M);o(this,x);this.sourceName=R,this.targetName=z,this.comObj=ct,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=tt=>{const N=tt.data;if(N.targetName!==this.sourceName)return;if(N.stream){y(this,M,Ga).call(this,N);return}if(N.callback){const D=N.callbackId,_=this.callbackCapabilities[D];if(!_)throw new Error(`Cannot resolve callback ${D}`);if(delete this.callbackCapabilities[D],N.callback===H.DATA)_.resolve(N.data);else if(N.callback===H.ERROR)_.reject(X(N.reason));else throw new Error("Unexpected callback case");return}const B=this.actionHandler[N.action];if(!B)throw new Error(`Unknown action from worker: ${N.action}`);if(N.callbackId){const D=this.sourceName,_=N.sourceName;new Promise(function(U){U(B(N.data))}).then(function(U){ct.postMessage({sourceName:D,targetName:_,callback:H.DATA,callbackId:N.callbackId,data:U})},function(U){ct.postMessage({sourceName:D,targetName:_,callback:H.ERROR,callbackId:N.callbackId,reason:X(U)})});return}if(N.streamId){y(this,V,Ua).call(this,N);return}B(N.data)},ct.addEventListener("message",this._onComObjOnMessage)}on(R,z){const ct=this.actionHandler;if(ct[R])throw new Error(`There is already an actionName called "${R}"`);ct[R]=z}send(R,z,ct){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:R,data:z},ct)}sendWithPromise(R,z,ct){const tt=this.callbackId++,N=Promise.withResolvers();this.callbackCapabilities[tt]=N;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:R,callbackId:tt,data:z},ct)}catch(B){N.reject(B)}return N.promise}sendWithStream(R,z,ct,tt){const N=this.streamId++,B=this.sourceName,D=this.targetName,_=this.comObj;return new ReadableStream({start:U=>{const G=Promise.withResolvers();return this.streamControllers[N]={controller:U,startCall:G,pullCall:null,cancelCall:null,isClosed:!1},_.postMessage({sourceName:B,targetName:D,action:R,streamId:N,data:z,desiredSize:U.desiredSize},tt),G.promise},pull:U=>{const G=Promise.withResolvers();return this.streamControllers[N].pullCall=G,_.postMessage({sourceName:B,targetName:D,stream:w.PULL,streamId:N,desiredSize:U.desiredSize}),G.promise},cancel:U=>{(0,s.assert)(U instanceof Error,"cancel must have a valid reason");const G=Promise.withResolvers();return this.streamControllers[N].cancelCall=G,this.streamControllers[N].isClosed=!0,_.postMessage({sourceName:B,targetName:D,stream:w.CANCEL,streamId:N,reason:X(U)}),G.promise}},ct)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}V=new WeakSet,Ua=function(R){const z=R.streamId,ct=this.sourceName,tt=R.sourceName,N=this.comObj,B=this,D=this.actionHandler[R.action],_={enqueue(U,G=1,pt){if(this.isCancelled)return;const Mt=this.desiredSize;this.desiredSize-=G,Mt>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),N.postMessage({sourceName:ct,targetName:tt,stream:w.ENQUEUE,streamId:z,chunk:U},pt)},close(){this.isCancelled||(this.isCancelled=!0,N.postMessage({sourceName:ct,targetName:tt,stream:w.CLOSE,streamId:z}),delete B.streamSinks[z])},error(U){(0,s.assert)(U instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,N.postMessage({sourceName:ct,targetName:tt,stream:w.ERROR,streamId:z,reason:X(U)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:R.desiredSize,ready:null};_.sinkCapability.resolve(),_.ready=_.sinkCapability.promise,this.streamSinks[z]=_,new Promise(function(U){U(D(R.data,_))}).then(function(){N.postMessage({sourceName:ct,targetName:tt,stream:w.START_COMPLETE,streamId:z,success:!0})},function(U){N.postMessage({sourceName:ct,targetName:tt,stream:w.START_COMPLETE,streamId:z,reason:X(U)})})},M=new WeakSet,Ga=function(R){const z=R.streamId,ct=this.sourceName,tt=R.sourceName,N=this.comObj,B=this.streamControllers[z],D=this.streamSinks[z];switch(R.stream){case w.START_COMPLETE:R.success?B.startCall.resolve():B.startCall.reject(X(R.reason));break;case w.PULL_COMPLETE:R.success?B.pullCall.resolve():B.pullCall.reject(X(R.reason));break;case w.PULL:if(!D){N.postMessage({sourceName:ct,targetName:tt,stream:w.PULL_COMPLETE,streamId:z,success:!0});break}D.desiredSize<=0&&R.desiredSize>0&&D.sinkCapability.resolve(),D.desiredSize=R.desiredSize,new Promise(function(_){var U;_((U=D.onPull)==null?void 0:U.call(D))}).then(function(){N.postMessage({sourceName:ct,targetName:tt,stream:w.PULL_COMPLETE,streamId:z,success:!0})},function(_){N.postMessage({sourceName:ct,targetName:tt,stream:w.PULL_COMPLETE,streamId:z,reason:X(_)})});break;case w.ENQUEUE:if((0,s.assert)(B,"enqueue should have stream controller"),B.isClosed)break;B.controller.enqueue(R.chunk);break;case w.CLOSE:if((0,s.assert)(B,"close should have stream controller"),B.isClosed)break;B.isClosed=!0,B.controller.close(),y(this,x,pn).call(this,B,z);break;case w.ERROR:(0,s.assert)(B,"error should have stream controller"),B.controller.error(X(R.reason)),y(this,x,pn).call(this,B,z);break;case w.CANCEL_COMPLETE:R.success?B.cancelCall.resolve():B.cancelCall.reject(X(R.reason)),y(this,x,pn).call(this,B,z);break;case w.CANCEL:if(!D)break;new Promise(function(_){var U;_((U=D.onCancel)==null?void 0:U.call(D,X(R.reason)))}).then(function(){N.postMessage({sourceName:ct,targetName:tt,stream:w.CANCEL_COMPLETE,streamId:z,success:!0})},function(_){N.postMessage({sourceName:ct,targetName:tt,stream:w.CANCEL_COMPLETE,streamId:z,reason:X(_)})}),D.sinkCapability.reject(X(R.reason)),D.isCancelled=!0,delete this.streamSinks[z];break;default:throw new Error("Unexpected stream case")}},x=new WeakSet,pn=async function(R,z){var ct,tt,N;await Promise.allSettled([(ct=R.startCall)==null?void 0:ct.promise,(tt=R.pullCall)==null?void 0:tt.promise,(N=R.cancelCall)==null?void 0:N.promise]),delete this.streamControllers[z]}},651:(st,ot,k)=>{k.d(ot,{MurmurHash3_64:()=>X});const s=3285377520,H=4294901760,w=65535;class X{constructor(V){this.h1=V?V&4294967295:s,this.h2=V?V&4294967295:s}update(V){let I,M;if(typeof V=="string"){I=new Uint8Array(V.length*2),M=0;for(let _=0,U=V.length;_<U;_++){const G=V.charCodeAt(_);G<=255?I[M++]=G:(I[M++]=G>>>8,I[M++]=G&255)}}else if(ArrayBuffer.isView(V))I=V.slice(),M=I.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const W=M>>2,x=M-W*4,g=new Uint32Array(I.buffer,0,W);let P=0,R=0,z=this.h1,ct=this.h2;const tt=3432918353,N=461845907,B=tt&w,D=N&w;for(let _=0;_<W;_++)_&1?(P=g[_],P=P*tt&H|P*B&w,P=P<<15|P>>>17,P=P*N&H|P*D&w,z^=P,z=z<<13|z>>>19,z=z*5+3864292196):(R=g[_],R=R*tt&H|R*B&w,R=R<<15|R>>>17,R=R*N&H|R*D&w,ct^=R,ct=ct<<13|ct>>>19,ct=ct*5+3864292196);switch(P=0,x){case 3:P^=I[W*4+2]<<16;case 2:P^=I[W*4+1]<<8;case 1:P^=I[W*4],P=P*tt&H|P*B&w,P=P<<15|P>>>17,P=P*N&H|P*D&w,W&1?z^=P:ct^=P}this.h1=z,this.h2=ct}hexdigest(){let V=this.h1,I=this.h2;return V^=I>>>1,V=V*3981806797&H|V*36045&w,I=I*4283543511&H|((I<<16|V>>>16)*2950163797&H)>>>16,V^=I>>>1,V=V*444984403&H|V*60499&w,I=I*3301882366&H|((I<<16|V>>>16)*3120437893&H)>>>16,V^=I>>>1,(V>>>0).toString(16).padStart(8,"0")+(I>>>0).toString(16).padStart(8,"0")}}},292:(st,ot,k)=>{var p,gn,d,yr;k.d(ot,{AbortException:()=>he,AnnotationBorderStyleType:()=>ct,AnnotationEditorParamsType:()=>x,AnnotationEditorPrefix:()=>M,AnnotationEditorType:()=>W,AnnotationMode:()=>I,AnnotationPrefix:()=>c,AnnotationType:()=>z,BaseException:()=>qt,CMapCompressionType:()=>N,FONT_IDENTITY_MATRIX:()=>w,FeatureTest:()=>Fe,FontRenderOps:()=>l,FormatError:()=>oe,IDENTITY_MATRIX:()=>H,ImageKind:()=>R,InvalidPDFException:()=>Xt,LINE_FACTOR:()=>rt,MAX_IMAGE_SIZE_TO_CACHE:()=>X,MissingPDFException:()=>zt,OPS:()=>B,PasswordException:()=>at,PasswordResponses:()=>D,PermissionFlag:()=>g,RenderingIntentFlag:()=>V,TextRenderingMode:()=>P,UnexpectedResponseException:()=>ie,UnknownErrorException:()=>kt,Util:()=>Ie,VerbosityLevel:()=>tt,assert:()=>Ft,bytesToString:()=>xe,createValidAbsoluteUrl:()=>Vt,getUuid:()=>r,getVerbosityLevel:()=>G,info:()=>pt,isNodeJS:()=>s,normalizeUnicode:()=>n,objectFromMap:()=>pe,setVerbosityLevel:()=>U,shadow:()=>Wt,string32:()=>ce,stringToBytes:()=>Me,unreachable:()=>Tt,warn:()=>Mt});const s=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),H=[1,0,0,1,0,0],w=[.001,0,0,.001,0,0],X=1e7,rt=1.35,V={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},I={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},M="pdfjs_internal_editor_",W={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},x={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},g={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},P={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},R={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},z={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ct={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},tt={ERRORS:0,WARNINGS:1,INFOS:5},N={NONE:0,BINARY:1},B={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},D={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let _=tt.WARNINGS;function U(u){Number.isInteger(u)&&(_=u)}function G(){return _}function pt(u){_>=tt.INFOS&&console.log(`Info: ${u}`)}function Mt(u){_>=tt.WARNINGS&&console.log(`Warning: ${u}`)}function Tt(u){throw new Error(u)}function Ft(u,a){u||Tt(a)}function Pt(u){switch(u==null?void 0:u.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Vt(u,a=null,h=null){if(!u)return null;try{if(h&&typeof u=="string"){if(h.addDefaultProtocol&&u.startsWith("www.")){const L=u.match(/\./g);(L==null?void 0:L.length)>=2&&(u=`http://${u}`)}if(h.tryConvertEncoding)try{u=ee(u)}catch{}}const F=a?new URL(u,a):new URL(u);if(Pt(F))return F}catch{}return null}function Wt(u,a,h,F=!1){return Object.defineProperty(u,a,{value:h,enumerable:!F,configurable:!0,writable:!1}),h}const qt=function(){function a(h,F){this.constructor===a&&Tt("Cannot initialize BaseException."),this.message=h,this.name=F}return a.prototype=new Error,a.constructor=a,a}();class at extends qt{constructor(a,h){super(a,"PasswordException"),this.code=h}}class kt extends qt{constructor(a,h){super(a,"UnknownErrorException"),this.details=h}}class Xt extends qt{constructor(a){super(a,"InvalidPDFException")}}class zt extends qt{constructor(a){super(a,"MissingPDFException")}}class ie extends qt{constructor(a,h){super(a,"UnexpectedResponseException"),this.status=h}}class oe extends qt{constructor(a){super(a,"FormatError")}}class he extends qt{constructor(a){super(a,"AbortException")}}function xe(u){(typeof u!="object"||(u==null?void 0:u.length)===void 0)&&Tt("Invalid argument for bytesToString");const a=u.length,h=8192;if(a<h)return String.fromCharCode.apply(null,u);const F=[];for(let L=0;L<a;L+=h){const it=Math.min(L+h,a),dt=u.subarray(L,it);F.push(String.fromCharCode.apply(null,dt))}return F.join("")}function Me(u){typeof u!="string"&&Tt("Invalid argument for stringToBytes");const a=u.length,h=new Uint8Array(a);for(let F=0;F<a;++F)h[F]=u.charCodeAt(F)&255;return h}function ce(u){return String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255)}function pe(u){const a=Object.create(null);for(const[h,F]of u)a[h]=F;return a}function re(){const u=new Uint8Array(4);return u[0]=1,new Uint32Array(u.buffer,0,1)[0]===1}function ae(){try{return new Function(""),!0}catch{return!1}}class Fe{static get isLittleEndian(){return Wt(this,"isLittleEndian",re())}static get isEvalSupported(){return Wt(this,"isEvalSupported",ae())}static get isOffscreenCanvasSupported(){return Wt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Wt(this,"platform",{isMac:navigator.platform.includes("Mac")}):Wt(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var a,h;return Wt(this,"isCSSRoundSupported",(h=(a=globalThis.CSS)==null?void 0:a.supports)==null?void 0:h.call(a,"width: round(1.5px, 1px)"))}}const Zt=Array.from(Array(256).keys(),u=>u.toString(16).padStart(2,"0"));class Ie{static makeHexColor(a,h,F){return`#${Zt[a]}${Zt[h]}${Zt[F]}`}static scaleMinMax(a,h){let F;a[0]?(a[0]<0&&(F=h[0],h[0]=h[2],h[2]=F),h[0]*=a[0],h[2]*=a[0],a[3]<0&&(F=h[1],h[1]=h[3],h[3]=F),h[1]*=a[3],h[3]*=a[3]):(F=h[0],h[0]=h[1],h[1]=F,F=h[2],h[2]=h[3],h[3]=F,a[1]<0&&(F=h[1],h[1]=h[3],h[3]=F),h[1]*=a[1],h[3]*=a[1],a[2]<0&&(F=h[0],h[0]=h[2],h[2]=F),h[0]*=a[2],h[2]*=a[2]),h[0]+=a[4],h[1]+=a[5],h[2]+=a[4],h[3]+=a[5]}static transform(a,h){return[a[0]*h[0]+a[2]*h[1],a[1]*h[0]+a[3]*h[1],a[0]*h[2]+a[2]*h[3],a[1]*h[2]+a[3]*h[3],a[0]*h[4]+a[2]*h[5]+a[4],a[1]*h[4]+a[3]*h[5]+a[5]]}static applyTransform(a,h){const F=a[0]*h[0]+a[1]*h[2]+h[4],L=a[0]*h[1]+a[1]*h[3]+h[5];return[F,L]}static applyInverseTransform(a,h){const F=h[0]*h[3]-h[1]*h[2],L=(a[0]*h[3]-a[1]*h[2]+h[2]*h[5]-h[4]*h[3])/F,it=(-a[0]*h[1]+a[1]*h[0]+h[4]*h[1]-h[5]*h[0])/F;return[L,it]}static getAxialAlignedBoundingBox(a,h){const F=this.applyTransform(a,h),L=this.applyTransform(a.slice(2,4),h),it=this.applyTransform([a[0],a[3]],h),dt=this.applyTransform([a[2],a[1]],h);return[Math.min(F[0],L[0],it[0],dt[0]),Math.min(F[1],L[1],it[1],dt[1]),Math.max(F[0],L[0],it[0],dt[0]),Math.max(F[1],L[1],it[1],dt[1])]}static inverseTransform(a){const h=a[0]*a[3]-a[1]*a[2];return[a[3]/h,-a[1]/h,-a[2]/h,a[0]/h,(a[2]*a[5]-a[4]*a[3])/h,(a[4]*a[1]-a[5]*a[0])/h]}static singularValueDecompose2dScale(a){const h=[a[0],a[2],a[1],a[3]],F=a[0]*h[0]+a[1]*h[2],L=a[0]*h[1]+a[1]*h[3],it=a[2]*h[0]+a[3]*h[2],dt=a[2]*h[1]+a[3]*h[3],ut=(F+dt)/2,wt=Math.sqrt((F+dt)**2-4*(F*dt-it*L))/2,bt=ut+wt||1,At=ut-wt||1;return[Math.sqrt(bt),Math.sqrt(At)]}static normalizeRect(a){const h=a.slice(0);return a[0]>a[2]&&(h[0]=a[2],h[2]=a[0]),a[1]>a[3]&&(h[1]=a[3],h[3]=a[1]),h}static intersect(a,h){const F=Math.max(Math.min(a[0],a[2]),Math.min(h[0],h[2])),L=Math.min(Math.max(a[0],a[2]),Math.max(h[0],h[2]));if(F>L)return null;const it=Math.max(Math.min(a[1],a[3]),Math.min(h[1],h[3])),dt=Math.min(Math.max(a[1],a[3]),Math.max(h[1],h[3]));return it>dt?null:[F,it,L,dt]}static bezierBoundingBox(a,h,F,L,it,dt,ut,wt,bt){return bt?(bt[0]=Math.min(bt[0],a,ut),bt[1]=Math.min(bt[1],h,wt),bt[2]=Math.max(bt[2],a,ut),bt[3]=Math.max(bt[3],h,wt)):bt=[Math.min(a,ut),Math.min(h,wt),Math.max(a,ut),Math.max(h,wt)],y(this,d,yr).call(this,a,F,it,ut,h,L,dt,wt,3*(-a+3*(F-it)+ut),6*(a-2*F+it),3*(F-a),bt),y(this,d,yr).call(this,a,F,it,ut,h,L,dt,wt,3*(-h+3*(L-dt)+wt),6*(h-2*L+dt),3*(L-h),bt),bt}}p=new WeakSet,gn=function(a,h,F,L,it,dt,ut,wt,bt,At){if(bt<=0||bt>=1)return;const E=1-bt,O=bt*bt,Z=O*bt,q=E*(E*(E*a+3*bt*h)+3*O*F)+Z*L,St=E*(E*(E*it+3*bt*dt)+3*O*ut)+Z*wt;At[0]=Math.min(At[0],q),At[1]=Math.min(At[1],St),At[2]=Math.max(At[2],q),At[3]=Math.max(At[3],St)},d=new WeakSet,yr=function(a,h,F,L,it,dt,ut,wt,bt,At,E,O){if(Math.abs(bt)<1e-12){Math.abs(At)>=1e-12&&y(this,p,gn).call(this,a,h,F,L,it,dt,ut,wt,-E/At,O);return}const Z=At**2-4*E*bt;if(Z<0)return;const q=Math.sqrt(Z),St=2*bt;y(this,p,gn).call(this,a,h,F,L,it,dt,ut,wt,(-At+q)/St,O),y(this,p,gn).call(this,a,h,F,L,it,dt,ut,wt,(-At-q)/St,O)},o(Ie,p),o(Ie,d);function ee(u){return decodeURIComponent(escape(u))}let K=null,i=null;function n(u){return K||(K=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,i=new Map([["","t"]])),u.replaceAll(K,(a,h,F)=>h?h.normalize("NFKC"):i.get(F))}function r(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const u=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(u);else for(let a=0;a<32;a++)u[a]=Math.floor(Math.random()*255);return xe(u)}const c="pdfjs_internal_id_",l={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8}}},Tr={};function Os(st){var ot=Tr[st];if(ot!==void 0)return ot.exports;var k=Tr[st]={exports:{}};return mo[st](k,k.exports,Os),k.exports}(()=>{var st=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",ot=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",k=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",s=w=>{w&&w.d<1&&(w.d=1,w.forEach(X=>X.r--),w.forEach(X=>X.r--?X.r++:X()))},H=w=>w.map(X=>{if(X!==null&&typeof X=="object"){if(X[st])return X;if(X.then){var rt=[];rt.d=0,X.then(M=>{V[ot]=M,s(rt)},M=>{V[k]=M,s(rt)});var V={};return V[st]=M=>M(rt),V}}var I={};return I[st]=M=>{},I[ot]=X,I});Os.a=(w,X,rt)=>{var V;rt&&((V=[]).d=-1);var I=new Set,M=w.exports,W,x,g,P=new Promise((R,z)=>{g=z,x=R});P[ot]=M,P[st]=R=>(V&&R(V),I.forEach(R),P.catch(z=>{})),w.exports=P,X(R=>{W=H(R);var z,ct=()=>W.map(N=>{if(N[k])throw N[k];return N[ot]}),tt=new Promise(N=>{z=()=>N(ct),z.r=0;var B=D=>D!==V&&!I.has(D)&&(I.add(D),D&&!D.d&&(z.r++,D.push(z)));W.map(D=>D[st](B))});return z.r?tt:ct()},R=>(R?g(P[k]=R):x(M),s(V))),V&&V.d<0&&(V.d=0)}})();Os.d=(st,ot)=>{for(var k in ot)Os.o(ot,k)&&!Os.o(st,k)&&Object.defineProperty(st,k,{enumerable:!0,get:ot[k]})};Os.o=(st,ot)=>Object.prototype.hasOwnProperty.call(st,ot);var me=Os(228);me=globalThis.pdfjsLib=await(globalThis.pdfjsLibPromise=me);me.AbortException;me.AnnotationEditorLayer;me.AnnotationEditorParamsType;me.AnnotationEditorType;me.AnnotationEditorUIManager;var bo=me.AnnotationLayer,Cr=me.AnnotationMode;me.CMapCompressionType;me.ColorPicker;me.DOMSVGFactory;me.DrawLayer;me.FeatureTest;var mn=me.GlobalWorkerOptions;me.ImageKind;me.InvalidPDFException;me.MissingPDFException;me.OPS;me.Outliner;me.PDFDataRangeTransport;me.PDFDateString;me.PDFWorker;me.PasswordResponses;me.PermissionFlag;me.PixelsPerInch;me.RenderingCancelledException;me.UnexpectedResponseException;me.Util;me.VerbosityLevel;var vo=me.XfaLayer;me.build;me.createValidAbsoluteUrl;me.fetchData;var En=me.getDocument;me.getFilenameFromUrl;me.getPdfFilenameFromUrl;me.getXfaPageViewport;me.isDataScheme;me.isPdfFile;me.noContextMenu;me.normalizeUnicode;var Ao=me.renderTextLayer;me.setLayerDimensions;me.shadow;me.updateTextLayer;me.version;const kr="internal-link",yo="link",wo="file-attachment",So="form-text",xo="form-select",Eo="form-checkbox",To="form-radio",Co="form-button",Rr=["click","dblclick","mouseover","input","change"];function Ai(st,ot,k){const s=[];if(k)for(const H of k)H[st]===ot&&s.push(H);return s}function ms(st,ot){return{type:st,data:ot}}function Js(st,ot){switch(st.type){case"textarea":case"text":return ms(So,{fieldName:st.name,value:st.value});case"select-one":case"select-multiple":const k=[];for(const H of st.options)k.push({value:H.value,label:H.label});const s=[];for(const H of st.selectedOptions)s.push({value:H.value,label:H.label});return ms(xo,{fieldName:st.name,value:s,options:k});case"checkbox":return ms(Eo,{fieldName:st.name,checked:st.checked});case"radio":return ms(To,{fieldName:st.name,...ot});case"button":return ms(Co,{fieldName:st.name,...ot})}}function ko(st){return ms(wo,st.file)}async function Ro(st,ot){if(st.dest){if(typeof st.dest=="string")return ms(kr,{referencedPage:Number(st.dest.substring(1,st.dest.length)),offset:null});{const k=await ot.getPageIndex(st.dest[0]);return ms(kr,{referencedPage:k+1,offset:{left:st.dest[2],bottom:st.dest[3]}})}}else if(st.url)return ms(yo,{url:st.url,unsafeUrl:st.unsafeUrl})}function Fr(st){for(const ot of st.getElementsByTagName("span")){let k=ot.textContent;const s=JSON.parse(ot.dataset.l10nArgs??"{}");if(k)for(const H in s)k=k.replace(`{{${H}}}`,s[H]);ot.textContent=k}}function Fo(st,ot,k){var H;let s=st.target.parentNode;if(s.tagName==="DIV"&&(s=s.firstChild),s.className==="linkAnnotation"&&st.type==="click"){const w=(H=s.dataset)==null?void 0:H.annotationId;if(w)return Ro(Ai("id",w,k)[0],ot)}else if(s.className.includes("popupAnnotation")||s.className.includes("textAnnotation"))Fr(s);else if(s.className.includes("fileAttachmentAnnotation")){Fr(s);const w=s.dataset.annotationId;if(w&&st.type==="dblclick")return ko(Ai("id",w,k)[0])}else if(s.className.includes("textWidgetAnnotation")&&st.type==="input"){let w=s.getElementsByTagName("input")[0];return w||(w=s.getElementsByTagName("textarea")[0]),Js(w)}else{if(s.className.includes("choiceWidgetAnnotation")&&st.type==="input")return Js(s.getElementsByTagName("select")[0]);if(s.className.includes("buttonWidgetAnnotation checkBox")&&st.type==="change")return Js(s.getElementsByTagName("input")[0]);if(s.className.includes("buttonWidgetAnnotation radioButton")&&st.type==="change"){const w=s.dataset.annotationId;if(w){const X=Ai("id",w,k)[0],rt=[];for(const V of Ai("fieldName",X.fieldName,k))V.buttonValue&&rt.push(V.buttonValue);return Js(s.getElementsByTagName("input")[0],{value:X.buttonValue,defaultValue:X.fieldValue,options:rt})}}else if(s.className.includes("buttonWidgetAnnotation pushButton")&&st.type==="click"){const w=s.dataset.annotationId;if(w){const X=Ai("id",w,k)[0];return X.resetForm?Js({name:X.fieldName,type:"button"},{actions:X.actions,reset:!0}):Js({name:X.fieldName,type:"button"},{actions:X.actions,reset:!1})}}}}class Xa{constructor(){be(this,"externalLinkEnabled");this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(ot){}get rotation(){return 0}set rotation(ot){}get isInPresentationMode(){return!1}async goToDestination(ot){}goToPage(ot){}addLinkAttributes(ot,k,s=!1){}getDestinationHash(ot){return"#"}getAnchorUrl(ot){return"#"}setHash(ot){}executeNamedAction(ot){}executeSetOCGState(ot){}cachePageRef(ot,k){}}const Lo=Hs({__name:"AnnotationLayer",props:{page:{},viewport:{},document:{},annotationsFilter:{},annotationsMap:{},imageResourcesPath:{},hideForms:{type:Boolean},enableScripting:{type:Boolean},intent:{}},emits:["annotation","annotationLoaded"],setup(st,{emit:ot}){const k=st,s=ot,H=Ze(),w=Ze();function X(W){const x=Fo(W,k.document,w.value);Promise.resolve(x).then(g=>{g&&s("annotation",g)})}async function rt(){var x;return await((x=Mi(k.document))==null?void 0:x.getFieldObjects())}async function V(){var x;return await((x=Mi(k.document))==null?void 0:x.hasJSActions())}async function I(){const W=k.page;let x=await(W==null?void 0:W.getAnnotations({intent:k.intent}));if(k.annotationsFilter){const g=k.annotationsFilter;x=x.filter(P=>{const R=P.subtype,z=P.fieldType?`${R}.${P.fieldType}`:null;return(g==null?void 0:g.includes(R))||z!==null&&(g==null?void 0:g.includes(z))})}return x}async function M(){var N,B;(B=(N=H.value).replaceChildren)==null||B.call(N);for(const D of Rr)H.value.removeEventListener(D,X);const W=Mi(k.document),x=k.page,g=k.viewport;w.value=await I();const P=new Map([]);for(const D of w.value)if(D.subtype==="Widget"&&D.fieldType==="Btn"&&D.pushButton){const _=D.rect[2]-D.rect[0],U=D.rect[3]-D.rect[1],G=document.createElement("canvas");G.setAttribute("width",(_*g.scale).toString()),G.setAttribute("height",(U*g.scale).toString()),P.set(D.id,G)}const R=W.annotationStorage;if(k.annotationsMap)for(const[D,_]of Object.entries(k.annotationsMap))R.setValue(D,_);const z={accessibilityManager:void 0,annotationCanvasMap:P,div:H.value,page:x,viewport:g.clone({dontFlip:!0}),annotationEditorUIManager:null},ct={annotations:w.value,viewport:g.clone({dontFlip:!0}),linkService:new Xa,annotationCanvasMap:P,div:H.value,annotationStorage:R,renderForms:!k.hideForms,page:x,enableScripting:!1,hasJSActions:await V(),fieldObjects:await rt(),downloadManager:null,imageResourcesPath:k.imageResourcesPath};new bo(z).render(ct).then(async()=>{s("annotationLoaded",await I())});for(const D of Rr)H.value.addEventListener(D,X)}return Ts(()=>k.viewport,()=>{k.page&&k.viewport&&H.value&&M()}),vn(()=>{k.page&&k.viewport&&H.value&&M()}),(W,x)=>(ts(),bs("div",{ref_key:"layer",ref:H,class:"annotationLayer",style:{display:"block"}},null,512))}});function Po(st,ot,k){const s=[];for(const M of st.items)s.push(M.str),M.hasEOL&&s.push(`
`);const H=s.join("").replace(/\n/g," "),w=["g"];k.ignoreCase&&w.push("i");let X=ot.trim();k.completeWords&&(X=`\\b${X}\\b`);const rt=new RegExp(X,w.join("")),V=[];let I;for(;(I=rt.exec(H))!==null;)V.push([I.index,I[0].length,I[0]]);return V}function Mo(st,ot){let k=0,s=0;const H=ot.items,w=H.length-1,X=[];for(let rt=0;rt<st.length;rt++){let V=st[rt][0];for(;k!==w&&V>=s+H[k].str.length;)s+=H[k].str.length+(H[k].hasEOL?1:0),k++;const I={idx:k,offset:V-s};for(V+=st[rt][1];k!==w&&V>s+H[k].str.length;)s+=H[k].str.length+(H[k].hasEOL?1:0),k++;const M={idx:k,offset:V-s};X.push({start:I,end:M,str:st[rt][2],oindex:st[rt][0]})}return X}function Io(st,ot,k){function s(H,w=-1,X=-1){const rt=ot.items[H],V=[];let I="",M="",W="",x=k[H];if(!x)return;if(x.nodeType===Node.TEXT_NODE){const R=document.createElement("span");x.before(R),R.append(x),k[H]=R,x=R}w>=0&&X>=0?I=rt.str.substring(w,X):w<0&&X<0?I=rt.str:w>=0?I=rt.str.substring(w):X>=0&&(I=rt.str.substring(0,X));const g=document.createTextNode(I),P=document.createElement("span");if(P.className="highlight appended",P.append(g),V.push(P),w>0)if(x.childNodes.length===1&&x.childNodes[0].nodeType===Node.TEXT_NODE){M=rt.str.substring(0,w);const R=document.createTextNode(M);V.unshift(R)}else{let R=0;const z=[];for(const ct of x.childNodes){const tt=ct.nodeType===Node.TEXT_NODE?ct.nodeValue:ct.firstChild.nodeValue;R+=tt.length,R<=w?z.push(ct):w>=R-tt.length&&X<=R&&z.push(document.createTextNode(tt.substring(0,w-(R-tt.length))))}V.unshift(...z)}if(X>0){W=rt.str.substring(X);const R=document.createTextNode(W);V.push(R)}x.replaceChildren(...V)}for(const H of st)if(H.start.idx===H.end.idx)s(H.start.idx,H.start.offset,H.end.offset);else for(let w=H.start.idx,X=H.end.idx;w<=X;w++)w===H.start.idx?s(w,H.start.offset):w===H.end.idx?s(w,-1,H.end.offset):s(w)}function No(st,ot){const k=st.items.map(s=>s.str);for(let s=0;s<ot.length;s++){const H=ot[s];if(H&&H.nodeType!==Node.TEXT_NODE){const w=document.createTextNode(k[s]);H.replaceChildren(w)}}}function Do(st,ot,k){const s=[];for(const H of st){const w=Po(ot,H,k);s.push(...Mo(w,ot))}return s}const _o=Hs({__name:"TextLayer",props:{page:{},viewport:{},highlightText:{},highlightOptions:{}},emits:["highlight","textLoaded"],setup(st,{emit:ot}){const k=st,s=ot,H=Ze(),w=Ze(),X=[];function rt(){return Object.assign({},{ignoreCase:!0,completeWords:!1},k.highlightOptions)}async function V(x=!1){const g=k.page,P=await(g==null?void 0:g.getTextContent());if(P&&(x&&No(P,X),k.highlightText)){const R=typeof k.highlightText=="string"?[k.highlightText]:k.highlightText,z=Do(R,P,rt());Io(z,P,X),s("highlight",{matches:z,textContent:P,textDivs:X,page:(g==null?void 0:g.pageNumber)||1})}}function I(){var ct,tt;(tt=(ct=H.value).replaceChildren)==null||tt.call(ct),X.splice(0,X.length);const x=k.page,g=k.viewport,R={textContentSource:x==null?void 0:x.streamTextContent({includeMarkedContent:!0,disableNormalization:!0}),viewport:g,container:H.value,textDivs:X,textDivProperties:new WeakMap};Ao(R).promise.then(async()=>{var D;const N=await(x==null?void 0:x.getTextContent());s("textLoaded",{textDivs:X,textContent:N});const B=document.createElement("div");B.className="endOfContent",(D=H.value)==null||D.appendChild(B),w.value=B,V()})}function M(){w.value&&w.value.classList.add("active")}function W(){w.value&&w.value.classList.remove("active")}return Ts(()=>k.viewport,x=>{k.page&&k.viewport&&H.value&&I()}),Ts(()=>[k.highlightText,k.highlightOptions],x=>{V(!0)},{deep:!0}),vn(()=>{k.page&&k.viewport&&H.value&&I()}),(x,g)=>(ts(),bs("div",{ref_key:"layer",ref:H,class:"textLayer",style:{display:"block"},onMousedown:M,onMouseup:W},null,544))}}),Oo=Hs({__name:"XFALayer",props:{page:{},document:{},viewport:{}},emits:["xfaLoaded"],setup(st,{emit:ot}){const k=st,s=ot,H=Ze();async function w(){var I,M;(M=(I=H.value).replaceChildren)==null||M.call(I);const X=Mi(k.document),rt=k.page,V=k.viewport;if(X.isPureXfa){const W=await rt.getXfa(),x={div:H.value,viewport:V.clone({dontFlip:!0}),linkService:new Xa,annotationStorage:X==null?void 0:X.annotationStorage,xfaHtml:W};vo.render(x),s("xfaLoaded")}}return Ts(()=>k.viewport,X=>{k.page&&k.viewport&&H.value&&w()}),vn(()=>{k.page&&k.viewport&&H.value&&w()}),(X,rt)=>(ts(),bs("div",{ref_key:"layer",ref:H,style:{display:"block"}},null,512))}}),Ho=qe("canvas",{dir:"ltr",style:{display:"block"},role:"main"},null,-1),Bo=Hs({__name:"VueOrientPDF",props:{pdf:{},page:{default:1},scale:{default:1},rotation:{},fitParent:{type:Boolean},width:{},height:{},portraitWidth:{},landscapeWidth:{},textLayer:{type:Boolean},imageResourcesPath:{},hideForms:{type:Boolean},intent:{default:"display"},annotationLayer:{type:Boolean},annotationsFilter:{},annotationsMap:{},watermarkText:{},watermarkOptions:{},highlightText:{},highlightOptions:{}},emits:["annotation","highlight","loaded","textLoaded","annotationLoaded","xfaLoaded"],setup(st,{expose:ot,emit:k}){const s=st,H=k,w=Ze(),X=Ze(),rt=Ze(!1);let V;const I=Sn(()=>({viewport:void 0,document:void 0,page:void 0})),M=Sn(()=>({annotationsMap:s.annotationsMap,annotationsFilter:s.annotationsFilter,imageResourcesPath:s.imageResourcesPath,hideForms:s.hideForms,intent:s.intent})),W=Sn(()=>({highlightText:s.highlightText,highlightOptions:s.highlightOptions}));function x(){return Object.assign({},{columns:4,rows:4,rotation:45,fontSize:18,color:"rgba(211, 210, 211, 0.4)"},s.watermarkOptions)}function g(U){if(!(typeof U=="number"&&U%90===0))return 0;const G=U/90;return G>4?g(U-360):G<0?g(U+360):U}function P(U){const G=U.getViewport({scale:1}).width,pt=U.getViewport({scale:1}).height,Mt=G>=pt?"landscape":"portrait";let Tt=s.scale;return s.fitParent?Tt=w.value.parentNode.clientWidth/G:Tt=Mt==="landscape"?s.landscapeWidth/G:s.portraitWidth/G,Tt}function R(U=1){if(!s.watermarkText)return;const G=z();if(!G)return;const pt=G.getContext("2d");if(!pt)return;const Mt=x(),Tt=s.watermarkText,Ft=Mt.columns,Pt=Mt.rows,Vt=Ft*Pt,Wt=Mt.rotation,qt=Mt.fontSize*U;pt.font=`${qt}px Trebuchet MS`,pt.fillStyle=Mt.color;for(let at=0;at<Vt;at++){const kt=at%Ft*(G.width/Ft)+G.width/(Ft*2),Xt=Math.floor(at/Ft)*(G.height/Pt)+G.height/(Pt*2),zt=pt.measureText(Tt).width;pt.save(),pt.translate(kt,Xt),pt.rotate(-Wt*(Math.PI/180)),pt.fillText(Tt,-zt/2,qt/2),pt.restore()}}function z(){var G;let U=null;return(G=w.value)==null||G.childNodes.forEach(pt=>{pt.tagName==="CANVAS"&&(U=pt)}),U}function ct(U){var Tt;let G;const pt=z();pt&&(pt==null?void 0:pt.getAttribute("role"))==="main"?G=pt:(G=document.createElement("canvas"),G.style.display="block",G.setAttribute("dir","ltr"));const Mt=window.devicePixelRatio||1;return G.width=Math.floor(U.width*Mt),G.height=Math.floor(U.height*Mt),G.style.width=`${Math.floor(U.width)}px`,G.style.height=`${Math.floor(U.height)}px`,G.classList.add("shadow"),(Tt=w.value)==null||Tt.style.setProperty("--scale-factor",`${U.scale}`),X.value.style.width=`${Math.floor(U.width)}px`,X.value.style.height=`${Math.floor(U.height)}px`,X.value.style.top="0",X.value.style.left="0",rt.value=!0,G}function tt(){V&&V.cancel()}function N(U){var G;(G=Mi(I.value.document))==null||G.getPage(U).then(pt=>{var kt;tt();const Mt=pt.getViewport(),Tt={scale:P(pt),rotation:g((s.rotation||0)+Mt.rotation)},Ft=pt.getViewport(Tt),Pt=z(),Vt=ct(Ft),Wt=window.devicePixelRatio||1,qt=Wt!==1?[Wt,0,0,Wt,0,0]:void 0,at={canvasContext:Vt.getContext("2d"),viewport:Ft,annotationMode:s.hideForms?Cr.ENABLE:Cr.ENABLE_FORMS,transform:qt,intent:s.intent};(Vt==null?void 0:Vt.getAttribute("role"))!=="main"?Pt&&((kt=w.value)==null||kt.replaceChild(Vt,Pt)):Vt.removeAttribute("role"),I.value.page=pt,I.value.viewport=Ft,V=pt.render(at),V.promise.then(()=>{rt.value=!1,R(Ft.scale),H("loaded",I.value.viewport)}).catch(()=>{})})}function B(U){U.promise.then(async G=>{I.value.document=G,N(s.page)})}Ts(()=>s.pdf,U=>{U!==void 0&&B(U)}),Ts(()=>[s.scale,s.width,s.height,s.rotation,s.page,s.hideForms,s.intent],()=>{N(s.page)}),vn(()=>{s.pdf!==void 0&&B(s.pdf)});function D(){N(s.page)}function _(){tt()}return ot({reload:D,cancel:_}),(U,G)=>(ts(),bs("div",{ref_key:"container",ref:w,style:{position:"relative",display:"block"}},[Ho,U.annotationLayer?(ts(),bn(Lo,xn({key:0},{...Qe(I),...Qe(M)},{onAnnotation:G[0]||(G[0]=pt=>H("annotation",pt)),onAnnotationLoaded:G[1]||(G[1]=pt=>H("annotationLoaded",pt))}),null,16)):Er("",!0),U.textLayer?(ts(),bn(_o,xn({key:1},{...Qe(I),...Qe(W)},{onHighlight:G[2]||(G[2]=pt=>H("highlight",pt)),onTextLoaded:G[3]||(G[3]=pt=>H("textLoaded",pt))}),null,16)):Er("",!0),Je(Oo,xn({...Qe(I)},{onXfaLoaded:G[4]||(G[4]=pt=>H("xfaLoaded"))}),null,16),Pr(qe("div",{ref_key:"loadingLayer",ref:X,style:{position:"absolute"}},[Ja(U.$slots,"default")],512),[[Mr,Qe(rt)]])],512))}}),Vo=""+new URL("pdf.worker.min.B7-rSTV-.mjs",import.meta.url).href;var $o="[object Number]";function zo(st){return typeof st=="number"||ao(st)&&oo(st)==$o}function Uo(st){return zo(st)&&st!=+st}function Go(st){return!!(typeof st=="object"&&st&&"gen"in st&&"num"in st)}async function Xo(st,ot){return typeof ot=="string"?st.getDestination(ot):ot}async function Wo(st,ot){return ot&&Go(ot[0])?ot[0]:null}const Yo=st=>st.type==="XYZ"&&st.spec.length===3,jo=st=>st.type==="Fit"&&st.spec.length===0,qo=st=>st.type==="FitH"&&st.spec.length===1,Ko=st=>st.type==="FitV"&&st.spec.length===1,Jo=st=>st.type==="FitR"&&st.spec.length===4,Qo=st=>st.type==="FitB"&&st.spec.length===0,Zo=st=>st.type==="FitBH"&&st.spec.length===1,tl=st=>st.type==="FitBV"&&st.spec.length===1;function el(st,ot){const k={type:st,spec:ot};return Yo(k)||jo(k)||qo(k)||Ko(k)||Jo(k)||Qo(k)||Zo(k)||tl(k)?k:(console.warn("no location type found for ",st,ot),null)}const sl=st=>st&&st.every(ot=>!Uo(ot));async function il(){return new Promise((st,ot)=>{const k=document.createElement("iframe");k.width="0px",k.height="0px",k.style.cssText="position: absolute; top:0; left:0",k.style.display="none",k.onload=function(){st(k)},document.body.appendChild(k)})}function nl(st,ot,k){const s=st.document.createElement("style");s.textContent=`
    @page {
      margin: 0;
      size: ${ot}pt ${k}pt;
    }
    body {
      margin: 0;
      width: 100%;
    }
    canvas {
      width: 100%;
      page-break-after: always;
      page-break-before: avoid;
      page-break-inside: avoid;
    }
  `,st.document.head.appendChild(s)}function rl(st){mn.workerSrc=st}function al(st,ot={onProgress:void 0,onPassword:void 0,onError:void 0,password:""}){mn!=null&&mn.workerSrc||rl(Vo);const k=Wi(),s=Wi(),H=Wi(0),w=Wi({});function X(W){s.value&&s.value.destroy();const x=En(W);if(ot.onProgress&&(x.onProgress=ot.onProgress),ot.onPassword)x.onPassword=ot.onPassword;else if(ot.password){const g=(P,R)=>{P(ot.password??"")};x.onPassword=g}x.promise.then(async g=>{s.value=g,k.value=g.loadingTask,H.value=g.numPages;const P=await g.getMetadata(),R=await g.getAttachments(),z=await g.getJSActions(),ct=await g.getOutline();w.value={metadata:P,attachments:R,javascript:z,outline:ct}},g=>{typeof ot.onError=="function"&&ot.onError(g)})}async function rt(W){var N;const x=await((N=k.value)==null?void 0:N.promise);if(!x)return null;const g=await Xo(x,W),P=await Wo(x,g);if(!P||!g)return null;const R=await x.getPageIndex(P),z=g[1].name,ct=g.slice(2),tt=sl(ct)?el(z,ct):null;return{pageIndex:R,location:tt??{type:"Fit",spec:[]}}}async function V(W="filename"){var z;if(!s.value)throw new Error("Current PDFDocumentProxy have not loaded yet");const x=await((z=s.value)==null?void 0:z.saveDocument()),g=new Blob([x],{type:"application/pdf"}),P=URL.createObjectURL(g),R=document.createElement("a");document.body.appendChild(R),R.href=P,R.download=W,R.style.display="none",R.click(),setTimeout(()=>{URL.revokeObjectURL(P),document.body.removeChild(R)},10)}async function I(W=0){var ct;if(!s.value)throw new Error("Current PDFDocumentProxy have not loaded yet");const x=await((ct=s.value)==null?void 0:ct.saveDocument()),z=(await(await En(x.buffer).promise).getPage(W)).getViewport({scale:1});return z.width>=z.height?"landscape":"portrait"}async function M(W=150,x="filename"){var D,_;if(!s.value)throw new Error("Current PDFDocumentProxy have not loaded yet");const g=await((D=s.value)==null?void 0:D.saveDocument()),R=await En(g.buffer).promise,z=W/72,ct=96/72,tt=await il(),N=tt.contentWindow;N.document.title=x;const B=[...Array(R.numPages).keys()].map(U=>U+1);for(const U of B){const G=await R.getPage(U),pt=G.getViewport({scale:1});U===1&&nl(N,pt.width*z/ct,pt.height*z/ct);const Mt=document.createElement("canvas");Mt.width=pt.width*z,Mt.height=pt.height*z;const Tt=Mt.cloneNode();N==null||N.document.body.appendChild(Tt),await(G==null?void 0:G.render({canvasContext:Mt.getContext("2d"),intent:"print",transform:[z,0,0,z,0,0],viewport:pt}).promise),(_=Tt.getContext("2d"))==null||_.drawImage(Mt,0,0)}N==null||N.focus(),N==null||N.print(),document.body.removeChild(tt)}return Ii(st)?(st.value&&X(st.value),Ts(st,()=>{st.value&&X(st.value)})):st&&X(st),{pdf:k,pages:H,info:w,print:M,download:V,getPDFDestination:rt,getOrient:I}}const ol={class:"flex flex-wrap gap-x-0 justify-center items-center"},ll={class:"absolute right-1 top-1 z-40 hidden group-hover:block"},hl={class:"absolute bottom-0 text-xs px-1.5 py-2 xl:p-1 truncate max-w-full"},cl=Hs({__name:"ListFile",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(st){const ot=Lr(st,"modelValue"),k=Ze([]);async function s(w){k.value=await Promise.all(w.map(async X=>{const rt=typeof X=="string"?{url:X,cMapUrl:"/cmaps/"}:{data:await X.arrayBuffer(),cMapUrl:"/cmaps/"},{pdf:V,...I}=al(rt);return typeof X=="string"?{pdf:V,...I,fileName:X.split("/").at(-1),docId:X}:{pdf:V,...I,fileName:X.name,docId:X.lastModified+X.name}}))}Ts(ot,async w=>{await s(w)},{deep:!0,immediate:!0});function H(w){ot.value.splice(w,1)}return(w,X)=>{const rt=Tn,V=Bo;return ts(),bs("div",ol,[(ts(!0),bs(Qa,null,Za(Qe(k),(I,M)=>(ts(),bs("div",{key:I.docId,class:"m-1 w-[198px] h-[244px] flex flex-col items-center justify-center bg-stone-50 shadow relative rounded-lg group"},[qe("div",ll,[Je(rt,{icon:"i-ph-x-bold",ui:{rounded:"rounded-full"},size:"xs",color:"gray",onClick:W=>H(M)},null,8,["onClick"])]),Je(V,{ref_for:!0,ref:"pdfRef",pdf:I.pdf,"landscape-width":180,"portrait-width":127},null,8,["pdf"]),qe("p",hl,to(I.fileName),1)]))),128))])}}}),dl={class:"absolute inset-0 flex items-center justify-center bg-black/80 text-white font-bold z-50 text-4xl"},ul=qe("h1",{class:"screen-reader-only"}," / ",-1),yl=Hs({__name:"password-remover",setup(st){const ot=Ze([]),k=Ze(),{isOverDropZone:s}=eo(k,{onDrop(H){H==null||H.forEach(w=>ot==null?void 0:ot.value.push(w))}});return(H,w)=>{const X=ja,rt=go,V=cl,I=so;return ts(),bs("div",{ref_key:"dropzoneRef",ref:k,class:"relative"},[Pr(qe("div",dl," Drop it like it's hot ",512),[[Mr,Qe(s)]]),Je(I,{class:"py-8 space-y-8 text-center"},{default:Qs(()=>[ul,Je(X),Qe(ot).length?(ts(),bn(V,{key:1,modelValue:Qe(ot),"onUpdate:modelValue":w[1]||(w[1]=M=>Ii(ot)?ot.value=M:null)},null,8,["modelValue"])):(ts(),bn(rt,{key:0,modelValue:Qe(ot),"onUpdate:modelValue":w[0]||(w[0]=M=>Ii(ot)?ot.value=M:null)},null,8,["modelValue"])),Je(X)]),_:1})],512)}}});export{yl as default};
